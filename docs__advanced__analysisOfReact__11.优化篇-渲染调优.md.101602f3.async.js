(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[6429],{6005:function(e,n,t){"use strict";t.r(n);var l=t(67294),r=t(96089),a=t(65659),c=l.memo((e=>{e.demos;return l.createElement(l.Fragment,null,l.createElement("div",{className:"markdown"},l.createElement("h2",{id:"\u4e00\u524d\u8a00"},l.createElement(r.AnchorLink,{to:"#\u4e00\u524d\u8a00","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e00\u524d\u8a00"),l.createElement("p",null,"\u4e0a\u8282\u4e3b\u8981\u8bb2\u4e86 React \u5bf9\u7ec4\u4ef6\u6e32\u67d3\u7684\u63a7\u5236\u65b9\u6cd5\u4ee5\u53ca\u539f\u7406\uff0c\u672c\u7ae0\u8282\u5c06\u7ee7\u7eed\u56f4\u7ed5 React \u6e32\u67d3\u8bdd\u9898\uff0c\u8c08\u4e00\u8c08\u6574\u4e2a React \u6e32\u67d3\u8fc7\u7a0b\u4e2d\u7ec6\u8282\u95ee\u9898\u600e\u4e48\u89e3\u51b3\u3002"),l.createElement("p",null,"\u901a\u8fc7\u672c\u7ae0\u8282\uff0c\u4f60\u5c06\u5b66\u4f1a Suspense \u7528\u6cd5\u548c\u539f\u7406\uff0cReact.lazy \u7528\u6cd5\u548c\u914d\u5408 Suspense \u5b9e\u73b0\u4ee3\u7801\u5206\u5272\uff0c\u6e32\u67d3\u9519\u8bef\u8fb9\u754c\u3001\u6e32\u67d3\u5f02\u5e38\u7684\u5904\u7406\u624b\u6bb5\uff0c \u4ee5\u53ca diff \u6d41\u7a0b\u4ee5\u53ca key \u7684\u5408\u7406\u4f7f\u7528\u3002"),l.createElement("h2",{id:"\u4e8c\u61d2\u52a0\u8f7d\u548c\u5f02\u6b65\u6e32\u67d3"},l.createElement(r.AnchorLink,{to:"#\u4e8c\u61d2\u52a0\u8f7d\u548c\u5f02\u6b65\u6e32\u67d3","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e8c\u61d2\u52a0\u8f7d\u548c\u5f02\u6b65\u6e32\u67d3"),l.createElement("h3",{id:"\u5f02\u6b65\u6e32\u67d3"},l.createElement(r.AnchorLink,{to:"#\u5f02\u6b65\u6e32\u67d3","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5f02\u6b65\u6e32\u67d3"),l.createElement("p",null,"Suspense \u662f React \u63d0\u51fa\u7684\u4e00\u79cd\u540c\u6b65\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c\u7684\u65b9\u6848\u3002Suspense \u8ba9\u7ec4\u4ef6\u2018\u7b49\u5f85\u2019\u5f02\u6b65\u64cd\u4f5c\uff0c\u5f02\u6b65\u8bf7\u6c42\u7ed3\u675f\u540e\u5728\u8fdb\u884c\u7ec4\u4ef6\u7684\u6e32\u67d3\uff0c\u4e5f\u5c31\u662f\u6240\u8c13\u7684\u5f02\u6b65\u6e32\u67d3\uff0c\u4f46\u662f\u8fd9\u4e2a\u529f\u80fd\u76ee\u524d\u8fd8\u5728\u5b9e\u9a8c\u9636\u6bb5\uff0c\u76f8\u4fe1\u4e0d\u4e45\u8fd9\u79cd\u5f02\u6b65\u6e32\u67d3\u7684\u65b9\u5f0f\u5c31\u80fd\u548c\u5927\u5bb6\u89c1\u9762\u4e86\u3002"),l.createElement("p",null,l.createElement("strong",null,"Suspense \u7528\u6cd5")),l.createElement("p",null,"Suspense \u662f\u7ec4\u4ef6\uff0c\u6709\u4e00\u4e2a fallback \u5c5e\u6027\uff0c\u7528\u6765\u4ee3\u66ff\u5f53 Suspense \u5904\u4e8e loading \u72b6\u6001\u4e0b\u6e32\u67d3\u7684\u5185\u5bb9\uff0cSuspense \u7684 children \u5c31\u662f\u5f02\u6b65\u7ec4\u4ef6\u3002\u591a\u4e2a\u5f02\u6b65\u7ec4\u4ef6\u53ef\u4ee5\u7528 Suspense \u5d4c\u5957\u4f7f\u7528\u3002"),l.createElement("p",null,"\u6211\u5199\u4e86\u4e00\u4e2a\u5f02\u6b65\u6e32\u67d3\u7684\u4f8b\u5b50\u5982\u4e0b\u3002"),l.createElement(a.Z,{code:"// \u5b50\u7ec4\u4ef6\nfunction UserInfo() {\n  // \u83b7\u53d6\u7528\u6237\u6570\u636e\u4fe1\u606f\uff0c\u7136\u540e\u518d\u6e32\u67d3\u7ec4\u4ef6\u3002\n  const user = getUserInfo();\n  return <h1>{user.name}</h1>;\n}\n// \u7236\u7ec4\u4ef6\nexport default function Index(){\n    return <Suspense fallback={<h1>Loading...</h1>}>\n        <UserInfo/>\n    </Suspense>\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"Suspense \u5305\u88f9\u5f02\u6b65\u6e32\u67d3\u7ec4\u4ef6 UserInfo \uff0c\u5f53 UserInfo \u5904\u4e8e\u6570\u636e\u52a0\u8f7d\u72b6\u6001\u4e0b\uff0c\u5c55\u793a Suspense \u4e2d fallback \u7684\u5185\u5bb9\u3002")),l.createElement("p",null,"\u5982\u4e0a\u6240\u793a\uff0c\u5f02\u6b65\u6e32\u67d3\u7684 UserInfo \u7ec4\u4ef6\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 getUserInfo \u8bf7\u6c42\u6570\u636e\uff0c\u76f4\u63a5\u7528\u6570\u636e user \u8fdb\u884c\u6e32\u67d3\uff0c\u5f88\u663e\u7136\u73b0\u5728\u662f\u505a\u4e0d\u5230\u7684\u3002\u73b0\u5728\u7684\u5f02\u6b65\u8bf7\u6c42\u65b9\u5f0f\u6bd4\u8f83\u7e41\u7410\uff0c\u4e3b\u8981\u662f\u662f\u901a\u8fc7\u7c7b\u7ec4\u4ef6 componentDidMount \u6216\u8005\u51fd\u6570\u7ec4\u4ef6 useEffect \u8fdb\u884c\u6570\u636e\u4ea4\u4e92\uff0c\u83b7\u5f97\u6570\u636e\u540e\u901a\u8fc7\u8c03\u7528 setState \u6216 useState \u6539\u53d8 state \u89e6\u53d1\u89c6\u56fe\u7684\u66f4\u65b0\u3002"),l.createElement("p",null,"\u4f20\u7edf\u6a21\u5f0f\uff1a\u6302\u8f7d\u7ec4\u4ef6-> \u8bf7\u6c42\u6570\u636e -> \u518d\u6e32\u67d3\u7ec4\u4ef6\u3002 \u5f02\u6b65\u6a21\u5f0f\uff1a\u8bf7\u6c42\u6570\u636e-> \u6e32\u67d3\u7ec4\u4ef6\u3002"),l.createElement("p",null,"\u90a3\u4e48\u5f02\u6b65\u6e32\u67d3\u76f8\u6bd4\u4f20\u7edf\u6570\u636e\u4ea4\u4e92\u76f8\u6bd4\u597d\u5904\u5c31\u662f\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u4e0d\u518d\u9700\u8981 componentDidMount \u6216 useEffect \u914d\u5408\u505a\u6570\u636e\u4ea4\u4e92\uff0c\u4e5f\u4e0d\u4f1a\u56e0\u4e3a\u6570\u636e\u4ea4\u4e92\u540e\uff0c\u6539\u53d8 state \u800c\u4ea7\u751f\u7684\u4e8c\u6b21\u66f4\u65b0\u4f5c\u7528\u3002"),l.createElement("li",null,"\u4ee3\u7801\u903b\u8f91\u66f4\u7b80\u5355\uff0c\u6e05\u6670\u3002")),l.createElement("h3",{id:"\u52a8\u6001\u52a0\u8f7d\u61d2\u52a0\u8f7d"},l.createElement(r.AnchorLink,{to:"#\u52a8\u6001\u52a0\u8f7d\u61d2\u52a0\u8f7d","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u52a8\u6001\u52a0\u8f7d\uff08\u61d2\u52a0\u8f7d\uff09"),l.createElement("p",null,"\u73b0\u5728\u7684 Suspense \u914d\u5408 React.lazy \u53ef\u4ee5\u5b9e\u73b0\u52a8\u6001\u52a0\u8f7d\u529f\u80fd\u3002"),l.createElement("p",null,l.createElement("strong",null,"React.lazy")),l.createElement(a.Z,{code:"const LazyComponent = React.lazy(()=>import('./text'))",lang:"js"}),l.createElement("p",null,"React.lazy \u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u9700\u8981\u52a8\u6001\u8c03\u7528 ",l.createElement("code",null,"import()")," \u3002\u5b83\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a Promise \uff0c\u8be5 Promise \u9700\u8981 resolve \u4e00\u4e2a default export \u7684 React \u7ec4\u4ef6\u3002"),l.createElement("p",null,"\u5148\u6765\u770b\u4e00\u4e0b\u57fa\u672c\u4f7f\u7528\uff1a"),l.createElement(a.Z,{code:"const LazyComponent = React.lazy(() => import('./test.js'))\n\nexport default function Index(){\n   return <Suspense fallback={<div>loading...</div>} >\n       <LazyComponent />\n   </Suspense>\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7528 React.lazy \u52a8\u6001\u5f15\u5165 test.js \u91cc\u9762\u7684\u7ec4\u4ef6\uff0c\u914d\u5408 Suspense \u5b9e\u73b0\u52a8\u6001\u52a0\u8f7d\u7ec4\u4ef6\u6548\u679c\u3002",l.createElement("strong",null,"\u8fd9\u6837\u5f88\u5229\u4e8e\u4ee3\u7801\u5206\u5272\uff0c\u4e0d\u4f1a\u8ba9\u521d\u59cb\u5316\u7684\u65f6\u5019\u52a0\u8f7d\u5927\u91cf\u7684\u6587\u4ef6\u3002"))),l.createElement("p",null,"\u539f\u7406\u63ed\u79d8\uff1a ",l.createElement("strong",null,"React.lazy\u548cSuspense\u5b9e\u73b0\u52a8\u6001\u52a0\u8f7d\u539f\u7406")),l.createElement("p",null,"\u6574\u4e2a render \u8fc7\u7a0b\u90fd\u662f\u540c\u6b65\u6267\u884c\u4e00\u6c14\u5475\u6210\u7684\uff0c\u4f46\u662f\u5728 Suspense \u5f02\u6b65\u7ec4\u4ef6\u60c5\u51b5\u4e0b\u5141\u8bb8",l.createElement("strong",null,"\u8c03\u7528 Render => \u53d1\u73b0\u5f02\u6b65\u8bf7\u6c42 => \u60ac\u505c\uff0c\u7b49\u5f85\u5f02\u6b65\u8bf7\u6c42\u5b8c\u6bd5 => \u518d\u6b21\u6e32\u67d3\u5c55\u793a\u6570\u636e"),"\u3002"),l.createElement("p",null,"\u90a3\u4e48\u6574\u4e2a\u6d41\u7a0b\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u9010\u6b65\u5206\u6790\u4e00\u4e0b\uff1a"),l.createElement("p",null,l.createElement("strong",null,"Suspense\u539f\u7406\uff1a")),l.createElement("p",null,"Suspense \u5728\u6267\u884c\u5185\u90e8\u53ef\u4ee5\u901a\u8fc7 ",l.createElement("code",null,"try","{","}","catch","{","}")," \u65b9\u5f0f\u6355\u83b7\u5f02\u5e38\uff0c\u8fd9\u4e2a\u5f02\u5e38\u901a\u5e38\u662f\u4e00\u4e2a ",l.createElement("code",null,"Promise")," \uff0c\u53ef\u4ee5\u5728\u8fd9\u4e2a Promise \u4e2d\u8fdb\u884c\u6570\u636e\u8bf7\u6c42\u5de5\u4f5c\uff0cSuspense \u5185\u90e8\u4f1a\u5904\u7406\u8fd9\u4e2a Promise \uff0cPromise \u7ed3\u675f\u540e\uff0cSuspense \u4f1a\u518d\u4e00\u6b21\u91cd\u65b0 render \u628a\u6570\u636e\u6e32\u67d3\u51fa\u6765\uff0c\u8fbe\u5230\u5f02\u6b65\u6e32\u67d3\u7684\u6548\u679c\u3002"),l.createElement("p",null,l.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60d20c4fad834541873697ead2ec6dda~tplv-k3u1fbpfcp-watermark.awebp",alt:"5.jpg"})),l.createElement("p",null,l.createElement("strong",null,"React.lazy\u539f\u7406\uff1a")),l.createElement("p",null,"\u518d\u770b\u4e00\u4e0b React.lazy\uff0clazy \u5185\u90e8\u6a21\u62df\u4e00\u4e2a promiseA \u89c4\u8303\u573a\u666f\u3002\u5b8c\u5168\u53ef\u4ee5\u7406\u89e3 React.lazy \u7528 Promise \u6a21\u62df\u4e86\u4e00\u4e2a\u8bf7\u6c42\u6570\u636e\u7684\u8fc7\u7a0b\uff0c\u4f46\u662f\u8bf7\u6c42\u7684\u7ed3\u679c\u4e0d\u662f\u6570\u636e\uff0c\u800c\u662f\u4e00\u4e2a\u52a8\u6001\u7684\u7ec4\u4ef6\u3002\u4e0b\u4e00\u6b21\u6e32\u67d3\u5c31\u76f4\u63a5\u6e32\u67d3\u8fd9\u4e2a\u7ec4\u4ef6\uff0c\u6240\u4ee5\u662f React.lazy \u5229\u7528 Suspense ",l.createElement("strong",null,"\u63a5\u6536 Promise \uff0c\u6267\u884c Promise \uff0c\u7136\u540e\u518d\u6e32\u67d3"),"\u8fd9\u4e2a\u7279\u6027\u505a\u5230\u52a8\u6001\u52a0\u8f7d\u7684\u3002\u8bf4\u5230\u8fd9\u53ef\u80fd\u6709\u5f88\u591a\u540c\u5b66\u4e0d\u660e\u767d\u4ec0\u4e48\u610f\u601d\uff0c\u4e0d\u8981\u7d27\uff0c\u63a5\u4e0b\u6765\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u52a0\u6df1\u4e00\u4e0b\u5bf9 lazy + susponse \u7684\u7406\u89e3\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"react/src/ReactLazy.js")),l.createElement(a.Z,{code:"function lazy(ctor){\n    return {\n         $$typeof: REACT_LAZY_TYPE,\n         _payload:{\n            _status: -1,  //\u521d\u59cb\u5316\u72b6\u6001\n            _result: ctor,\n         },\n         _init:function(payload){\n             if(payload._status===-1){ /* \u7b2c\u4e00\u6b21\u6267\u884c\u4f1a\u8d70\u8fd9\u91cc  */\n                const ctor = payload._result;\n                const thenable = ctor();\n                payload._status = Pending;\n                payload._result = thenable;\n                thenable.then((moduleObject)=>{\n                    const defaultExport = moduleObject.default;\n                    resolved._status = Resolved; // 1 \u6210\u529f\u72b6\u6001\n                    resolved._result = defaultExport;/* defaultExport \u4e3a\u6211\u4eec\u52a8\u6001\u52a0\u8f7d\u7684\u7ec4\u4ef6\u672c\u8eab  */ \n                })\n             }\n            if(payload._status === Resolved){ // \u6210\u529f\u72b6\u6001\n                return payload._result;\n            }\n            else {  //\u7b2c\u4e00\u6b21\u4f1a\u629b\u51faPromise\u5f02\u5e38\u7ed9Suspense\n                throw payload._result; \n            }\n         }\n    }\n}",lang:"js"}),l.createElement("p",null,"\u6574\u4e2a\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff0cReact.lazy \u5305\u88f9\u7684\u7ec4\u4ef6\u4f1a\u6807\u8bb0 ",l.createElement("code",null,"REACT_LAZY_TYPE")," \u7c7b\u578b\u7684 element\uff0c\u5728\u8c03\u548c\u9636\u6bb5\u4f1a\u53d8\u6210 LazyComponent \u7c7b\u578b\u7684 fiber \uff0cReact \u5bf9 LazyComponent \u4f1a\u6709\u5355\u72ec\u7684\u5904\u7406\u903b\u8f91\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e00\u6b21\u6e32\u67d3\u9996\u5148\u4f1a\u6267\u884c init \u65b9\u6cd5\uff0c\u91cc\u9762\u4f1a\u6267\u884c lazy \u7684\u7b2c\u4e00\u4e2a\u51fd\u6570\uff0c\u5f97\u5230\u4e00\u4e2aPromise\uff0c\u7ed1\u5b9a Promise.then \u6210\u529f\u56de\u8c03\uff0c\u56de\u8c03\u91cc\u5f97\u5230\u5c06\u8981\u6e32\u67d3\u7ec4\u4ef6 ",l.createElement("code",null,"defaultExport")," \uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u4e0a\u9762\u7684\u51fd\u6570\u5f53\u7b2c\u4e8c\u4e2a if \u5224\u65ad\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u6b64\u65f6\u72b6\u6001\u4e0d\u662f Resolved \uff0c\u6240\u4ee5\u4f1a\u8d70 else \uff0c\u629b\u51fa\u5f02\u5e38 Promise\uff0c\u629b\u51fa\u5f02\u5e38\u4f1a\u8ba9\u5f53\u524d\u6e32\u67d3\u7ec8\u6b62\u3002"),l.createElement("li",null,"\u8fd9\u4e2a\u5f02\u5e38 Promise \u4f1a\u88ab Suspense \u6355\u83b7\u5230\uff0cSuspense \u4f1a\u5904\u7406 Promise \uff0cPromise \u6267\u884c\u6210\u529f\u56de\u8c03\u5f97\u5230 defaultExport\uff08\u5c06\u60f3\u8981\u6e32\u67d3\u7ec4\u4ef6\uff09\uff0c\u7136\u540e Susponse \u53d1\u8d77\u7b2c\u4e8c\u6b21\u6e32\u67d3\uff0c\u7b2c\u4e8c\u6b21 init \u65b9\u6cd5\u5df2\u7ecf\u662f Resolved \u6210\u529f\u72b6\u6001\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de result \u4e5f\u5c31\u662f\u771f\u6b63\u6e32\u67d3\u7684\u7ec4\u4ef6\u3002\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u6b63\u5e38\u6e32\u67d3\u7ec4\u4ef6\u4e86\u3002")),l.createElement("p",null,l.createElement("img",{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6792d24862464d89b2034bfa4cf9e5a8~tplv-k3u1fbpfcp-watermark.awebp",alt:"4.jpg"})),l.createElement("h2",{id:"\u4e09-\u6e32\u67d3\u9519\u8bef\u8fb9\u754c"},l.createElement(r.AnchorLink,{to:"#\u4e09-\u6e32\u67d3\u9519\u8bef\u8fb9\u754c","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e09 \u6e32\u67d3\u9519\u8bef\u8fb9\u754c"),l.createElement("p",null,"React \u7ec4\u4ef6\u6e32\u67d3\u8fc7\u7a0b\u5982\u679c\u6709\u4e00\u4e2a\u73af\u8282\u51fa\u73b0\u95ee\u9898\uff0c\u5c31\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7ec4\u4ef6\u6e32\u67d3\u5931\u8d25\uff0c\u90a3\u4e48\u6574\u4e2a\u7ec4\u4ef6\u7684 UI \u5c42\u90fd\u4f1a\u663e\u793a\u4e0d\u51fa\u6765\uff0c\u8fd9\u6837\u9020\u6210\u7684\u5371\u5bb3\u662f\u5de8\u5927\u7684\uff0c\u5982\u679c\u8d8a\u9760\u8fd1 APP \u5e94\u7528\u7684\u6839\u7ec4\u4ef6\uff0c\u6e32\u67d3\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u95ee\u9898\u9020\u6210\u7684\u5f71\u54cd\u5c31\u8d8a\u5927\uff0c\u6709\u53ef\u80fd\u76f4\u63a5\u9020\u6210\u767d\u5c4f\u7684\u60c5\u51b5\u3002"),l.createElement("p",null,"\u6bd4\u5982\u5982\u4e0b\u4f8b\u5b50"),l.createElement(a.Z,{code:"function ErrorTest(){\n    return \n}\nfunction Test(){\n    return <div>let us learn React!</div>\n}\n\n class Index extends React.Component{ \n    componentDidCatch(...arg){\n       console.log(arg)\n    }\n   render(){  \n      return <div>\n          <ErrorTest />\n          <div> hello, my name is alien! </div>\n          <Test />\n      </div>\n   }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u9020\u6210\u9519\u8bef\uff0c\u7531\u4e8e ErrorTest \u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u7ec4\u4ef6\u4f46\u662f\u5374\u7528\u6765\u6e32\u67d3\uff0c\u7ed3\u679c\u4f1a\u9020\u6210\u6574\u4e2a Index \u7ec4\u4ef6\u6e32\u67d3\u5f02\u5e38\uff0cTest \u4e5f\u4f1a\u53d7\u5230\u7275\u8fde\uff0cUI \u90fd\u4e0d\u80fd\u6b63\u5e38\u663e\u793a\u3002")),l.createElement("p",null,"\u4e3a\u4e86\u9632\u6b62\u5982\u4e0a\u7684\u6e32\u67d3\u5f02\u5e38\u60c5\u51b5 React \u589e\u52a0\u4e86 ",l.createElement("code",null,"componentDidCatch")," \u548c ",l.createElement("code",null,"static getDerivedStateFromError()")," \u4e24\u4e2a\u989d\u5916\u7684\u751f\u547d\u5468\u671f\uff0c\u53bb\u633d\u6551\u7531\u4e8e\u6e32\u67d3\u9636\u6bb5\u51fa\u73b0\u95ee\u9898\u9020\u6210 UI \u754c\u9762\u65e0\u6cd5\u663e\u793a\u7684\u60c5\u51b5\u3002"),l.createElement("h3",{id:"componentdidcatch"},l.createElement(r.AnchorLink,{to:"#componentdidcatch","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"componentDidCatch"),l.createElement("p",null,"componentDidCatch \u53ef\u4ee5\u6355\u83b7\u5f02\u5e38\uff0c\u5b83\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff1a"),l.createElement("ul",null,l.createElement("li",null,"1 error \u2014\u2014 \u629b\u51fa\u7684\u9519\u8bef\u3002"),l.createElement("li",null,"2 info \u2014\u2014 \u5e26\u6709 componentStack key \u7684\u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u7ec4\u4ef6\u5f15\u53d1\u9519\u8bef\u7684\u6808\u4fe1\u606f\u3002")),l.createElement("p",null,"\u5148\u6765\u6253\u5370\u4e00\u4e0b\uff0c\u751f\u547d\u5468\u671f componentDidCatch \u53c2\u6570\u957f\u4ec0\u4e48\u6837\u5b50\uff1f"),l.createElement("p",null,l.createElement("img",{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17c55d44dfe94d2a9544030ce5c426c1~tplv-k3u1fbpfcp-watermark.awebp",alt:"2.jpg"})),l.createElement("p",null,"\u90a3\u4e48 componentDidCatch \u4e2d\u53ef\u4ee5\u518d\u6b21\u89e6\u53d1 setState\uff0c\u6765\u964d\u7ea7UI\u6e32\u67d3\uff0ccomponentDidCatch() \u4f1a\u5728commit\u9636\u6bb5\u88ab\u8c03\u7528\uff0c\u56e0\u6b64\u5141\u8bb8\u6267\u884c\u526f\u4f5c\u7528\u3002"),l.createElement(a.Z,{code:"class Index extends React.Component{\n   state={\n       hasError:false\n   }  \n   componentDidCatch(...arg){\n       uploadErrorLog(arg)  /* \u4e0a\u4f20\u9519\u8bef\u65e5\u5fd7 */\n       this.setState({  /* \u964d\u7ea7UI */\n           hasError:true\n       })\n   }\n   render(){  \n      const { hasError } =this.state\n      return <div>\n          {  hasError ? <div>\u7ec4\u4ef6\u51fa\u73b0\u9519\u8bef</div> : <ErrorTest />  }\n          <div> hello, my name is alien! </div>\n          <Test />\n      </div>\n   }\n}",lang:"js"}),l.createElement("p",null,"\u6548\u679c\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e97c84689a4493d9f3c6e05b4723499~tplv-k3u1fbpfcp-watermark.awebp",alt:"3.jpg"})," componentDidCatch \u4f5c\u7528\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u53ef\u4ee5\u8c03\u7528 setState \u4fc3\u4f7f\u7ec4\u4ef6\u6e32\u67d3\uff0c\u5e76\u505a\u4e00\u4e9b\u9519\u8bef\u62e6\u622a\u529f\u80fd\u3002"),l.createElement("li",null,"\u76d1\u63a7\u7ec4\u4ef6\uff0c\u53d1\u751f\u9519\u8bef\uff0c\u4e0a\u62a5\u9519\u8bef\u65e5\u5fd7\u3002")),l.createElement("h3",{id:"static-getderivedstatefromerror"},l.createElement(r.AnchorLink,{to:"#static-getderivedstatefromerror","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"static getDerivedStateFromError"),l.createElement("p",null,"React\u66f4\u671f\u671b\u7528 getDerivedStateFromError \u4ee3\u66ff componentDidCatch \u7528\u4e8e\u5904\u7406\u6e32\u67d3\u5f02\u5e38\u7684\u60c5\u51b5\u3002getDerivedStateFromError \u662f\u9759\u6001\u65b9\u6cd5\uff0c\u5185\u90e8\u4e0d\u80fd\u8c03\u7528 setState\u3002getDerivedStateFromError \u8fd4\u56de\u7684\u503c\u53ef\u4ee5\u5408\u5e76\u5230 state\uff0c\u4f5c\u4e3a\u6e32\u67d3\u4f7f\u7528\u3002\u7528 getDerivedStateFromError \u89e3\u51b3\u5982\u4e0a\u7684\u60c5\u51b5\u3002"),l.createElement(a.Z,{code:"class Index extends React.Component{\n   state={\n       hasError:false\n   }  \n   static getDerivedStateFromError(){\n       return { hasError:true }\n   }\n   render(){  \n      /* \u5982\u4e0a */\n   }\n}",lang:"js"}),l.createElement("p",null,"\u5982\u4e0a\u5b8c\u7f8e\u89e3\u51b3\u4e86 ErrorTest \u9519\u8bef\u7684\u95ee\u9898\u3002\u6ce8\u610f\u4e8b\u9879\uff1a \u5982\u679c\u5b58\u5728 getDerivedStateFromError \u751f\u547d\u5468\u671f\u94a9\u5b50\uff0c\u90a3\u4e48\u5c06\u4e0d\u9700\u8981 componentDidCatch \u751f\u547d\u5468\u671f\u518d\u964d\u7ea7 ui\u3002"),l.createElement("h2",{id:"\u56db-\u4ecediff-children\u770bkey\u7684\u5408\u7406\u4f7f\u7528"},l.createElement(r.AnchorLink,{to:"#\u56db-\u4ecediff-children\u770bkey\u7684\u5408\u7406\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u56db \u4ecediff children\u770bkey\u7684\u5408\u7406\u4f7f\u7528"),l.createElement("p",null,"\u4e0a\u8ff0\u5185\u5bb9\u8bb2\u4e86\u5f02\u6b65\u6e32\u67d3\u548c\u6e32\u67d3\u9519\u8bef\u8fb9\u754c\uff0c\u90fd\u662f\u5bf9\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u4e0b\u6e32\u67d3\u7684\u5904\u7406\u3002\u4e0a\u7ae0\u8282\u8bb2\u5230\uff0c\u5927\u90e8\u5206\u4f18\u5316\u73af\u8282 React \u90fd\u81ea\u5df1\u5728\u5185\u90e8\u5904\u7406\u4e86\u3002\u4f46\u662f\u6709\u4e00\u79cd\u60c5\u51b5\u4e5f\u503c\u5f97\u5f00\u53d1\u8005\u6ce8\u610f\uff0c\u90a3\u5c31\u662f\u5217\u8868\u4e2d key \u7684\u4f7f\u7528\u3002\u5408\u7406\u7684\u4f7f\u7528 key \u6709\u52a9\u4e8e\u80fd\u7cbe\u51c6\u7684\u627e\u5230\u7528\u4e8e\u65b0\u8282\u70b9\u590d\u7528\u7684\u8001\u8282\u70b9\u3002 React \u662f\u5982\u4f55 diff children \u7684\u5462\u3002"),l.createElement("p",null,"\u6211\u8fd9\u91cc\u4e3a\u4e86\u65b9\u4fbf\u5927\u5bb6\u4e86\u89e3\u6d41\u7a0b\uff0c\u5c31\u4e0d\u653e\u8fc7\u591a\u6e90\u7801\u4e86\uff0c\u6211\u7528\u5982\u4e0b\u51e0\u4e2a\u6848\u4f8b\u6765\u63cf\u8ff0 React diffChild \u6838\u5fc3\u6d41\u7a0b\u3002\u4e4b\u524d\u505a\u8fc7\u4e00\u671f vue3.0 diff\u7b97\u6cd5\u7684\u6587\u7ae0\uff0c\u5b9e\u9645\u5728\u5904\u7406\u624b\u6cd5\u4e0a\u8fd8\u662f\u6709\u4e00\u4e9b\u76f8\u4f3c\u4e4b\u5904\u7684\u3002\u9996\u5148 React \u5728\u4e00\u6b21\u66f4\u65b0\u4e2d\u5f53\u53d1\u73b0\u901a\u8fc7 render \u5f97\u5230\u7684 children \u5982\u679c\u662f\u4e00\u4e2a\u6570\u7ec4\u7684\u8bdd\u3002\u5c31\u4f1a\u8c03\u7528 reconcileChildrenArray \u6765\u8c03\u548c\u5b50\u4ee3 fiber \uff0c\u6574\u4e2a\u5bf9\u6bd4\u7684\u6d41\u7a0b\u5c31\u662f\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\u8fdb\u884c\u7684\u3002"),l.createElement("h3",{id:"diff-children\u6d41\u7a0b"},l.createElement(r.AnchorLink,{to:"#diff-children\u6d41\u7a0b","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"diff children\u6d41\u7a0b"),l.createElement("p",null,l.createElement("strong",null,"\u7b2c\u4e00\u6b65\uff1a\u904d\u5386\u65b0 children \uff0c\u590d\u7528 oldFiber")),l.createElement("blockquote",null,l.createElement("p",null,"react-reconciler/src/ReactChildFiber.js")),l.createElement(a.Z,{code:"function reconcileChildrenArray(){\n    /* \u7b2c\u4e00\u6b65  */\n    for (; oldFiber !== null && newIdx < newChildren.length; newIdx++) {  \n        if (oldFiber.index > newIdx) {\n            nextOldFiber = oldFiber;\n            oldFiber = null;\n        } else {\n            nextOldFiber = oldFiber.sibling;\n        }\n        const newFiber = updateSlot(returnFiber,oldFiber,newChildren[newIdx],expirationTime,);\n        if (newFiber === null) { break }\n        // ..\u4e00\u4e9b\u5176\u4ed6\u903b\u8f91\n        }  \n        if (shouldTrackSideEffects) {  // shouldTrackSideEffects \u4e3a\u66f4\u65b0\u6d41\u7a0b\u3002\n            if (oldFiber && newFiber.alternate === null) { /* \u627e\u5230\u4e86\u4e0e\u65b0\u8282\u70b9\u5bf9\u5e94\u7684fiber\uff0c\u4f46\u662f\u4e0d\u80fd\u590d\u7528\uff0c\u90a3\u4e48\u76f4\u63a5\u5220\u9664\u8001\u8282\u70b9 */\n                deleteChild(returnFiber, oldFiber);\n            }\n        }\n    }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e00\u6b65\u5bf9\u4e8e React.createElement \u4ea7\u751f\u65b0\u7684 child \u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u9996\u5148\u4f1a\u904d\u5386\u6570\u7ec4\uff0c\u56e0\u4e3a fiber \u5bf9\u4e8e\u540c\u4e00\u7ea7\u5144\u5f1f\u8282\u70b9\u662f\u7528 sibling \u6307\u9488\u6307\u5411\uff0c\u6240\u4ee5\u5728\u904d\u5386children \u904d\u5386\uff0csibling \u6307\u9488\u540c\u65f6\u79fb\u52a8\uff0c\u627e\u5230\u4e0e child \u5bf9\u5e94\u7684 oldFiber \u3002"),l.createElement("li",null,"\u7136\u540e\u901a\u8fc7\u8c03\u7528 updateSlot \uff0cupdateSlot \u5185\u90e8\u4f1a\u5224\u65ad\u5f53\u524d\u7684 tag \u548c key \u662f\u5426\u5339\u914d\uff0c\u5982\u679c\u5339\u914d\u590d\u7528\u8001 fiber \u5f62\u6210\u65b0\u7684 fiber \uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u8fd4\u56de null \uff0c\u6b64\u65f6 newFiber \u7b49\u4e8e null \u3002"),l.createElement("li",null,"\u5982\u679c\u662f\u5904\u4e8e\u66f4\u65b0\u6d41\u7a0b\uff0c\u627e\u5230\u4e0e\u65b0\u8282\u70b9\u5bf9\u5e94\u7684\u8001 fiber \uff0c\u4f46\u662f\u4e0d\u80fd\u590d\u7528 ",l.createElement("code",null,"alternate === null "),"\uff0c\u90a3\u4e48\u4f1a\u5220\u9664\u8001 fiber \u3002")),l.createElement("p",null,l.createElement("strong",null,"\u7b2c\u4e8c\u6b65\uff1a\u7edf\u4e00\u5220\u9664oldfiber")),l.createElement(a.Z,{code:"if (newIdx === newChildren.length) {\n    deleteRemainingChildren(returnFiber, oldFiber);\n    return resultingFirstChild;\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e8c\u6b65\u9002\u7528\u4e8e\u4ee5\u4e0b\u60c5\u51b5\uff0c\u5f53\u7b2c\u4e00\u6b65\u7ed3\u675f\u5b8c ",l.createElement("code",null,"newIdx === newChildren.length")," \u6b64\u65f6\u8bc1\u660e\u6240\u6709 newChild \u5df2\u7ecf\u5168\u90e8\u88ab\u904d\u5386\u5b8c\uff0c\u90a3\u4e48\u5269\u4e0b\u6ca1\u6709\u904d\u5386 oldFiber \u4e5f\u5c31\u6ca1\u6709\u7528\u4e86\uff0c\u90a3\u4e48\u8c03\u7528 deleteRemainingChildren \u7edf\u4e00\u5220\u9664\u5269\u4f59 oldFiber \u3002")),l.createElement("p",null,"\u60c5\u51b5\u4e00\uff1a\u8282\u70b9\u5220\u9664"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"oldChild: A B C D")),l.createElement("li",null,l.createElement("strong",null,"newChild: A B"))),l.createElement("p",null,"A , B \u7ecf\u8fc7\u7b2c\u4e00\u6b65\u904d\u5386\u590d\u5236\u5b8c\u6210\uff0c\u90a3\u4e48 newChild \u904d\u5386\u5b8c\u6210\uff0c\u6b64\u65f6 C D \u5df2\u7ecf\u6ca1\u6709\u7528\u4e86\uff0c\u90a3\u4e48\u7edf\u4e00\u5220\u9664 C D\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u7b2c\u4e09\u6b65\uff1a\u7edf\u4e00\u521b\u5efanewFiber")),l.createElement(a.Z,{code:"if(oldFiber === null){\n   for (; newIdx < newChildren.length; newIdx++) {\n       const newFiber = createChild(returnFiber,newChildren[newIdx],expirationTime,)\n       // ...\n   }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e09\u6b65\u9002\u5408\u5982\u4e0b\u7684\u60c5\u51b5\uff0c\u5f53\u7ecf\u5386\u8fc7\u7b2c\u4e00\u6b65\uff0coldFiber \u4e3a null \uff0c \u8bc1\u660e oldFiber \u590d\u7528\u5b8c\u6bd5\uff0c\u90a3\u4e48\u5982\u679c\u8fd8\u6709\u65b0\u7684 children \uff0c\u8bf4\u660e\u90fd\u662f\u65b0\u7684\u5143\u7d20\uff0c\u53ea\u9700\u8981\u8c03\u7528 createChild \u521b\u5efa\u65b0\u7684 fiber \u3002")),l.createElement("p",null,"\u60c5\u51b5\u4e8c\uff1a\u8282\u70b9\u589e\u52a0"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"oldChild: A B")),l.createElement("li",null,l.createElement("strong",null,"newChild: A B C D"))),l.createElement("p",null,"A B \u7ecf\u8fc7\u7b2c\u4e00\u6b65\u904d\u5386\u590d\u5236\u5b8c\uff0coldFiber \u6ca1\u6709\u53ef\u4ee5\u590d\u7528\u7684\u4e86\uff0c\u90a3\u4e48\u76f4\u63a5\u521b\u5efa C D\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u7b2c\u56db\u6b65\uff1a\u9488\u5bf9\u53d1\u751f\u79fb\u52a8\u548c\u66f4\u590d\u6742\u7684\u60c5\u51b5")),l.createElement(a.Z,{code:"const existingChildren = mapRemainingChildren(returnFiber, oldFiber);\nfor (; newIdx < newChildren.length; newIdx++) {\n    const newFiber = updateFromMap(existingChildren,returnFiber)\n    /* \u4ecemapRemainingChildren\u5220\u6389\u5df2\u7ecf\u590d\u7528oldFiber */\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"mapRemainingChildren \u8fd4\u56de\u4e00\u4e2a map \uff0cmap \u91cc\u5b58\u653e\u5269\u4f59\u7684\u8001\u7684 fiber \u548c\u5bf9\u5e94\u7684 key (\u6216 index )\u7684\u6620\u5c04\u5173\u7cfb\u3002"),l.createElement("li",null,"\u63a5\u4e0b\u6765\u904d\u5386\u5269\u4e0b\u6ca1\u6709\u5904\u7406\u7684 Children \uff0c\u901a\u8fc7 updateFromMap \uff0c\u5224\u65ad mapRemainingChildren \u4e2d\u6709\u6ca1\u6709\u53ef\u4ee5\u590d\u7528 oldFiber \uff0c\u5982\u679c\u6709\uff0c\u90a3\u4e48\u590d\u7528\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u65b0\u521b\u5efa\u4e00\u4e2a newFiber \u3002"),l.createElement("li",null,"\u590d\u7528\u7684 oldFiber \u4f1a\u4ece mapRemainingChildren \u5220\u6389\u3002")),l.createElement("p",null,"\u60c5\u51b5\u4e09\uff1a\u8282\u70b9\u4f4d\u7f6e\u6539\u53d8"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"oldChild: A B C D")),l.createElement("li",null,l.createElement("strong",null,"newChild: A B D C"))),l.createElement("p",null,"\u5982\u4e0a A B \u5728\u7b2c\u4e00\u6b65\u88ab\u6709\u6548\u590d\u7528\uff0c\u7b2c\u4e8c\u6b65\u548c\u7b2c\u4e09\u6b65\u4e0d\u7b26\u5408\uff0c\u76f4\u63a5\u8fdb\u884c\u7b2c\u56db\u6b65\uff0cC D \u88ab\u5b8c\u5168\u590d\u7528\uff0cexistingChildren \u4e3a\u7a7a\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u7b2c\u4e94\u6b65\uff1a\u5220\u9664\u5269\u4f59\u6ca1\u6709\u590d\u7528\u7684oldFiber")),l.createElement(a.Z,{code:"if (shouldTrackSideEffects) {\n    /* \u79fb\u9664\u6ca1\u6709\u590d\u7528\u5230\u7684oldFiber */\n    existingChildren.forEach(child => deleteChild(returnFiber, child));\n}",lang:"js"}),l.createElement("p",null,"\u6700\u540e\u4e00\u6b65\uff0c\u5bf9\u4e8e\u6ca1\u6709\u590d\u7528\u7684 oldFiber \uff0c\u7edf\u4e00\u5220\u9664\u5904\u7406\u3002"),l.createElement("p",null,"\u60c5\u51b5\u56db\uff1a\u590d\u6742\u60c5\u51b5(\u5220\u9664 + \u65b0\u589e + \u79fb\u52a8)"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"oldChild: A B C D")),l.createElement("li",null,l.createElement("strong",null,"newChild: A E D B"))),l.createElement("p",null,"\u9996\u5148 A \u8282\u70b9\uff0c\u5728\u7b2c\u4e00\u6b65\u88ab\u590d\u7528\uff0c\u63a5\u4e0b\u6765\u76f4\u63a5\u5230\u7b2c\u56db\u6b65\uff0c\u904d\u5386 newChild \uff0cE\u88ab\u521b\u5efa\uff0cD B \u4ece existingChildren \u4e2d\u88ab\u590d\u7528\uff0cexistingChildren \u8fd8\u5269\u4e00\u4e2a C \u5728\u7b2c\u4e94\u6b65\u4f1a\u5220\u9664 C \uff0c\u5b8c\u6210\u6574\u4e2a\u6d41\u7a0b\u3002"),l.createElement("h3",{id:"\u5173\u4e8ediffchild\u601d\u8003\u548ckey\u7684\u4f7f\u7528"},l.createElement(r.AnchorLink,{to:"#\u5173\u4e8ediffchild\u601d\u8003\u548ckey\u7684\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u5173\u4e8ediffChild\u601d\u8003\u548ckey\u7684\u4f7f\u7528"),l.createElement("ul",null,l.createElement("li",null,"1 React diffChild \u65f6\u95f4\u590d\u6742\u5ea6 O(n^3) \u4f18\u5316\u5230 O(n)\u3002"),l.createElement("li",null,"2 React key \u6700\u597d\u9009\u62e9\u552f\u4e00\u6027\u7684id\uff0c\u5982\u4e0a\u8ff0\u6d41\u7a0b\uff0c\u5982\u679c\u9009\u62e9 Index \u4f5c\u4e3a key \uff0c\u5982\u679c\u5143\u7d20\u53d1\u751f\u79fb\u52a8\uff0c\u90a3\u4e48\u4ece\u79fb\u52a8\u8282\u70b9\u5f00\u59cb\uff0c\u63a5\u4e0b\u6765\u7684 fiber \u90fd\u4e0d\u80fd\u505a\u5f97\u5230\u5408\u7406\u7684\u590d\u7528\u3002 index \u62fc\u63a5\u5176\u4ed6\u5b57\u6bb5\u4e5f\u4f1a\u9020\u6210\u76f8\u540c\u7684\u6548\u679c\u3002")),l.createElement("h2",{id:"\u4e94\u5b9e\u8df5---reactlazy--susponse\u6a21\u62df\u5f02\u6b65\u7ec4\u4ef6\u529f\u80fd"},l.createElement(r.AnchorLink,{to:"#\u4e94\u5b9e\u8df5---reactlazy--susponse\u6a21\u62df\u5f02\u6b65\u7ec4\u4ef6\u529f\u80fd","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e94\u5b9e\u8df5 - React.lazy + Susponse\u6a21\u62df\u5f02\u6b65\u7ec4\u4ef6\u529f\u80fd"),l.createElement("p",null,"\u63a5\u4e0b\u6765 React.lazy + Susponse \u6765\u5b8c\u5168\u6a21\u62df\u5b9e\u73b0\u4e00\u4e2a\u5f02\u6b65\u7ec4\u4ef6\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u5b9e\u73b0\u6548\u679c\uff1a")),l.createElement("ul",null,l.createElement("li",null,"\u5f02\u6b65\u7ec4\u4ef6\u8981\u5b9e\u73b0\u7684\u529f\u80fd\uff0c\u5f02\u6b65\u8bf7\u6c42\u6570\u636e\uff0c\u8bf7\u6c42\u5b8c\u6570\u636e\u518d\u6302\u8f7d\u7ec4\u4ef6\u3002\u6ca1\u6709\u52a0\u8f7d\u5b8c\u6570\u636e\u663e\u793a loading \u6548\u679c\u3002"),l.createElement("li",null,"\u53ef\u91cf\u5316\u751f\u4ea7\u3002")),l.createElement("p",null,l.createElement("strong",null,"\u4e3b\u8981\u601d\u8def\uff1a")),l.createElement("ul",null,l.createElement("li",null,"\u53ef\u4ee5\u4f7f\u7528 React.lazy \u5b9e\u73b0\u52a8\u6001\u52a0\u8f7d\uff0c\u90a3\u4e48\u53ef\u4ee5\u5148\u8bf7\u6c42\u6570\u636e\uff0c\u7136\u540e\u518d\u52a0\u8f7d\u7ec4\u4ef6\uff0c\u8fd9\u65f6\u5019\u4ee5 props \u5f62\u5f0f\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u76ee\u6807\u7ec4\u4ef6\uff0c\u5b9e\u73b0\u5f02\u6b65\u6548\u679c\u3002")),l.createElement("p",null,l.createElement("strong",null,"\u7f16\u5199\uff1a")),l.createElement(a.Z,{code:"/**\n * \n * @param {*} Component  \u9700\u8981\u5f02\u6b65\u6570\u636e\u7684component \n * @param {*} api        \u8bf7\u6c42\u6570\u636e\u63a5\u53e3,\u8fd4\u56dePromise\uff0c\u53ef\u4ee5\u518dthen\u4e2d\u83b7\u53d6\u4e0e\u540e\u7aef\u4ea4\u4e92\u7684\u6570\u636e\n * @returns \n */\nfunction AysncComponent(Component,api){\n    const AysncComponentPromise = () => new Promise(async (resolve)=>{\n          const data = await api()\n          resolve({\n              default: (props) => <Component rdata={data} { ...props}  />\n          })\n    })\n    return React.lazy(AysncComponentPromise)\n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u601d\u8def\uff1a")),l.createElement("ul",null,l.createElement("li",null,"\u7528 AysncComponent \u4f5c\u4e3a\u4e00\u4e2a HOC \u5305\u88c5\u7ec4\u4ef6\uff0c\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5f53\u524d\u7ec4\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e3a\u8bf7\u6c42\u6570\u636e\u7684 api \u3002"),l.createElement("li",null,"\u58f0\u660e\u4e00\u4e2a\u51fd\u6570\u7ed9 React.lazy \u4f5c\u4e3a\u56de\u8c03\u51fd\u6570\uff0cReact.lazy \u8981\u6c42\u8fd9\u4e2a\u51fd\u6570\u5fc5\u987b\u662f\u8fd4\u56de\u4e00\u4e2a Promise \u3002\u5728 Promise \u91cc\u9762\u901a\u8fc7\u8c03\u7528 api \u8bf7\u6c42\u6570\u636e\uff0c\u7136\u540e\u6839\u636e\u8fd4\u56de\u6765\u7684\u6570\u636e rdata \u6e32\u67d3\u7ec4\u4ef6\uff0c\u522b\u5fd8\u4e86\u63a5\u53d7\u5e76\u4f20\u9012 props \u3002")),l.createElement("p",null,l.createElement("strong",null,"\u4f7f\u7528\uff1a")),l.createElement(a.Z,{code:"/* \u6570\u636e\u6a21\u62df */\nconst getData=()=>{\n    return new Promise((resolve)=>{\n        //\u6a21\u62df\u5f02\u6b65\n        setTimeout(() => {\n             resolve({\n                 name:'alien',\n                 say:'let us learn React!'\n             })\n        }, 1000)\n    })\n}\n/* \u6d4b\u8bd5\u5f02\u6b65\u7ec4\u4ef6 */\nfunction Test({ rdata  , age}){\n    const { name , say } = rdata\n    console.log('\u7ec4\u4ef6\u6e32\u67d3')\n    return <div>\n        <div> hello , my name is { name } </div>\n        <div>age : { age } </div>\n        <div> i want to say { say } </div>\n    </div>\n}\n/* \u7236\u7ec4\u4ef6 */\nexport default class Index extends React.Component{\n    LazyTest = AysncComponent(Test,getData) /* \u9700\u8981\u6bcf\u4e00\u6b21\u5728\u7ec4\u4ef6\u5185\u90e8\u58f0\u660e\uff0c\u4fdd\u8bc1\u6bcf\u6b21\u7236\u7ec4\u4ef6\u6302\u8f7d\uff0c\u90fd\u4f1a\u91cd\u65b0\u8bf7\u6c42\u6570\u636e \uff0c\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\u3002 */\n    render(){\n        const { LazyTest } = this\n        return <div>\n           <Suspense fallback={<div>loading...</div>} >\n              <LazyTest age={18}  />\n          </Suspense>\n        </div>\n    }\n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u6548\u679c\uff1a")),l.createElement("p",null,l.createElement("img",{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/240879ad371f4031999dded287e27142~tplv-k3u1fbpfcp-watermark.awebp",alt:"1.gif"})),l.createElement("ul",null,l.createElement("li",null,"\u5982\u4e0a name \u548c say \u90fd\u662f\u6570\u636e\u4ea4\u4e92\u83b7\u53d6\u7684\u6570\u636e\u3002"),l.createElement("li",null,"\u7ec4\u4ef6\u53ea\u6e32\u67d3\u4e86\u4e00\u6b21\uff0c\u5b9e\u73b0\u4e86\u5f02\u6b65\u6e32\u67d3\u7684\u6548\u679c\u3002")),l.createElement("p",null,l.createElement("strong",null,"\u603b\u7ed3\uff1a")),l.createElement("p",null,"\u8fd9\u4e2ademo\u4ec5\u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u52a0\u6df1\u4ee5\u4e0b\u5bf9\u5f02\u6b65\u7ec4\u4ef6\u548c HOC \u7684\u7406\u89e3\uff0c\u4f46\u662f\u8fd9\u79cd\u5728\u771f\u5b9e\u7684\u5f00\u53d1\u573a\u666f\u4e5f\u4f1a\u9047\u5230\u4e00\u4e9b\u95ee\u9898\u3002"),l.createElement("ul",null,l.createElement("li",null,"1 \u9700\u8981\u7ea6\u5b9a\u597d\u63a5\u53d7\u6570\u636e\u683c\u5f0frdata\u548c\u6570\u636e\u4ea4\u4e92\u5f62\u5f0fapi\u3002"),l.createElement("li",null,"2 \u56e0\u4e3a\u6570\u636e\u672c\u8d28\u662f\u7528\u95ed\u5305\u7f13\u5b58\u7684\uff0c\u6240\u4ee5\u7ed1\u5b9a\u9700\u8981\u5728\u5728\u7ec4\u4ef6\u5185\u90e8\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u6bcf\u6b21\u7236\u7ec4\u4ef6\u6302\u8f7d\uff0c\u90fd\u4f1a\u91cd\u65b0\u8bf7\u6c42\u6570\u636e\uff0c\u53e6\u5916\u4e5f\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\u60c5\u51b5\u53d1\u751f\u3002"),l.createElement("li",null,"3 \u6570\u636e\u6e90\u66f4\u65b0\u7ef4\u62a4\u56f0\u96be\u3002")),l.createElement("h2",{id:"\u516d\u603b\u7ed3"},l.createElement(r.AnchorLink,{to:"#\u516d\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u516d\u603b\u7ed3"),l.createElement("p",null,"\u8fd9\u8282\u4e3b\u8981\u8bb2\u4e86 React \u672a\u6765\u7248\u672c\u7684\u5f02\u6b65\u7ec4\u4ef6\uff0cReact.lazy + Susponse \u52a8\u6001\u52a0\u8f7d\u539f\u7406\uff0c\u6e32\u67d3\u7684\u9519\u8bef\u8fb9\u754c\u53ca\u5176\u5904\u7406\uff0cdiff \u6027\u80fd\u8c03\u4f18\uff0c\u4ee5\u53ca\u7528\u4e00\u4e2a\u5b9e\u8df5 demo \uff0clazy + susponse \u6a21\u62df\u5b9e\u73b0\u4e86\u5f02\u6b65\u7ec4\u4ef6\u3002")))}));n["default"]=e=>{var n=l.useContext(r.context),t=n.demos;return l.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&r.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.createElement(c,{demos:t})}}}]);