(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[3554],{2711:function(e,n,t){"use strict";t.r(n);var l=t(67294),a=t(96089),r=t(65659),o=l.memo((e=>{e.demos;return l.createElement(l.Fragment,null,l.createElement("div",{className:"markdown"},l.createElement("h2",{id:"\u4e00-\u524d\u8a00"},l.createElement(a.AnchorLink,{to:"#\u4e00-\u524d\u8a00","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e00 \u524d\u8a00"),l.createElement("p",null,"\u672c\u7ae0\u8282\u5c06\u7ee7\u7eed\u4ecb\u7ecd React \u7684\u53e6\u5916\u4e00\u4e2a\u72b6\u6001\u7ba1\u7406\u5de5\u5177 React-Mobx \u3002\u5e0c\u671b\u901a\u8fc7\u672c\u7ae0\u8282\u7684\u5b66\u4e60\uff0c\u4f60\u80fd\u6536\u83b7\uff1a"),l.createElement("ul",null,l.createElement("li",null,"Mobx \u7684\u7279\u6027\u53ca\u5176\u57fa\u672c\u4f7f\u7528\uff1b"),l.createElement("li",null,"Mobx \uff0cReact-Mobx \u539f\u7406\u89e3\u6790\uff08\u6e90\u7801\u7ea7\u522b\uff09\uff1b"),l.createElement("li",null,"Mobx \u548c Redux \u533a\u522b\u3002")),l.createElement("blockquote",null,l.createElement("p",null,"\u6ce8\u610f\uff1a\u4eca\u5929\u8bb2\u7684 Mobx \u4e3a ",l.createElement("code",null,"v6")," \u7248\u672c\uff0cMobx-React \u4e3a ",l.createElement("code",null,"v7")," \u7248\u672c\u3002")),l.createElement("h2",{id:"\u4e8c-mobx\u7279\u6027"},l.createElement(a.AnchorLink,{to:"#\u4e8c-mobx\u7279\u6027","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e8c Mobx\u7279\u6027"),l.createElement("p",null,"\u540c\u4e3a\u72b6\u6001\u7ba1\u7406\u5de5\u5177\uff0cMobx \u548c Redux \u672c\u8d28\u4e0a\u4e0a\u6709\u5f88\u5927\u7684\u533a\u522b\uff0c\u4f46\u662f Mobx \u548c Redux \u90fd\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u4f9d\u8d56\u4e8e React \u672c\u8eab\uff1b\u4e3a\u4e86\u628a React \u548c Mobx \u5173\u8054\u8d77\u6765\uff0c\u5728 React \u5e94\u7528\u4e2d\u66f4\u597d\u7684\u4f7f\u7528 Mobx \uff0c\u51fa\u73b0\u4e86 mobx-react \uff0c mobx-react \u63d0\u4f9b\u4e86 HOC \uff0c\u53ef\u4ee5\u83b7\u53d6\u72b6\u6001\u7ba1\u7406 Mobx \u7684\u6570\u636e\u5c42\uff0c\u4e5f\u80fd\u63a5\u53d7 mobx \u6570\u636e\u6539\u53d8\u5e26\u6765\u7684\u66f4\u65b0\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u2460\u89c2\u5bdf\u8005\u6a21\u5f0f")),l.createElement("p",null,"Mobx \u91c7\u7528\u4e86\u4e00\u79cd'\u89c2\u5bdf\u8005\u6a21\u5f0f'\u2014\u2014",l.createElement("code",null,"Observer"),"\uff0c\u6574\u4e2a\u8bbe\u8ba1\u67b6\u6784\u90fd\u662f\u56f4\u7ed5 Observer \u5c55\u5f00\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u5728 mobx \u7684\u72b6\u6001\u5c42\uff0c\u6bcf\u4e00\u4e2a\u9700\u8981\u89c2\u5bdf\u7684\u5c5e\u6027\u90fd\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u89c2\u5bdf\u8005\uff0c\u53ef\u4ee5\u79f0\u4e4b\u4e3a ",l.createElement("code",null,"ObserverValue")," \u3002"),l.createElement("li",null,"\u6709\u4e86\u89c2\u5bdf\u8005\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5411\u89c2\u5bdf\u8005\u4e2d\u6536\u96c6 listener \uff0cmobx \u4e2d\u6709\u4e00\u4e2a Reaction \u6a21\u5757\uff0c\u53ef\u4ee5\u5bf9\u4e00\u4e9b\u884c\u4e3a\u505a\u4f9d\u8d56\u6536\u96c6\uff0c\u5728 React \u4e2d\uff0c\u662f\u901a\u8fc7\u52ab\u6301 render \u51fd\u6570\u6267\u884c\u884c\u4e3a\uff0c\u8fdb\u884c\u7684\u4f9d\u8d56\u6536\u96c6\u3002"),l.createElement("li",null,"\u5982\u4f55\u76d1\u542c\u6539\u53d8\uff0c\u7528\u81ea\u5b9a\u4e49\u5b58\u53d6\u5668\u5c5e\u6027\u4e2d\u7684 get \u548c set \uff0c\u6765\u8fdb\u884c\u7684\u4f9d\u8d56\u6536\u96c6\u548c\u66f4\u65b0\u6d3e\u53d1\uff0c\u5f53\u72b6\u6001\u6539\u53d8\uff0c\u89c2\u5bdf\u8005\u4f1a\u76f4\u63a5\u7cbe\u786e\u901a\u77e5\u6bcf\u4e2a listener \u3002")),l.createElement("p",null,l.createElement("strong",null,"\u2461\u72b6\u6001\u63d0\u5347")),l.createElement("p",null,"\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728 React \u5e94\u7528\u4e2d\u4f7f\u7528 Mobx \uff0c\u672c\u8d28\u4e0a mobx \u91cc\u9762\u7684\u72b6\u6001\uff0c\u5e76\u4e0d\u662f\u5b58\u5728 React \u7ec4\u4ef6\u91cc\u9762\u7684\uff0c\u662f\u5728\u5916\u90e8\u7531\u4e00\u4e2a\u4e2a mobx \u7684\u6a21\u5757 model \u6784\u6210\uff0c\u6bcf\u4e00\u4e2a model \u53ef\u4ee5\u7406\u89e3\u6210\u4e00\u4e2a\u5bf9\u8c61\uff0c\u72b6\u6001\u5b9e\u8d28\u5b58\u5728 model \u4e2d\uff0cmodel \u72b6\u6001\u901a\u8fc7 props \u6dfb\u52a0\u5230\u7ec4\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u7528 mobx-react \u4e2d\u7684 Provder \u548c inject \u4fbf\u6377\u83b7\u53d6\u5b83\u4eec\uff0c\u867d\u7136 mobx \u4e2d\u54cd\u5e94\u5f0f\u5904\u7406\u8fd9\u4e9b\u72b6\u6001\uff0c\u4f46\u662f\u4e0d\u8981\u8bd5\u56fe\u76f4\u63a5\u4fee\u6539 props \u6765\u4fc3\u4f7f\u66f4\u65b0\uff0c\u8fd9\u6837\u8fdd\u80cc\u4e86 React Prop \u5355\u5411\u6570\u636e\u6d41\u7684\u539f\u5219\u3002\u6b63\u786e\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u8fd8\u662f\u901a\u8fc7 model \u4e0b\u9762\u7684 action \u65b9\u6cd5\uff0c\u6765\u6539\u53d8\u72b6\u6001\uff0cReact \u5b9e\u8d28\u4e0a\u8c03\u7528\u7684\u662f action \u65b9\u6cd5\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u2462\u88c5\u9970\u5668\u6a21\u5f0f")),l.createElement("p",null,"\u4e3a\u4e86\u5efa\u7acb\u89c2\u5bdf\u8005\u6a21\u5f0f\uff0c\u4fbf\u6377\u5730\u83b7\u53d6\u72b6\u6001/\u76d1\u542c\u72b6\u6001\uff0cmobx \u5f88\u591a\u63a5\u53e3\u90fd\u652f\u6301\u88c5\u9970\u5668\u6a21\u5f0f\u7684\u5199\u6cd5\uff0c\u6240\u4ee5\u5728 mobx \u4e2d\uff0c\u88c5\u9970\u5668\u6a21\u5f0f\u662f\u6700\u5e38\u7528\u7684\u5199\u6cd5\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u88c5\u9970\u5668\u7684\u540c\u5b66\uff0c\u5efa\u8bae\u5148\u4e86\u89e3\u4e00\u4e0b\u4e0b ts \u4e2d",l.createElement("code",null,"decorator"),"\uff0c\u7531\u4e8e\u4e0d\u662f\u672c\u7ae0\u8282\u7684\u5185\u5bb9\uff0c\u6211\u8fd9\u91cc\u5c31\u4e0d\u4ecb\u7ecd\u4e86\u3002\u6bd4\u5982\u5982\u4e0b\u5c31\u662f mobx \u4e2d\u88c5\u9970\u5668\u7684\u4f53\u73b0\uff1a"),l.createElement(r.Z,{code:"class Root{\n    @observable name = 'alien' /* \u5efa\u7acb\u89c2\u5bdf\u8005name\u5c5e\u6027 */\n    @action setName(name){  this.name = name   }  /* \u6539\u53d8 name \u5c5e\u6027 */\n}",lang:"js"}),l.createElement("p",null,"\u76ee\u524d typescript \u5df2\u7ecf\u5168\u9762\u652f\u6301\u5982\u4e0a\u5199\u6cd5\uff0c\u5982\u679c\u5728 javascript \u4e2d\u76f4\u63a5\u4f7f\u7528\u4f1a\u62a5\u9519\uff0c\u6240\u4ee5\u901a\u5e38\u9700\u8981\u5728",l.createElement("code",null,".babelrc")," \u4e2d\u8fd9\u4e48\u914d\u7f6e\u4e00\u4e0b\uff1a"),l.createElement(r.Z,{code:'{\n    "plugins":[\n         [\n          "@babel/plugin-proposal-decorators",\n          {\n            "legacy": true,\n            "loose": true\n          }\n        ],\n        "@babel/plugin-proposal-class-properties",\n    ]\n}',lang:"json"}),l.createElement("p",null,"\u5982\u4e0a\u6dfb\u52a0\u914d\u7f6e\u540e\uff0c\u5c31\u53ef\u4ee5\u5728 js \u4e2d\u6b63\u5e38\u4f7f\u7528\u88c5\u9970\u5668\u6a21\u5f0f\u4e86\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u2463\u7cbe\u786e\u9897\u7c92\u5316\u6536\u96c6")),l.createElement("p",null,"mobx \u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7279\u70b9\uff0c\u5c31\u662f\u5bf9\u4e8e\u5c5e\u6027\u7684\u4f9d\u8d56\u6536\u96c6\u662f\u7cbe\u786e\u7684\uff0c\u9897\u7c92\u5316\u7684\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bf4\u5462\uff1f\u6bd4\u5982\u5728 mobx \u4e00\u4e2a\u6a21\u5757\u5982\u4e0b\u5199\u9053\uff1a"),l.createElement(r.Z,{code:"class Root {\n    @observable object = {                  //C\u7ec4\u4ef6\u4f7f\u7528\n         name:'alien',                     // A\u7ec4\u4ef6\u4f7f\u7528\n         mes:'let us learn React!'         // B\u7ec4\u4ef6\u4f7f\u7528\n    }\n    @action setName(name){ this.object.name = name  }\n    @action setMes(mes){ this.object.mes = mes }\n    @action setObject(object){ this.object = object  }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u5bf9\u4e8e observable \u5904\u7406\u8fc7\u7684\u5c5e\u6027\uff0c\u6bcf\u4e00\u4e2a\u5c5e\u6027\u90fd\u4f1a\u6709 ObserverValue \uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u7ed3\u6784\u4f1a\u4ea7\u751f\u4e09\u4e2a ObserverValue \uff0c\u5206\u522b\u5bf9\u5e94 object \uff0cname \uff0cmes \u3002"),l.createElement("li",null,"\u5f53\u4e0a\u9762\u901a\u8fc7 setName \u6539\u53d8 name \u5c5e\u6027\u7684\u65f6\u5019\uff0c\u53ea\u6709\u7ec4\u4ef6 A \u4f1a\u66f4\u65b0\u3002\u4e5f\u5c31\u662f name ObserverValue \u53ea\u6536\u96c6\u4e86\u7528\u5230 name \u7684\u4f9d\u8d56\u9879 A \u7ec4\u4ef6\u3002"),l.createElement("li",null,"\u8c03\u7528 setMes \u540c\u7406\uff0c\u53ea\u6709\u7ec4\u4ef6 B \u66f4\u65b0\u3002 mes ObserverValue \u53ea\u6536\u96c6\u4e86 B \u7ec4\u4ef6\u7684\u4f9d\u8d56\u3002"),l.createElement("li",null,"\u5f53\u4e0a\u9762\u901a\u8fc7 setObject \u6539\u53d8 object \u7684\u65f6\u5019\uff0c\u5373\u4f7f object \u91cc\u9762name \uff0cmes \u7684\u503c\u6ca1\u6709\u53d8\u5316\uff0c\u4e5f\u4f1a\u8ba9\u7ec4\u4ef6 A \uff0c\u7ec4\u4ef6 B \uff0c\u7ec4\u4ef6 C \uff0c\u5168\u90e8\u6e32\u67d3\u3002object \u7684 Observer \u540c\u6837\u6536\u96c6\u4e86name\u7684 ObserverValue \u548c mes \u7684 ObserverValue \u3002")),l.createElement("p",null,"\u6a21\u578b\u56fe\u5982\u4e0b\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1268c78788bd436887d91d9d997b680a~tplv-k3u1fbpfcp-watermark.awebp",alt:"2.jpg"})),l.createElement("p",null,l.createElement("strong",null,"\u2464\u5f15\u7528\u7c7b\u578b\u5904\u7406")),l.createElement("p",null,"observable \u5bf9\u4e8e\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u6bd4\u5982 Object \uff0cArray \uff0cSet \uff0cMap\u7b49\uff0c\u9664\u4e86\u65b0\u5efa\u4e00\u4e2a observable \u4e4b\u5916\uff0c\u8fd8\u4f1a\u505a\u5982\u4e0b\u4e24\u70b9\u64cd\u4f5c\u3002"),l.createElement("ul",null,l.createElement("li",null,"\u4e00 ",l.createElement("code",null,"Proxy"),"\uff1a\u4f1a\u628a\u539f\u59cb\u5bf9\u8c61\u7528 Proxy \u4ee3\u7406\uff0cProxy \u4f1a\u7cbe\u786e\u54cd\u5e94\u539f\u59cb\u5bf9\u8c61\u7684\u53d8\u5316\uff0c\u6bd4\u5982\u589e\u52a0\u5c5e\u6027\u2014\u2014\u7ed9\u5c5e\u6027\u7ed1\u5b9a ObserverValue \uff0c\u5220\u9664\u5c5e\u6027\u2014\u2014\u7ed9\u5c5e\u6027\u89e3\u7ed1 ObserverValue \u7b49\u3002"),l.createElement("li",null,"\u4e8c ",l.createElement("code",null,"ObservableAdministration"),"\uff1a \u5bf9\u4e8e\u5b50\u4ee3\u5c5e\u6027\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a ",l.createElement("code",null,"ObservableAdministration"),"\uff0c\u7528\u4e8e\u7ba1\u7406\u5b50\u4ee3\u5c5e\u6027\u7684ObserverValue\u3002"),l.createElement("li",null,"\u5bf9\u4e8e\u5916\u5c42 Root \uff0c\u5728 ",l.createElement("code",null,"constructor")," \u4f7f\u7528 ",l.createElement("code",null,"makeObservable")," \uff0cmobx \u4f1a\u9ed8\u8ba4\u7ed9\u6700\u5916\u5c42\u7684 Root \u6dfb\u52a0 ObservableAdministration \u3002")),l.createElement("h2",{id:"\u4e09-\u57fa\u672c\u7528\u6cd5"},l.createElement(a.AnchorLink,{to:"#\u4e09-\u57fa\u672c\u7528\u6cd5","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e09 \u57fa\u672c\u7528\u6cd5"),l.createElement("h3",{id:"1-mobx\u57fa\u672c\u4f7f\u7528"},l.createElement(a.AnchorLink,{to:"#1-mobx\u57fa\u672c\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"1 Mobx\u57fa\u672c\u4f7f\u7528"),l.createElement("h4",{id:"mobx\u5e38\u7528api"},l.createElement(a.AnchorLink,{to:"#mobx\u5e38\u7528api","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"mobx\u5e38\u7528api"),l.createElement("p",null,"\u628a\u4e0a\u8ff0\u6bcf\u4e00\u4e2a class \u79f0\u4e4b\u4e3a\u4e00\u4e2a\u6a21\u5757\uff0c\u5982\u4e0a\u8ff0 Root \u5c31\u662f\u4e00\u4e2a\u6a21\u5757\u3002mobx\u7684 api \u57fa\u672c\u7528\u4e8e\u6784\u5efa\u6bcf\u4e00\u4e2a\u54cd\u5e94\u5f0f\u6a21\u5757\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u2460 makeObservable")),l.createElement("p",null,"\u5728\u65b0\u7248\u672c mobx \u4e2d\uff0c\u60f3\u8981\u8ba9\u6574\u4e2a\u6a21\u5757\u53d8\u6210\u53ef\u54cd\u5e94\u5f0f\u7684\uff0c\u90a3\u4e48\u9700\u8981\u5728 constructor \u8c03\u7528 makeObservable\u3002\u8001\u7248\u672c\u7684 mobx \u4e0d\u9700\u8981\u8fd9\u4e48\u505a\u3002"),l.createElement(r.Z,{code:"constructor(){ makeObservable(this) }",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u2461 observable")),l.createElement("p",null,"\u4f1a\u7ed9\u5c5e\u6027\u503c\u52a0\u4e00\u4e2a\u89c2\u5bdf\u8005\u5bf9\u8c61\uff0c\u4f7f\u5176\u80fd\u53d8\u6210\u53ef\u89c2\u5bdf\u7684\uff0c\u5f53\u5c5e\u6027\u503c\u6539\u53d8\u7684\u65f6\u5019\uff0c\u89c2\u5bdf\u8005\u4f1a\u901a\u77e5\u6bcf\u4e00\u4e2a\u4f9d\u8d56\u9879\u3002"),l.createElement(r.Z,{code:"@observable name = '\u300aReact\u8fdb\u9636\u5b9e\u8df5\u6307\u5357\u300b'",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u2462action")),l.createElement("p",null,"\u901a\u8fc7 action \u5305\u88f9\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u6765\u4fee\u6539 mobx \u4e2d\u7684\u72b6\u6001\u3002"),l.createElement(r.Z,{code:"@action setName(newName){ this.name = newName  }",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u2463computed")),l.createElement("p",null,"\u6839\u636e\u73b0\u6709\u7684\u72b6\u6001\u6216\u5176\u5b83\u8ba1\u7b97\u503c\u884d\u751f\u51fa\u7684\u503c\u3002\u5982\u4e0b total \u662f\u901a\u8fc7 price \u548c count \u884d\u751f\u51fa\u6765\u7684\u65b0\u503c\u3002"),l.createElement(r.Z,{code:"@observable price = 666  // \u53ef\u89c2\u5bdf\u5c5e\u6027\u2014\u2014\u4ef7\u683c\n@observable count = 1    // \u53ef\u89c2\u5bdf\u5c5e\u6027\u2014\u2014\u6570\u91cf\n@computed get total() {  \n    return this.price * this.count\n}",lang:"js"}),l.createElement("h4",{id:"mobx-react-\u5e38\u7528-api"},l.createElement(a.AnchorLink,{to:"#mobx-react-\u5e38\u7528-api","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"mobx-react \u5e38\u7528 api"),l.createElement("p",null,"mobx-react \u4e2d\u7684 api \uff0c\u7528\u4e8e\u628a mobx \u4e2d\u7684\u72b6\u6001\uff0c\u63d0\u4f9b\u7ed9\u7ec4\u4ef6\uff0c\u5e76\u628a\u7ec4\u4ef6\u4e5f\u53d8\u6210\u53ef\u89c2\u5bdf\u7684 \u2014\u2014 mobx \u72b6\u6001\u6539\u53d8\uff0c\u7ec4\u4ef6\u89e6\u53d1\u66f4\u65b0\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u2460Provider")),l.createElement("p",null,"\u7528\u4e8e\u628a mobx \u7684\u5404\u4e2a\u6a21\u5757\uff0c\u7528 Context \u4e0a\u4e0b\u6587\u5f62\u5f0f\uff0c\u4fdd\u5b58\u8d77\u6765\uff0c\u4f9b\u7ed9\u7ec4\u4ef6\u4f7f\u7528\u3002"),l.createElement(r.Z,{code:"<Provider Root={Root} > { /* ... */ } </Provider>",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u2461inject")),l.createElement("p",null,"inject \u9ad8\u9636\u7ec4\u4ef6\u53ef\u4ee5\u628a Provider \u4e2d\u7684 mobx \u6a21\u5757\uff0c\u6df7\u5165\u5230\u7ec4\u4ef6\u7684 props \u4e2d\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u5728\u7ec4\u4ef6\u4e2d\u6d88\u8d39\u72b6\u6001\uff0c\u6216\u8005\u8c03\u7528\u6539\u53d8\u72b6\u6001\u7684\u65b9\u6cd5\u3002"),l.createElement(r.Z,{code:"@inject('Root')\nclass Index extends React.Component{}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u2462observer")),l.createElement("p",null,"\u88ab observer \u9ad8\u9636\u7ec4\u4ef6\u5305\u88c5\u7684\u7ec4\u4ef6\uff0c\u5982\u679c\u7ec4\u4ef6\u5185\u90e8\u5f15\u5165\u4e86 mobx \u53ef\u89c2\u5bdf\u5c5e\u6027\u503c\uff0c\u5f53\u503c\u6539\u53d8\u7684\u65f6\u5019\uff0c\u4f1a\u8ffd\u6eaf\u5230\u5f53\u524d\u7ec4\u4ef6\uff0c\u4fc3\u4f7f\u5f53\u524d\u7ec4\u4ef6\u66f4\u65b0\u3002"),l.createElement(r.Z,{code:"@observer\nclass Index extends  React.Component{}",lang:"js"}),l.createElement("p",null,"\u4e0a\u9762\u4ecb\u7ecd\u4e86\u4e00\u904d mobx \u548c mobx-react \u7684\u5404\u4e2a\u90e8\u5206\u529f\u80fd\uff0c\u63a5\u4e0b\u6765\u9488\u5bf9\u4e24\u79cd\u4f7f\u7528\u573a\u666f\u8fdb\u884c\u5b9e\u8df5\u3002"),l.createElement("h3",{id:"2-\u5b9e\u8df5\u5b9e\u73b0\u72b6\u6001\u5171\u4eab"},l.createElement(a.AnchorLink,{to:"#2-\u5b9e\u8df5\u5b9e\u73b0\u72b6\u6001\u5171\u4eab","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"2 \u5b9e\u8df5\u2014\u2014\u5b9e\u73b0\u72b6\u6001\u5171\u4eab"),l.createElement("p",null,"\u63a5\u4e0b\u6765\u7528 mobx \u5b9e\u73b0\u72b6\u6001\u5171\u4eab\u573a\u666f\u3002\u9996\u5148\u521b\u5efa Root \u6a21\u5757\uff0c\u7528\u4e8e\u4fdd\u5b58\u5168\u5c40\u7684\u4e00\u4e9b\u6570\u636e\u3002"),l.createElement(r.Z,{code:"import { observable ,action ,makeObservable } from 'mobx'\nclass Root{\n   constructor(){\n      makeObservable(this)\n   }\n   @observable info={ name:'xxx', mes:'xxx' }\n   // @observable number = 1\n   @action setInfo(info){  this.info = info }\n}\nexport default new Root()",lang:"js"}),l.createElement("p",null,"\u6839\u672c\u7ec4\u4ef6\u6ce8\u5165\u72b6\u6001\uff1a"),l.createElement(r.Z,{code:"import Root from './mobx'\nexport default function Index(){\n    return <Provider Root={Root} >\n        <Child />\n    </Provider>\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u5168\u5c40\u901a\u8fc7 mobx-react \u4e2d\u7684 Provider \u4f20\u9012\u5185\u5bb9\u3002")),l.createElement("p",null,"\u4f7f\u7528\u72b6\u6001\uff1a"),l.createElement(r.Z,{code:"const getUserInfo = () => {\n   return new Promise((resolve=>{\n            setTimeout(()=>{resolve({ name:'alien', mes:'let us learn React!'})\n       },1000)\n   }))\n}\n@inject('Root')\n@observer\nclass Child extends React.Component{\n    async componentDidMount(){\n       /*  \u6a21\u62df\u6570\u636e\u4ea4\u4e92 */\n       const res = await getUserInfo()\n       this.props.Root.setInfo(res)\n    }\n    render(){\n        const { info } = this.props.Root\n        return <div className=\"box\" >\n            <p> \u59d3\u540d\uff1a{info.name} </p>\n            <p> \u60f3\u5bf9\u5927\u5bb6\u8bf4\uff1a{info.mes} </p>\n        </div>\n    }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"inject \u5f15\u5165 Root\uff0cobserver \u505a\u6570\u636e\u54cd\u5e94\uff0c\u6a21\u62df\u6570\u636e\u4ea4\u4e92\uff0c\u8c03\u7528 setInfo \u6539\u53d8 Root \u4e2d info \u5185\u5bb9\u3002 info \u5185\u5bb9\u6539\u53d8\uff0c\u91cd\u65b0\u6e32\u67d3\u89c6\u56fe\u3002")),l.createElement("h3",{id:"3-\u5b9e\u8df5\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"},l.createElement(a.AnchorLink,{to:"#3-\u5b9e\u8df5\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"3 \u5b9e\u8df5\u2014\u2014\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"),l.createElement("p",null,"\u63a5\u4e0b\u6765\u6a21\u62df\u7ec4\u4ef6\u901a\u4fe1\u573a\u666f\uff1a\u9996\u5148\u6ce8\u518c\u6a21\u5757\u7528\u4e8e\u7ec4\u4ef6\u901a\u4fe1\u3002"),l.createElement(r.Z,{code:"class Communi {\n   constructor(){\n       makeObservable(this)\n   }\n   @observable mesA = ''\n   @observable mesB = ''\n   @action setMesA(mes){ this.mesA = mes }\n   @action setMesB(mes){ this.mesB = mes }\n}\nexport default new Communi()",lang:"js"}),l.createElement("p",null,"\u7136\u540e\u5efa\u7acbA\uff0cB\u7ec4\u4ef6\u5b9e\u73b0\u901a\u4fe1\u529f\u80fd\uff1a"),l.createElement(r.Z,{code:"@inject('Communi')\n@observer\nclass ComponentA extends React.Component{ /* \u7ec4\u4ef6A */\n    state={ CompAsay:''}\n    render(){\n        const { CompAsay } = this.state\n        const { mesB  } = this.props.Communi\n        return <div className=\"box\" >\n        <p>\u6211\u662f\u7ec4\u4ef6A</p>\n        <div> B\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{mesB} </div>\n        \u6211\u5bf9B\u7ec4\u4ef6\u8bf4\uff1a <input onChange={(e) => this.setState({ CompAsay :e.target.value })} placeholder=\"CompAsay\" />\n        <button onClick={() => this.props.Communi.setMesA(CompAsay)} >\u786e\u5b9a</button>\n      </div>\n    }\n}\n@inject('Communi')\n@observer\nclass ComponentB extends React.Component{ /* \u7ec4\u4ef6B */\n   state={ compBsay:''}\n   render(){\n       const { compBsay } = this.state\n       const {  mesA  } = this.props.Communi\n       return <div className=\"box pt50\" >\n            <p>\u6211\u662f\u7ec4\u4ef6B</p>\n           <div> A\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{mesA} </div>\n           \u6211\u5bf9A\u7ec4\u4ef6\u8bf4\uff1a<input onChange={(e) => this.setState({ compBsay :e.target.value })}  placeholder=\"CompAsay\" />\n           <button onClick={() => this.props.Communi.setMesB(compBsay)} >\u786e\u5b9a</button>\n       </div>\n   }\n}",lang:"js"}),l.createElement("p",null,"\u6548\u679c\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b80f4d277744fe6999e214f036d97fb~tplv-k3u1fbpfcp-watermark.awebp",alt:"1.gif"})),l.createElement("h2",{id:"\u56db-mobx\u6d41\u7a0b\u5206\u6790\u548c\u539f\u7406\u63ed\u79d8"},l.createElement(a.AnchorLink,{to:"#\u56db-mobx\u6d41\u7a0b\u5206\u6790\u548c\u539f\u7406\u63ed\u79d8","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u56db Mobx\u6d41\u7a0b\u5206\u6790\u548c\u539f\u7406\u63ed\u79d8"),l.createElement("p",null,"\u63a5\u4e0b\u6765\u5f00\u59cb\u6b63\u5f0f\u8fdb\u5165 Mobx \u6d41\u7a0b\u5206\u6790\u548c\u539f\u7406\u63ed\u79d8\u73af\u8282\u3002\u4ece\u672c\u7ae0\u8282\u7684\u7b2c\u4e8c\u90e8\u5206\uff0c\u5c31\u5f00\u59cb\u4ecb\u7ecd\u4e86 mobx \u5185\u90e8\uff0c\u53ef\u89c2\u5bdf\u5c5e\u6027 ObserverValue \u6700\u540e\u4f1a\u88abmobx \u5e95\u5c42\u5904\u7406\u7684\u6837\u5b50\u3002\u4e8e\u662f\u987a\u85e4\u6478\u74dc\uff0c\u5256\u6790 mobx \u7684\u6574\u4e2a\u6d41\u7a0b\u3002"),l.createElement("p",null,"\u53ef\u4ee5\u4ece\u4e09\u4e2a\u89d2\u5ea6\u5206\u6790 mobx \u548c mobx-react \u6574\u4e2a\u6d41\u7a0b\uff1a"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"\u521d\u59cb\u5316"),"\uff1a\u9996\u5148\u5c31\u662f mobx \u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u662f\u5982\u4f55\u5904\u7406 observable \u53ef\u89c2\u5bdf\u5c5e\u6027\u7684\u3002"),l.createElement("li",null,l.createElement("strong",null,"\u4f9d\u8d56\u6536\u96c6"),"\uff1a\u7b2c\u4e8c\u70b9\u5c31\u662f\u901a\u8fc7 mobx-react \u4e2d\u7684 observer \uff0c\u5982\u4f55\u6536\u96c6\u4f9d\u8d56\u9879\uff0c\u4e0e observable \u5efa\u7acb\u8d77\u5173\u7cfb\u7684\u3002"),l.createElement("li",null,l.createElement("strong",null,"\u6d3e\u53d1\u66f4\u65b0"),"\uff1a\u6700\u540e\u5c31\u662f\u5f53\u6539\u53d8\u53ef\u89c2\u5bdf\u5c5e\u6027\u7684\u503c\u7684\u65f6\u5019\uff0c\u5982\u4f55\u66f4\u65b0\u5bf9\u5e94\u7ec4\u4ef6\u7684\u3002")),l.createElement("p",null,"\u6bd4\u5982\u5982\u4e0b\u5728 mobx \u4e2d\u7684\u4e00\u4e2a\u6a21\u5757\u8fd9\u4e48\u5199\u9053\uff08\u8fd9\u91cc\u79f0\u4e4b\u4e3a ",l.createElement("strong",null,"DEMO1")," \uff09\uff1a"),l.createElement(r.Z,{code:"class Root {\n    constructor(){ makeObservable(this) }\n    @observable authorInfo = {\n        name:'alien',\n        mes:{\n            say:'let us learn React!',\n        }\n    }\n    @observable name='\u300aReact\u8fdb\u9636\u5b9e\u8df5\u6307\u5357\u300b'\n    @action setName(newName){ this.name = newName  }\n}",lang:"js"}),l.createElement("p",null,"\u4ee5\u4e0a\u9762\u7684 DEMO1 \u4f5c\u4e3a\u57fa\u7840\u53c2\u8003\u3002"),l.createElement("h3",{id:"1-\u6a21\u5757\u521d\u59cb\u5316"},l.createElement(a.AnchorLink,{to:"#1-\u6a21\u5757\u521d\u59cb\u5316","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"1 \u6a21\u5757\u521d\u59cb\u5316"),l.createElement("p",null,"\u9996\u5148\u662f\u6a21\u5757\u521d\u59cb\u5316\u6d41\u7a0b\u3002\u53ef\u4ee5\u4ece ",l.createElement("code",null,"makeObservable")," \u548c ",l.createElement("code",null,"observable")," \u5165\u624b\u3002"),l.createElement("p",null,"\u9996\u5148\u88ab observable \u88c5\u9970\u5668\u5305\u88f9\u7684\u5c5e\u6027\u5230\u5e95\u505a\u4e86\u4e9b\u4ec0\u4e48\u5462\uff1f"),l.createElement("h4",{id:"\u7ed1\u5b9a\u72b6\u6001observable"},l.createElement(a.AnchorLink,{to:"#\u7ed1\u5b9a\u72b6\u6001observable","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2460\u7ed1\u5b9a\u72b6\u6001\u2014\u2014observable"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/api/observable.ts")),l.createElement(r.Z,{code:"function createObservable(target,name,descriptor){ // \u5bf9\u4e8e\u5982\u4e0aDEMO1\uff0ctarget\u2014\u2014Root\u7c7b\uff0cname\u2014\u2014\u5c5e\u6027\u540d\u79f0 authorInfo \u6216\u8005 name \uff0cdescriptor\u2014\u2014\u5c5e\u6027\u63cf\u8ff0\uff0c\u679a\u4e3e\u6027\uff0c\u53ef\u8bfb\u6027\u7b49\n     if(isStringish(name)){ /* \u88c5\u9970\u5668\u6a21\u5f0f\u4e0b */\n         target[Symbol(\"mobx-stored-annotations\")][name] = { /* \u5411\u7c7b\u7684mobx-stored-annotations\u5c5e\u6027\u7684name\u5c5e\u6027\u4e0a\uff0c\u7ed1\u5b9a annotationType_ \uff0c extend_ \u7b49\u65b9\u6cd5\u3002 */\n            annotationType_: 'observable',  //\u8fd9\u4e2a\u6807\u7b7e\u8bc1\u660e\u662f observable\uff0c\u9664\u4e86observable\uff0c\u8fd8\u6709 action\uff0c computed \u7b49\u3002\n            options_: null,\n            make_,  // \u8fd9\u4e2a\u65b9\u6cd5\u5728\u7c7b\u7ec4\u4ef6 makeObservable \u4f1a\u88ab\u6fc0\u6d3b\n            extend_ // \u8fd9\u4e2a\u65b9\u6cd5\u5728\u7c7b\u7ec4\u4ef6 makeObservable \u4f1a\u88ab\u6fc0\u6d3b\n        }\n     }       \n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u88ab observable \u88c5\u9970\u5668\u5305\u88c5\u7684\u5c5e\u6027\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u8c03\u7528createObservable \u65b9\u6cd5\u3002"),l.createElement("li",null,"\u901a\u8fc7 ",l.createElement("code",null,"createObservable")," \u5c06\u7c7b\u4e0a\u7ed1\u5b9a\u5f53\u524d observable \u5bf9\u5e94\u7684\u914d\u7f6e\u9879\uff0c\u8bf4\u767d\u4e86\uff0c\u5c31\u662f\u7ed9 observable \u7ed1\u5b9a\u7684\u5c5e\u6027\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u72b6\u6001\uff0c\u8fd9\u4e9b\u72b6\u6001\u5c06\u5728\u7c7b\u5b9e\u4f8b\u5316\u7684\u65f6\u5019 ",l.createElement("code",null,"makeObservable")," \u4e2d\u88ab\u6fc0\u6d3b\u3002")),l.createElement("p",null,"\u8fd9\u91cc\u6709\u5fc5\u8981\u5148\u8bb0\u5f55\u4e00\u4e0b ",l.createElement("code",null,"make_")," \u548c ",l.createElement("code",null,"extend_")," \u65b9\u6cd5\uff0c\u90fd\u505a\u4e86\u4e9b\u4ec0\u4e48\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/types/createObservableAnnotation.ts")),l.createElement(r.Z,{code:"function make_(adm,key,descriptor){ /*  */\n    return this.extend_(adm,key,descriptor)\n}\nfunction extend_(adm,key,descriptor){\n    return adm.defineObservableProperty_(key,descriptor,options)\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u9700\u8981\u8bb0\u4f4f\u4e00\u70b9\u5c31\u662f\uff1a\u5f53\u8c03\u7528 observable \u914d\u7f6e\u9879\u7684 make_ \uff0c\u672c\u8d28\u4e0a\u8c03\u7528 ",l.createElement("code",null,"adm.defineObservableProperty_")," \uff0c\u81f3\u4e8e\u8fd9\u4e2a\u662f\u4ec0\u4e48\uff0c\u9a6c\u4e0a\u5c31\u4f1a\u8bb2\u5230\u3002")),l.createElement("h4",{id:"\u6fc0\u6d3b\u72b6\u6001makeobservable"},l.createElement(a.AnchorLink,{to:"#\u6fc0\u6d3b\u72b6\u6001makeobservable","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2461\u6fc0\u6d3b\u72b6\u6001\u2014\u2014makeObservable"),l.createElement("p",null,"\u4e0a\u8fb9\u8bb2\u5230\u8fc7\uff0c\u5728\u65b0\u7248\u672c mobx \u4e2d\uff0c\u5fc5\u987b\u5728\u7c7b\u7684 constructor \u4e2d\u8c03\u7528",l.createElement("code",null,"makeObservable(this)")," \u624d\u80fd\u5efa\u7acb\u54cd\u5e94\u5f0f\u3002\u4e00\u8d77\u770b\u4e00\u4e0bmakeObservable\u3002"),l.createElement(r.Z,{code:'function makeObservable (target){ // target \u6a21\u5757\u5b9e\u4f8b\u2014\u2014this\n    const adm = new ObservableObjectAdministration(target) /* \u521b\u5efa\u4e00\u4e2a\u7ba1\u7406\u8005\u2014\u2014\u8fd9\u4e2a\u7ba1\u7406\u8005\u662f\u6700\u4e0a\u5c42\u7684\u7ba1\u7406\u8005\uff0c\u7ba1\u7406\u6a21\u5757\u4e0b\u7684observable\u5c5e\u6027 */\n    target[Symbol("mobx administration")] = adm  /* \u5c06\u7ba1\u7406\u8005 adm \u548c class \u5b9e\u4f8b\u5efa\u7acb\u8d77\u5173\u8054 */\n    startBatch()\n    try{\n        let annotations = target[Symbol("mobx-stored-annotations"] /* \u4e0a\u9762\u7b2c\u4e00\u6b65\u8bf4\u5230\uff0c\u83b7\u53d6\u72b6\u6001 */\n        Reflect.ownKeys(annotations)  /* \u5f97\u5230\u6bcf\u4e2a\u72b6\u6001\u540d\u79f0 */\n        .forEach(key => adm.make_(key, annotations[key])) /* \u5bf9\u6bcf\u4e2a\u5c5e\u6027\u8c03\u7528 */\n    }finally{\n        endBatch()\n    }\n}',lang:"js"}),l.createElement("p",null,"makeObservable \u4e3b\u8981\u505a\u7684\u4e8b\u6709\u4ee5\u4e0b\u4e24\u70b9\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u521b\u5efa\u4e00\u4e2a\u7ba1\u7406\u8005 ",l.createElement("code",null,"ObservableAdministration")," \uff0c\u4e0a\u9762\u8bb2\u5230\u8fc7\uff0c\u7ba1\u7406\u8005\u5c31\u662f\u4e3a\u4e86\u7ba1\u7406\u5b50\u4ee3\u5c5e\u6027\u7684 ObservableValue \u3002\u5e76\u548c\u6a21\u5757\u5b9e\u4f8b\u5efa\u7acb\u8d77\u5173\u7cfb\u3002"),l.createElement("li",null,"\u7136\u540e\u4f1a\u904d\u5386\u89c2\u5bdf\u8005\u72b6\u6001\u4e0b\u7684\u6bcf\u4e00\u4e2a\u5c5e\u6027\uff0c\u5c06\u6bcf\u4e2a\u5c5e\u6027\u901a\u8fc7",l.createElement("code",null,"adm.make_"),"\u5904\u7406\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c",l.createElement("strong",null,"\u8fd9\u4e2amake_\u662f\u7ba1\u7406\u8005\u7684\uff0c\u5e76\u4e0d\u662f\u5c5e\u6027\u72b6\u6001\u7684make_\uff0c\u8fd9\u4e00\u70b9\u4e0d\u8981\u5f04\u6df7\u6dc6\u4e86"),"\u3002")),l.createElement("p",null,"\u63a5\u4e0b\u6765\u4e00\u8d77\u770b\u4e00\u4e0b\uff0c\u7ba1\u7406\u8005 ObservableAdministration \u91cc\u9762\u662f\u5982\u4f55\u7ba1\u7406\u72b6\u6001\u7684\u3002"),l.createElement("h4",{id:"\u89c2\u5bdf\u8005\u5c5e\u6027\u7ba1\u7406\u8005observableadministration"},l.createElement(a.AnchorLink,{to:"#\u89c2\u5bdf\u8005\u5c5e\u6027\u7ba1\u7406\u8005observableadministration","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2462\u89c2\u5bdf\u8005\u5c5e\u6027\u7ba1\u7406\u8005\u2014\u2014ObservableAdministration"),l.createElement("p",null,"\u7ec6\u5fc3\u7684\u540c\u5b66\u5e94\u8be5\u4f1a\u53d1\u73b0\uff0c\u4e0a\u8ff0\u521d\u59cb\u5316\u521b\u5efa\u7684\u7ba1\u7406\u8005\uff0c\u8c03\u7528\u7684\u662f ",l.createElement("code",null,"ObservableObjectAdministration")," \uff0c\u5b9e\u9645\u5728 mobx \u5185\u90e8\u4f1a\u5b58\u5728\u591a\u4e2a\u79cd\u7c7b\u7684\u7ba1\u7406\u8005\uff0c\u6bd4\u5982\u6570\u7ec4\uff0c\u5bf9\u8c61\u6570\u636e\u7c7b\u578b\u3002\u56e0\u4e3a\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u91cc\u9762\u7684\u65b9\u6cd5\u548c\u72b6\u6001\u90fd\u662f\u4e0d\u540c\u7684\u3002\u672c\u6587\u662f\u4ee5\u5bf9\u8c61\u7684\u7ba1\u7406\u8005\u4f5c\u4e3a\u53c2\u8003\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/types/observableobject.ts")),l.createElement(r.Z,{code:"class ObservableObjectAdministration{\n    constructor(target_,values_){\n        this.target_ = target_\n        this.values_ = new Map() //\u5b58\u653e\u6bcf\u4e00\u4e2a\u5c5e\u6027\u7684ObserverValue\u3002\n    }\n    /* \u8c03\u7528 ObserverValue\u7684 get \u2014\u2014 \u6536\u96c6\u4f9d\u8d56  */\n    getObservablePropValue_(key){ \n        return this.values_.get(key)!.get()\n    }\n    /* \u8c03\u7528 ObserverValue\u7684 setNewValue_   */\n    setObservablePropValue_(key,newValue){\n        const observable = this.values_.get(key)\n        observable.setNewValue_(newValue) /* \u8bbe\u7f6e\u65b0\u503c */\n    }\n    make_(key,annotation){ // annotation \u4e3a\u6bcf\u4e2aobservable\u5bf9\u5e94\u7684\u914d\u7f6e\u9879\u7684\u5185\u5bb9\uff0c{ make_,extends }\n        const outcome = annotation.make_(this, key, descriptor, source)\n    }\n    /* \u8fd9\u4e2a\u51fd\u6570\u5f88\u91cd\u8981\uff0c\u7528\u4e8e\u52ab\u6301\u5bf9\u8c61\u4e0a\u7684get,set */\n    defineObservableProperty_(key,value){\n        try{\n            startBatch()\n            const descriptor = {\n                get(){      // \u5f53\u6211\u4eec\u5f15\u7528\u5bf9\u8c61\u4e0b\u7684\u5c5e\u6027\uff0c\u5b9e\u9645\u4e0a\u89e6\u53d1\u7684\u662f getObservablePropValue_\n                   this.getObservablePropValue_(key)\n                },\n                set(value){ // \u5f53\u6211\u4eec\u6539\u53d8\u5bf9\u8c61\u4e0b\u7684\u5c5e\u6027\uff0c\u5b9e\u9645\u4e0a\u89e6\u53d1\u7684\u662f setObservablePropValue_\n                   this.setObservablePropValue_(key,value)\n                }\n            }\n            Object.defineProperty(this.target_, key , descriptor)\n            const observable = new ObservableValue(value) // \u521b\u5efa\u4e00\u4e2a ObservableValue\n            this.values_.set(key, observable)             // \u8bbe\u7f6eobservable\u5230value\u4e2d\n        }finally{\n            endBatch()\n        }\n    }\n}",lang:"js"}),l.createElement("p",null,"\u56de\u5230\u4e3b\u6d41\u7a0b\u4e0a\u6765\uff0c\u5f53 mobx \u5e95\u5c42\u904d\u5386\u89c2\u5bdf\u8005\u5c5e\u6027\uff0c\u7136\u540e\u8c03\u7528 make_ \u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u672c\u8d28\u4e0a\u8c03\u7528\u7684\u662f\u5982\u4e0a make_ \u65b9\u6cd5\uff0c\u4f1a\u6fc0\u6d3b\u5f53\u524d\u7684 observable \u5c5e\u6027\uff0c\u89e6\u53d1 observable \u914d\u7f6e\u9879\u4e0a\u7684 make_ \u65b9\u6cd5\uff0c\u7136\u540e\u5c31\u4f1a\u8fdb\u5165\u771f\u6b63\u7684\u6dfb\u52a0\u89c2\u5bdf\u8005\u5c5e\u6027\u73af\u8282 ",l.createElement("code",null,"defineObservableProperty_")," \u3002"),l.createElement("ul",null,l.createElement("li",null,"\u9996\u5148\u4f1a\u901a\u8fc7 ",l.createElement("strong",null,"Object.defineProperty")," \uff0c\u62e6\u622a\u5bf9\u8c61\u7684\u5c5e\u6027\uff0c\u6dfb\u52a0get\uff0cset \uff0c\u6bd4\u5982\u7ec4\u4ef6\u4e2d\u5f15\u7528\u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\uff0c\u8c03\u7528 get \u2014\u2014\u672c\u8d28\u4e0a\u8c03\u7528 ",l.createElement("code",null,"getObservablePropValue_")," \uff0c\u5728 observableValues \u8c03\u7528\u7684\u662f get \u65b9\u6cd5\uff1b\u5f53\u4fee\u6539\u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\uff0c\u8c03\u7528 set \u2014\u2014\u672c\u8d28\u4e0a\u8c03\u7528 ",l.createElement("code",null,"setObservablePropValue_")," \uff0csetObservablePropValue_ \u8c03\u7528\u7684\u662f ObservableValues \u4e0a\u7684 ",l.createElement("code",null,"setNewValue_")," \u65b9\u6cd5\u3002"),l.createElement("li",null,"\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5c5e\u6027\u4f1a\u589e\u52a0\u4e00\u4e2a\u89c2\u5bdf\u8005 ObservableValue \uff0c\u7136\u540e\u628a\u5f53\u524d ObservableValue \u653e\u5165\u7ba1\u7406\u8005 ObservableAdministration \u7684 values_ \u5c5e\u6027\u4e0a\u3002")),l.createElement("p",null,"\u5230\u6b64\u4e3a\u6b62\uff0c\u5f62\u6210\u4e86\u5982\u4e0b\u7684\u6a21\u578b\u56fe\u7ed3\u6784\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b46e88e4ac7c4a24a61c4e9bc56617e8~tplv-k3u1fbpfcp-watermark.awebp",alt:"3.jpg"})),l.createElement("h3",{id:"2-\u4f9d\u8d56\u6536\u96c6"},l.createElement(a.AnchorLink,{to:"#2-\u4f9d\u8d56\u6536\u96c6","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"2 \u4f9d\u8d56\u6536\u96c6"),l.createElement("p",null,"\u5982\u4e0a\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u63a5\u4e0b\u6765\u4e00\u8d77\u7814\u7a76\u4e00\u4e0b\u4f9d\u8d56\u6536\u96c6\u6d41\u7a0b\u3002\u901a\u8fc7\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u8fd8\u9057\u7559\u4e00\u70b9\u5c31\u662f ObservableValue \u505a\u4e86\u54ea\u4e9b\u4e8b\uff1f"),l.createElement("h4",{id:"\u89c2\u5bdf\u8005observablevalue"},l.createElement(a.AnchorLink,{to:"#\u89c2\u5bdf\u8005observablevalue","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2460\u89c2\u5bdf\u8005\u2014\u2014ObservableValue"),l.createElement("p",null,"\u4e0a\u9762\u6211\u77e5\u9053\u4e86\u53ea\u8981\u901a\u8fc7 @observable \u5305\u88f9\uff0c\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a ObservableValue \u3002"),l.createElement("p",null,"\u5728 Mobx \u6709\u4e00\u4e2a\u6838\u5fc3\u7684\u601d\u60f3\u5c31\u662f Atom \u4e3b\u8981\u662f\u6536\u96c6\u4f9d\u8d56\uff0c\u901a\u77e5\u4f9d\u8d56\u3002\u5148\u6765\u770b\u4e00\u4e0b Atom \u7684\u91cd\u70b9\u65b9\u6cd5:"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/atom.ts")),l.createElement(r.Z,{code:"class Atom{\n    observers_ = new Set() /* \u5b58\u653e\u6bcf\u4e2a\u7ec4\u4ef6\u7684 */\n    /* value\u6539\u53d8\uff0c\u901a\u77e5\u66f4\u65b0 */\n    reportChanged() {\n        startBatch()\n        propagateChanged(this)\n        endBatch()\n    }\n    /* \u6536\u96c6\u4f9d\u8d56 */\n    reportObserved() {\n        return reportObserved(this)\n    }\n}",lang:"js"}),l.createElement("p",null,"ObservableValue \u7ee7\u627f\u4e86 Atom\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/types/observablevalue.ts")),l.createElement(r.Z,{code:"class ObservableValue extends Atom{\n    get(){ //adm.getObservablePropValue_ \u88ab\u8c03\u7528\n        this.reportObserved() // \u8c03\u7528Atom\u4e2d reportObserved\n        return this.dehanceValue(this.value_)\n    }\n    setNewValue_(newValue) { // adm.setObservablePropValue_\n        const oldValue = this.value_\n        this.value_ = newValue\n        this.reportChanged()  // \u8c03\u7528Atom\u4e2dreportChanged\n    }\n}",lang:"js"}),l.createElement("p",null,"\u91cd\u70b9\u770b\u4e00\u4e0b\u5728\u89c2\u5bdf\u8005\u5c5e\u6027\u7ba1\u7406\u8005\u6700\u7ec8\u8c03\u7528\u7684\u4e24\u4e2a\u65b9\u6cd5\u2014\u2014 ",l.createElement("code",null,"get")," \u548c ",l.createElement("code",null,"setNewValue_")," \u3002"),l.createElement("h4",{id:"\u6ce8\u5165\u6a21\u5757provider\u548cinjectmobx-react"},l.createElement(a.AnchorLink,{to:"#\u6ce8\u5165\u6a21\u5757provider\u548cinjectmobx-react","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2461\u6ce8\u5165\u6a21\u5757\u2014\u2014Provider\u548cinject\uff08mobx-react\uff09"),l.createElement("p",null,"\u65e2\u7136\u89c2\u5bdf\u8005\u6a21\u5757\u5df2\u7ecf\u641e\u5b9a\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u770b\u4e00\u4e0b\uff0c",l.createElement("code",null,"mobx-react")," \u5982\u4f55\u5c06\u6a21\u5757\u6ce8\u5165\u5230\u5bf9\u5e94\u7684\u7ec4\u4ef6\u4e2d\u7684\u3002"),l.createElement("p",null,l.createElement("strong",null,"Provider")),l.createElement("blockquote",null,l.createElement("p",null,"mobx-react/src/Provider.tsx")),l.createElement(r.Z,{code:"const MobXProviderContext = React.createContext({})\nexport function Provider(props) {\n    /* ... */\n    return <MobXProviderContext.Provider value={value}>{children}</MobXProviderContext.Provider>\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"mobx-react \u4e2d\u7684 Provide r\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u4e0a\u4e0b\u6587 context \uff0c\u5e76\u901a\u8fc7 context.Provider \u4f20\u9012\u4e0a\u4e0b\u6587\u3002")),l.createElement("p",null,l.createElement("strong",null,"inject")),l.createElement("blockquote",null,l.createElement("p",null,"mobx-react/src/inject.ts")),l.createElement(r.Z,{code:"function inject(...storeNames){\n   const Injector = React.forwardRef(((props, ref)=>{\n        let newProps = { ...props }\n        const context = React.useContext(MobXProviderContext)\n        storeNames.forEach(function(storeName){ //storeNames - [ 'Root' ]\n            if(storeName in newProps) return \n            if(!(storeName in context)){\n                /* \u5c06mobx\u72b6\u6001\u4ececontext\u4e2d\u6df7\u5165\u5230props\u4e2d\u3002 */\n                newProps[storeName] = context[storeName]\n            }\n        })\n        return React.createElement(component, newProps)\n   }))\n   return Injector \n}",lang:"js"}),l.createElement("p",null,"\u4e3a\u4e86\u8ba9\u5927\u5bb6\u66f4\u6e05\u6670\u6d41\u7a0b\uff0cinject \u662f\u5408\u5e76\u52a0\u4e0a\u7b80\u5316\u540e\u7684\u3002"),l.createElement("ul",null,l.createElement("li",null,"inject \u4f5c\u7528\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u5c06 mobx \u7684\u72b6\u6001\uff0c\u4ece context \u4e2d\u6df7\u5165 props \u4e2d\u3002")),l.createElement("h4",{id:"\u53ef\u89c2\u5bdf\u7ec4\u4ef6-observer-mobx-react-"},l.createElement(a.AnchorLink,{to:"#\u53ef\u89c2\u5bdf\u7ec4\u4ef6-observer-mobx-react-","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2462\u53ef\u89c2\u5bdf\u7ec4\u4ef6\u2014\u2014 observer\uff08 mobx-react \uff09"),l.createElement("p",null,"\u88ab observe \u7684\u7ec4\u4ef6\uff0c\u88ab\u8d4b\u4e88\u4e00\u9879\u529f\u80fd\uff0c\u5c31\u662f\u53ef\u89c2\u5bdf\u7684\uff0c\u5f53\u91cc\u9762\u5f15\u7528\u4e86 mobx \u4e2d\u7684 ObservableValue \uff0c\u5f53 ObservableValue \u6539\u53d8\uff0c\u7ec4\u4ef6\u4f1a\u66f4\u65b0\u3002 \u63a5\u4e0b\u6765\u5c31\u662f\u6838\u5fc3\u4e86\uff0c\u9700\u8981\u770b\u4e00\u4e0b\u88ab observe \u5305\u88f9\u7684\u7ec4\u4ef6\u4f1a",l.createElement("strong",null,"\u6709\u54ea\u4e9b\u65b0\u7279\u5f81"),"\uff0c",l.createElement("strong",null,"\u4ee5\u53ca\u5982\u4f55\u6536\u96c6\u7684\u4f9d\u8d56"),"\uff0c",l.createElement("strong",null,"\u53c8\u662f\u5982\u4f55\u66f4\u65b0\u7684"),"\u3002\u88ab observe \u7684\u7ec4\u4ef6\u5206\u4e3a\u51fd\u6570\u7ec4\u4ef6\u548c\u7c7b\u7ec4\u4ef6\u4e24\u79cd\u60c5\u51b5\uff0c\u4e3a\u4e86\u8ba9\u5927\u5bb6\u660e\u767d\u6d41\u7a0b\uff0c\u6211\u8fd9\u91cc\u53ea\u8bb2\u4e86\u7c7b\u7ec4\u4ef6\u7684\u60c5\u51b5\u3002"),l.createElement("p",null,l.createElement("strong",null,"observer")),l.createElement("blockquote",null,l.createElement("p",null,"mobx-react/src/observer.tsx")),l.createElement(r.Z,{code:"function observer(componentClass){\n    /* componentClass \u662f\u7c7b\u7ec4\u4ef6\u7684\u60c5\u51b5 (\u51fd\u6570\u7ec4\u4ef6\u6211\u4eec\u6682\u4e14\u5ffd\u7565) */\n    return function makeClassComponentObserver(){\n        const target = componentClass.prototype\n        const baseRender = target.render /* \u8fd9\u4e2a\u662f\u539f\u6765\u7ec4\u4ef6\u7684render */\n        /* \u52ab\u6301render\u51fd\u6570 */\n        target.render = function () {\n            return makeComponentReactive.call(this, baseRender)\n        }\n    }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u5230\u8fd9\u91cc\u57fa\u672c\u53ef\u4ee5\u5f04\u6e05\u695a mobx-react \u4e2d observer HOC \u7684\u4f5c\u7528\u4e86\u2014\u2014",l.createElement("strong",null,"\u6e32\u67d3 render \u7684\u52ab\u6301"),"\u3002\u901a\u8fc7\u52ab\u6301 render \u51fd\u6570\u6267\u884c\uff0c\u6536\u96c6\u91cc\u9762\u7684\u4f9d\u8d56\u3002")),l.createElement("p",null,l.createElement("strong",null,"makeComponentReactive")),l.createElement("blockquote",null,l.createElement("p",null,"mobx-react/src/observerClass.ts")),l.createElement(r.Z,{code:'function makeComponentReactive(){\n    const baseRender = render.bind(this) // baseRender\u4e3a\u771f\u6b63\u7684render\u65b9\u6cd5\n     /* \u521b\u5efa\u4e00\u4e2a\u53cd\u5e94\u5668\uff0c\u7ed1\u5b9a\u7c7b\u7ec4\u4ef6\u7684\u66f4\u65b0\u51fd\u6570 \u2014\u2014 forceUpdate  */\n     const reaction = new Reaction(`${initialName}.render()`,()=>{\n          Component.prototype.forceUpdate.call(this) /* forceUpdate \u4e3a\u7c7b\u7ec4\u4ef6\u66f4\u65b0\u51fd\u6570 */\n     })\n    reaction["reactComponent"] = this    /* Reaction \u548c \u7ec4\u4ef6\u5b9e\u4f8b\u5efa\u7acb\u8d77\u5173\u8054 */\n    reactiveRender["$mobx"] = reaction\n    this.render = reactiveRender \n    function reactiveRender() { /* \u6539\u9020\u7684\u54cd\u5e94\u5f0frender\u65b9\u6cd5 */\n        reaction.track(() => {  // track\u4e2d\u8fdb\u884c\u771f\u6b63\u7684\u4f9d\u8d56\u6536\u96c6\n            try {\n                rendering = baseRender() /* \u6267\u884c\u66f4\u65b0\u51fd\u6570 */\n            } \n        })\n        return rendering\n    }\n    return reactiveRender.call(this)\n}',lang:"js"}),l.createElement("p",null,l.createElement("code",null,"makeComponentReactive")," \u901a\u8fc7\u6539\u9020 render \u51fd\u6570\uff0c\u6765\u5b9e\u73b0\u4f9d\u8d56\u7684\u6536\u96c6\uff0c\u91cc\u9762\u5305\u542b\u4e86\u5f88\u591a\u6838\u5fc3\u6d41\u7a0b\u3002"),l.createElement("ul",null,l.createElement("li",null,"\u6bcf\u4e00\u4e2a\u7ec4\u4ef6\u4f1a\u521b\u5efa\u4e00\u4e2a Reaction\uff0cReaction \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5185\u90e8\u5c01\u88c5\u4e86\u66f4\u65b0\u7ec4\u4ef6\u7684\u65b9\u6cd5\u3002\u90a3\u4e48\u5982\u679c\u89e6\u53d1\u53ef\u89c2\u5bdf\u5c5e\u6027\u7684 set \uff0c\u90a3\u4e48\u6700\u540e\u89e6\u53d1\u66f4\u65b0\u7684\u5c31\u662f\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5bf9\u4e8e\u7c7b\u7ec4\u4ef6\u672c\u8d28\u4e0a\u5c31\u662f\u7684 ",l.createElement("code",null,"forceUpdate")," \u65b9\u6cd5\u3002"),l.createElement("li",null,"\u5bf9 render \u51fd\u6570\u8fdb\u884c\u6539\u9020\uff0c\u6539\u9020\u6210 reactiveRender \uff0c\u5728 reactiveRender \u4e2d\uff0creaction.track \u662f\u771f\u6b63\u7684\u8fdb\u884c\u4f9d\u8d56\u7684\u6536\u96c6\uff0ctrack \u56de\u8c03\u51fd\u6570\u4e2d\uff0c\u6267\u884c\u771f\u6b63\u7684 render \u65b9\u6cd5\uff0c\u5f97\u5230 element \u5bf9\u8c61 rendering \u3002")),l.createElement("h4",{id:"\u53cd\u5e94\u5668reaction"},l.createElement(a.AnchorLink,{to:"#\u53cd\u5e94\u5668reaction","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u2463\u53cd\u5e94\u5668\u2014\u2014Reaction"),l.createElement("p",null,"\u90a3\u4e48\u63a5\u4e0b\u6765\u91cd\u70b9\u770b\u4e00\u4e0b Reaction \u5982\u4f55\u5904\u7406\u66f4\u65b0\u51fd\u6570\uff0c\u8fd8\u6709\u5c31\u662f track \u65b9\u6cd5\u662f\u5982\u4f55\u6536\u96c6\u4f9d\u8d56\u7684\u3002\u5728\u5982\u4e0b track \u4e2d\uff0c\u6211\u6807\u8bb0\u4e86\u4e09\u4e2a\u9636\u6bb5\uff0c\u9605\u8bfb\u7684\u540c\u5b66\u8bf7\u7ec6\u5fc3\u770b\u8fd9\u4e2a\u4e09\u9636\u6bb5\u90fd\u505a\u4e86\u4e9b\u4ec0\u4e48\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/reaction.ts")),l.createElement(r.Z,{code:"class Reaction{\n    constructor(name_,onInvalidate_){\n       this.name_ = name_\n       this.onInvalidate_ = onInvalidate_ /* onInvalidate_ \u91cc\u9762\u6709\u7ec4\u4ef6\u7684forceUpdate\u51fd\u6570\uff0c\u7528\u4e8e\u66f4\u65b0\u7ec4\u4ef6 */\n    }\n    onBecomeStale_(){\n        this.schedule_() /* \u89e6\u53d1\u8c03\u5ea6\u66f4\u65b0 */\n    }\n    /* \u5f00\u542f\u8c03\u5ea6\u66f4\u65b0 */\n    schedule_(){\n       if (!this.isScheduled_) {\n            this.isScheduled_ = true\n            globalState.pendingReactions.push(this)\n            runReactions()\n        }\n    }\n    /* \u66f4\u65b0 */\n    runReaction_(){\n        startBatch()\n        this.isScheduled_ = false\n        const prev = globalState.trackingContext\n        globalState.trackingContext = this\n        this.onInvalidate_() /* \u66f4\u65b0\u7ec4\u4ef6  */\n        globalState.trackingContext = prev\n        endBatch()\n    }\n    /* \u6536\u96c6\u4f9d\u8d56 */\n    track(fn){\n        startBatch()\n        /* \u7b2c\u4e00\u9636\u6bb5 */\n        const prevTracking = globalState.trackingDerivation\n        globalState.trackingDerivation = this\n        /* \u7b2c\u4e8c\u9636\u6bb5 */\n        const result = fn.call(context)\n        globalState.trackingDerivation = prevTracking\n        /* \u7b2c\u4e09\u9636\u6bb5 */\n        bindDependencies(this) \n    }\n }",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u8fd9\u4e2a\u51fd\u6570\u7279\u522b\u91cd\u8981\uff0c\u662f\u6574\u4e2a\u6536\u96c6\u4f9d\u8d56\u6838\u5fc3\u3002")),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e00\u9636\u6bb5\uff1a \u9996\u5148\u5728\u6267\u884c track \u7684\u65f6\u5019\uff0c\u4f1a\u628a\u5168\u5c40\u53d8\u91cf\u7684 ",l.createElement("code",null,"trackingDerivation"),"\uff0c\u6307\u5411\u5f53\u524d\u7684 trackingDerivation \u3002\u8fd9\u6837\u5728\u6536\u96c6\u4f9d\u8d56\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u6536\u96c6\u5f53\u524d\u7684 trackingDerivation \uff0c\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48 ObservableValue \u80fd\u7cbe\u786e\u6536\u96c6\u6bcf\u4e00\u4e2a Reaction \u3002"),l.createElement("li",null,"\u7b2c\u4e8c\u9636\u6bb5\uff1a\u9996\u5148\u5f53\u88ab observer \u5305\u88c5\u7684\u7ec4\u4ef6\uff0c\u53ea\u8981\u6267\u884c render \u51fd\u6570\uff0c\u5c31\u4f1a\u6267\u884c track \u65b9\u6cd5\uff0c",l.createElement("code",null,"fn.call(context)"),"\uff0c\u771f\u6b63\u7684r ender \u51fd\u6570\u4f1a\u5728\u91cc\u9762\u6267\u884c\uff0c\u5982\u679c\u5728 render \u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f15\u7528\u4e86 mobx \u53ef\u89c2\u5bdf\u6a21\u5757\uff0c\u6bd4\u5982\uff1a")),l.createElement(r.Z,{code:"@inject('Root')\nclass Index extends React.Component{\n    render(){\n        return <div> \n           <p>{ this.props.Root.name }</p> \n           <button onClick={() => this.props.Root.setName('\u300aReact\u8fdb\u9636\u5b9e\u8df5\u6307\u5357\u300b666')} >\u6539\u53d8Mobx\u4e2dname</button>\n        </div>\n    }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e8c\u9636\u6bb5\uff1a\u5f53\u5982\u4e0a render \u6267\u884c\u7684\u65f6\u5019\uff0c\u9996\u5148\u4f1a\u89e6\u53d1 track \uff0c\u5c06\u5f53\u524dReaction \u8d4b\u503c\u7ed9 trackingDerivation \uff0c\u7136\u540e\u8bbf\u95ee\u4e86 Root \u4e0b\u9762\u7684name \u5c5e\u6027\uff0c\u90a3\u4e48\u9996\u5148\u4f1a\u89e6\u53d1\u89c2\u5bdf\u72b6\u6001\u7ba1\u7406\u8005\u7684 adm \u7684 getObservablePropValue_ \uff0c\u63a5\u4e0b\u6765\u4f1a\u89e6\u53d1 name \u5c5e\u6027\u7684\u89c2\u5bdf\u8005 ObservableValue \u4e0b\u9762\u7684 get \u65b9\u6cd5\uff0c\u6700\u540e\u6267\u884c\u7684\u662f ",l.createElement("code",null,"reportObserved(this)"),"\uff0c\u770b\u4e00\u4e0b reportObserved \u91cc\u9762\u505a\u4e86\u5199\u4ec0\u4e48\uff1f")),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/observable.ts")),l.createElement(r.Z,{code:"function reportObserved(observable){\n    /* \u6b64\u65f6\u83b7\u53d6\u5230\u5f53\u524d\u51fd\u6570\u5bf9\u5e94\u7684 Reaction\u3002 */\n    const derivation = globalState.trackingDerivation \n    /* \u5c06\u5f53\u524d\u7684 observable \u5b58\u653e\u5230 Reaction \u7684 newObserving_ \u4e2d\u3002 */\n    derivation.newObserving_![derivation.unboundDepsCount_++] = observable \n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e8c\u9636\u6bb5\uff1areportObserved \u505a\u7684\u4e8b\u60c5\u975e\u5e38\u76f4\u63a5\uff0c\u5c31\u662f\u5c06\u5f53\u524d\u7684 observable \u653e\u5165 Reaction \u7684 newObserving_ \u4e2d\uff0c\u8fd9\u6837\u5c31\u628a\u89c2\u5bdf\u8005\u5c5e\u6027\uff08\u5982\u4e0a\u4f8b\u5b50\u4e2d\u7684name\uff09\u548c\u7ec4\u4ef6\u5bf9\u5e94\u7684 Reaction \u5efa\u7acb\u8d77\u5173\u8054\u3002")),l.createElement("p",null,"\u5f53\u7ec4\u4ef6\u4e2d render \u51fd\u6570\u6267\u884c\u5b8c\u6bd5\uff0c\u4e5f\u5c31\u662f jsx \u4e2d\u7684\u4f9d\u8d56\u5168\u90e8\u6536\u96c6\u5b8c\u6210\uff0c\u5c31\u4f1a\u5230\u7b2c\u4e09\u9636\u6bb5\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u53d1\u73b0\uff0c\u4e0a\u8ff0\u53ea\u662f ObservableValue \u5230 Reaction \u6536\u96c6\uff0c\u4f46\u662f\u6ca1\u6709 Reaction \u5230 ObservableValue \uff0c\u4e5f\u5c31\u662f\u8bf4 ObservableValue \u91cc\u9762\u8fd8\u6ca1\u6709\u7ec4\u4ef6\u7684 Reaction\uff0c\u522b\u7740\u6025\uff0c\u8fd9\u4e2a\u90fd\u662f\u7b2c\u4e09\u9636\u6bb5\u7684 ",l.createElement("code",null,"bindDependencies")," \u505a\u7684\u4e8b\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/derivation.ts")),l.createElement(r.Z,{code:"function bindDependencies(Reaction){ /* \u5f53\u524d\u7ec4\u4ef6\u7684 Reaction */\n    const prevObserving = derivation.observing_ /* \u4e4b\u524d\u7684observing_ */\n    const observing = (derivation.observing_ = derivation.newObserving_!) /* \u65b0\u7684observing_  */\n    let l = prevObserving.length\n    while (l--) { /* observableValue \u5220\u9664\u4e4b\u524d\u7684 Reaction  */\n        const observableValue = prevObserving[l]\n        observable.observers_.delete(Reaction)\n    }\n    let i0 = observing.length \n    while (i0--) { /* \u7ed9renderhanobservableValue\u91cd\u65b0\u6dfb\u52a0 Reaction  */\n        const observableValue = observing[i0]\n         observable.observers_.add(Reaction)\n    }\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e09\u9636\u6bb5\uff1a bindDependencies \u4e3b\u8981\u505a\u7684\u4e8b\u60c5\u5982\u4e0b\uff1a")),l.createElement("p",null,"\u2460 \u5bf9\u4e8e\u6709",l.createElement("strong",null,"\u5f53\u524d Reaction"),"\u7684 observableValue\uff0cobservableValue\u4f1a\u7edf\u4e00\u5220\u9664\u6389\u91cc\u9762\u7684 Reaction\u3002 \u2461 \u4f1a\u7ed9\u8fd9\u4e00\u6b21 render \u4e2d\u7528\u5230\u7684\u65b0\u7684\u4f9d\u8d56 observableValue \uff0c\u7edf\u4e00\u6dfb\u52a0\u5f53\u524d\u7684 Reaction \u3002 \u2462 \u8fd8\u4f1a\u6709\u4e00\u4e9b\u7ec6\u8282\uff0c\u6bd4\u5982\u8bf4\u5728 render \u4e2d\uff0c\u5f15\u5165\u4e24\u6b21\u76f8\u540c\u7684\u503c\uff08\u5982\u4e0a\u7684 demo \u4e2d\u7684 name \uff09\uff0c\u4f1a\u7edf\u4e00\u6536\u96c6\u4e00\u6b21\u4f9d\u8d56\u3002"),l.createElement("p",null,"\u4f9d\u8d56\u6536\u96c6\u6d41\u7a0b\u56fe\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5712e9017d4946fbac0876ddf2542e6c~tplv-k3u1fbpfcp-watermark.awebp",alt:"4.jpeg"})),l.createElement("h3",{id:"3-\u6d3e\u53d1\u66f4\u65b0"},l.createElement(a.AnchorLink,{to:"#3-\u6d3e\u53d1\u66f4\u65b0","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"3 \u6d3e\u53d1\u66f4\u65b0"),l.createElement("p",null,"\u63a5\u4e0b\u6765\u5c31\u662f\u4e00\u6b21\u66f4\u65b0\u4e2d\uff0c\u6bd4\u5982\u5728\uff08 DEMO1 \uff09\u4e2d\u70b9\u51fb\u6309\u94ae\uff0c\u901a\u8fc7 action \uff0c\u6539\u53d8 mobx \u4e2d\u7684 name \u5c5e\u6027\u3002\u90a3\u4e48\u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\u3002"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"\u7b2c\u4e00\u6b65\uff1a")," \u9996\u5148\u5bf9\u4e8e\u89c2\u5bdf\u8005\u5c5e\u6027\u7ba1\u7406\u8005 ObservableAdministration \u4f1a\u89e6\u53d1 setObservablePropValue_ \uff0c\u7136\u540e\u627e\u5230\u5bf9\u5e94\u7684 ObservableValue \u89e6\u53d1 setNewValue_ \u65b9\u6cd5\u3002"),l.createElement("li",null,l.createElement("strong",null,"\u7b2c\u4e8c\u6b65\uff1a")," setNewValue_ \u672c\u8d28\u4e0a\u4f1a\u89e6\u53d1Atom\u4e2d\u7684reportChanged \uff0c\u7136\u540e\u8c03\u7528 ",l.createElement("code",null,"propagateChanged"),"\u3002\u9996\u5148\u6765\u770b\u4e00\u4e0bpropagateChanged\uff1a")),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/observable.ts")),l.createElement(r.Z,{code:"function propagateChanged(observable){\n    observable.observers_.forEach((Reaction)=>{\n        Reaction.onBecomeStale_()\n    })\n}",lang:"js"}),l.createElement("p",null,"\u8c03\u7528 ",l.createElement("code",null,"propagateChanged")," \u89e6\u53d1\uff0c\u4f9d\u8d56\u4e8e\u5f53\u524d\u7ec4\u4ef6\u7684\u6240\u6709 Reaction \u4f1a\u89e6\u53d1 onBecomeStale_ \u65b9\u6cd5\u3002"),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"\u7b2c\u4e09\u6b65\uff1a")," Reaction \u7684 onBecomeStale_ \u89e6\u53d1\uff0c\u4f1a\u8ba9Reaction \u7684 schedule_ \u6267\u884c\uff0c\u6ce8\u610f\u4e00\u4e0b\u8fd9\u91cc schedule_ \u4f1a\u5f00\u542f\u66f4\u65b0\u8c03\u5ea6\u3002\u4ec0\u4e48\u53eb\u66f4\u65b0\u8c03\u5ea6\u5462\u3002\u5c31\u662f schedule_ \u5e76\u4e0d\u4f1a\u9a6c\u4e0a\u6267\u884c\u7ec4\u4ef6\u66f4\u65b0\uff0c\u800c\u662f\u628a\u5f53\u524d\u7684 Reaction \u653e\u5165 globalState.pendingReactions\uff08\u5f85\u66f4\u65b0 Reaction \u961f\u5217\uff09\u4e2d\uff0c\u7136\u540e\u4f1a\u6267\u884c runReactions \u5916\u90e8\u65b9\u6cd5\u3002")),l.createElement("blockquote",null,l.createElement("p",null,"mobx/src/core/reaction.ts")),l.createElement(r.Z,{code:"function runReactions(){\n    if (globalState.inBatch > 0 || globalState.isRunningReactions) return\n    globalState.isRunningReactions = true\n    const allReactions = globalState.pendingReactions\n    /* \u8fd9\u91cc\u7684\u4ee3\u7801\u662f\u7ecf\u8fc7\u4fee\u6539\u8fc7\u540e\u7684\uff0c\u6e90\u7801\u4e2d\u8981\u6bd4 */\n    allReactions.forEach(Reaction=>{\n         /* \u6267\u884c\u6bcf\u4e00\u4e2a\u7ec4\u4ef6\u7684\u66f4\u65b0\u51fd\u6570 */\n         Reaction.runReaction_()\n    })\n    globalState.pendingReactions = []\n    globalState.isRunningReactions = false\n}",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,l.createElement("strong",null,"\u7b2c\u56db\u6b65\uff1a")," \u6267\u884c\u6bcf\u4e00\u4e2a Reaction \uff0c\u5f53\u4e00\u4e2a ObservableValue \u7684\u5c5e\u6027\u503c\u6539\u53d8\uff0c\u53ef\u4ee5\u6536\u96c6\u4e86\u591a\u4e2a\u7ec4\u4ef6\u7684\u4f9d\u8d56\uff0c\u6240\u4ee5 mobx \u7528\u8fd9\u4e2a\u8c03\u5ea6\u673a\u5236\uff0c\u5148\u628a\u6bcf\u4e00\u4e2a Reaction \u653e\u5165 pendingReactions \u4e2d\uff0c\u7136\u540e\u96c6\u4e2d\u5904\u7406\u8fd9\u4e9b Reaction \uff0c Reaction \u4f1a\u89e6\u53d1 ",l.createElement("code",null,"runReaction_()")," \u65b9\u6cd5\uff0c\u4f1a\u89e6\u53d1 onInvalidate_ \u2014\u2014\u7c7b\u7ec4\u4ef6\u7684 forceupdate \u65b9\u6cd5\u5b8c\u6210\u7ec4\u4ef6\u66f4\u65b0\u3002")),l.createElement("p",null,"\u501f\u6b64\u5b8c\u6210\u6574\u4e2a\u6d41\u7a0b\u3002"),l.createElement("p",null,"\u72b6\u6001\u6d3e\u53d1\u6d41\u7a0b\u56fe\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/606265172f9649e59b16c783923f4dd4~tplv-k3u1fbpfcp-watermark.awebp",alt:"5.jpeg"})),l.createElement("h2",{id:"\u4e94-mobx\u4e0eredux\u533a\u522b"},l.createElement(a.AnchorLink,{to:"#\u4e94-mobx\u4e0eredux\u533a\u522b","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e94 Mobx\u4e0eRedux\u533a\u522b"),l.createElement("ul",null,l.createElement("li",null,"\u9996\u5148\u5728 Mobx \u5728\u4e0a\u624b\u7a0b\u5ea6\u4e0a\uff0c\u8981\u4f18\u4e8e Redux \uff0c\u6bd4\u5982 Redux \u60f3\u4f7f\u7528\u5f02\u6b65\uff0c\u9700\u8981\u914d\u5408\u4e2d\u95f4\u4ef7\uff0c\u6d41\u7a0b\u6bd4\u8f83\u590d\u6742\u3002"),l.createElement("li",null,"Redux \u5bf9\u4e8e\u6570\u636e\u6d41\u5411\u66f4\u89c4\u8303\u5316\uff0cMobx \u4e2d\u6570\u636e\u66f4\u52a0\u591a\u6837\u5316\uff0c\u5141\u8bb8\u6570\u636e\u5197\u4f59\u3002"),l.createElement("li",null,"Redux \u6574\u4f53\u6570\u636e\u6d41\u5411\u7b80\u5355\uff0cMobx \u4f9d\u8d56\u4e8e Proxy\uff0c Object.defineProperty \u7b49\uff0c\u52ab\u6301\u5c5e\u6027 get \uff0cset \uff0c\u6570\u636e\u53d8\u5316\u591a\u6837\u6027\u3002"),l.createElement("li",null,"Redux \u53ef\u62d3\u5c55\u6027\u6bd4\u8f83\u5f3a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e2d\u95f4\u4ef6\u81ea\u5b9a\u4e49\u589e\u5f3a dispatch \u3002"),l.createElement("li",null,"\u5728 Redux \u4e2d\uff0c\u57fa\u672c\u6709\u4e00\u4e2a store \uff0c\u7edf\u4e00\u7ba1\u7406 store \u4e0b\u7684\u72b6\u6001\uff0c\u5728 mobx \u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a\u6a21\u5757\uff0c\u53ef\u4ee5\u7406\u89e3\u6bcf\u4e00\u4e2a\u6a21\u5757\u90fd\u662f\u4e00\u4e2a store \uff0c\u76f8\u4e92\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\u3002")),l.createElement("h2",{id:"\u516d-\u603b\u7ed3"},l.createElement(a.AnchorLink,{to:"#\u516d-\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u516d \u603b\u7ed3"),l.createElement("p",null,"\u5e0c\u671b\u901a\u8fc7\u672c\u7ae0\u8282\u7684\u5b66\u4e60\uff0c\u53ef\u4ee5\u5b66\u5230\u4e00\u4e0b\u5185\u5bb9\uff1a"),l.createElement("ul",null,l.createElement("li",null,"mobx \u57fa\u672c\u4f7f\u7528\uff0c\u5b9e\u8df5\u72b6\u6001\u7ba1\u7406\u548c\u7ec4\u4ef6\u901a\u4fe1\u4e24\u79cd\u573a\u666f\u3002"),l.createElement("li",null,"mobx \u548c mobx-react \u539f\u7406\u3002"),l.createElement("li",null,"mobx \u548c redux \u7684\u533a\u522b\u3002"))))}));n["default"]=e=>{var n=l.useContext(a.context),t=n.demos;return l.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&a.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.createElement(o,{demos:t})}}}]);