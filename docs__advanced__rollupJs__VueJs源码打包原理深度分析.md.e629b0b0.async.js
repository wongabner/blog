(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[8675],{13092:function(e,n,l){"use strict";l.r(n);var t=l(67294),r=l(96089),s=l(65659),i=t.memo((e=>{e.demos;return t.createElement(t.Fragment,null,t.createElement("div",{className:"markdown"},t.createElement("blockquote",null,t.createElement("p",null,"\u8bf4\u660e\uff1a\u57fa\u4e8eVue.js 2.5.17-beta.0\u7248\u672c\u6e90\u7801")),t.createElement("h3",{id:"\u524d\u7f6e\u5b66\u4e60\u57fa\u7840\u77e5\u8bc6"},t.createElement(r.AnchorLink,{to:"#\u524d\u7f6e\u5b66\u4e60\u57fa\u7840\u77e5\u8bc6","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"\u524d\u7f6e\u5b66\u4e60\u2014\u2014\u57fa\u7840\u77e5\u8bc6"),t.createElement("p",null,"\u8981\u770b\u61c2Vue.js\u7684\u6253\u5305\u6e90\u7801\uff0c\u9700\u8981\u638c\u63e1\u4ee5\u4e0b\u77e5\u8bc6\u70b9\uff1a"),t.createElement("ul",null,t.createElement("li",null,"fs\u6a21\u5757\uff1aNode.js\u5185\u7f6e\u6a21\u5757\uff0c\u7528\u4e8e\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u5904\u7406\uff1b"),t.createElement("li",null,"path\u6a21\u5757\uff1aNode.js\u5185\u7f6e\u6a21\u5757\uff0c\u7528\u4e8e\u672c\u5730\u8def\u5f84\u89e3\u6790\uff1b"),t.createElement("li",null,"buble\u6a21\u5757\uff1a\u7528\u4e8eES6+\u8bed\u6cd5\u7f16\u8bd1\uff1b"),t.createElement("li",null,"flow\u6a21\u5757\uff1a\u7528\u4e8eJavascript\u6e90\u7801\u9759\u6001\u68c0\u67e5\uff1b"),t.createElement("li",null,"zlib\u6a21\u5757\uff1aNode.js\u5185\u7f6e\u6a21\u5757\uff0c\u7528\u4e8e\u4f7f\u7528gzip\u7b97\u6cd5\u8fdb\u884c\u6587\u4ef6\u538b\u7f29\uff1b"),t.createElement("li",null,"terser\u6a21\u5757\uff1a\u7528\u4e8eJavascript\u4ee3\u7801\u538b\u7f29\u548c\u7f8e\u5316\u3002")),t.createElement("h3",{id:"\u524d\u7f6e\u5b66\u4e60rollupjs\u63d2\u4ef6"},t.createElement(r.AnchorLink,{to:"#\u524d\u7f6e\u5b66\u4e60rollupjs\u63d2\u4ef6","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"\u524d\u7f6e\u5b66\u4e60\u2014\u2014rollup.js\u63d2\u4ef6"),t.createElement("p",null,"rollup.js\u8fdb\u9636\u6559\u7a0b\u4e2d\u8bb2\u89e3\u4e86rollup.js\u7684\u90e8\u5206\u5e38\u7528\u63d2\u4ef6\uff1a"),t.createElement("ul",null,t.createElement("li",null,"rollup-plugin-resolve\uff1a\u96c6\u6210\u5916\u90e8\u6a21\u5757\u4ee3\u7801\uff1b"),t.createElement("li",null,"rollup-plugin-commonjs\uff1a\u652f\u6301CommonJS\u6a21\u5757\uff1b"),t.createElement("li",null,"rollup-plugin-babel\uff1a\u7f16\u8bd1ES6+\u8bed\u6cd5\u4e3aES2015\uff1b"),t.createElement("li",null,"rollup-plugin-json\uff1a\u652f\u6301json\u6a21\u5757\uff1b"),t.createElement("li",null,"rollup-plugin-uglify\uff1a\u4ee3\u7801\u538b\u7f29\uff08\u4e0d\u652f\u6301ES\u6a21\u5757\uff09\uff1b")),t.createElement("p",null,"\u4e3a\u4e86\u7406\u89e3Vue.js\u7684\u6253\u5305\u6e90\u7801\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5b66\u4e60\u4ee5\u4e0brollup.js\u63d2\u4ef6\u53ca\u77e5\u8bc6\uff1a"),t.createElement("ul",null,t.createElement("li",null,"rollup-plugin-buble\u63d2\u4ef6\uff1a\u7f16\u8bd1ES6+\u8bed\u6cd5\u4e3aES2015\uff0c\u65e0\u9700\u914d\u7f6e\uff0c\u6bd4babel\u66f4\u8f7b\u91cf\uff1b"),t.createElement("li",null,"rollup-plugin-alias\u63d2\u4ef6\uff1a\u66ff\u6362\u6a21\u5757\u8def\u5f84\u4e2d\u7684\u522b\u540d\uff1b"),t.createElement("li",null,"rollup-plugin-flow-no-whitespace\u63d2\u4ef6\uff1a\u53bb\u9664flow\u9759\u6001\u7c7b\u578b\u68c0\u67e5\u4ee3\u7801\uff1b"),t.createElement("li",null,"rollup-plugin-replace\u63d2\u4ef6\uff1a\u66ff\u6362\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf\u4e3a\u6307\u5b9a\u503c\uff1b"),t.createElement("li",null,"rollup-plugin-terser\u63d2\u4ef6\uff1a\u4ee3\u7801\u538b\u7f29\uff0c\u53d6\u4ee3uglify\uff0c\u652f\u6301ES\u6a21\u5757\u3002"),t.createElement("li",null,"intro\u548coutro\u914d\u7f6e\uff1a\u5728\u4ee3\u7801\u5757\u5185\u6dfb\u52a0\u4ee3\u7801\u6ce8\u91ca\u3002")),t.createElement("h3",{id:"vuejs\u6e90\u7801\u6253\u5305"},t.createElement(r.AnchorLink,{to:"#vuejs\u6e90\u7801\u6253\u5305","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"Vue.js\u6e90\u7801\u6253\u5305"),t.createElement("p",null,"Vue.js\u7684\u6253\u5305\u8fc7\u7a0b\u5e76\u4e0d\u590d\u6742\uff0c\u9996\u5148\u8981\u5c06Vue.js\u6e90\u7801clone\u5230\u672c\u5730\uff1a"),t.createElement(s.Z,{code:"git clone https://github.com/vuejs/vue.git",lang:"js"}),t.createElement("p",null,"\u5b89\u88c5\u4f9d\u8d56\uff1a"),t.createElement(s.Z,{code:"cd vue\nnpm i",lang:"js"}),t.createElement("p",null,"\u6253\u5f00package.json\u67e5\u770bscripts\uff1a"),t.createElement(s.Z,{code:'"scripts": {\n  "build": "node scripts/build.js",\n  "build:ssr": "npm run build -- web-runtime-cjs,web-server-renderer",\n  "build:weex": "npm run build -- weex",\n}',lang:"js"}),t.createElement("p",null,"\u6211\u4eec\u5148\u901a\u8fc7build\u6307\u4ee4\u8fdb\u884c\u6253\u5305\uff1a"),t.createElement(s.Z,{code:"$ npm run build\n\n> vue@2.5.17-beta.0 build /Users/sam/WebstormProjects/vue\n> node scripts/build.js\n\ndist/vue.runtime.common.js 209.20kb\ndist/vue.common.js 288.22kb\ndist/vue.runtime.esm.js 209.18kb\ndist/vue.esm.js 288.20kb\ndist/vue.runtime.js 219.55kb\ndist/vue.runtime.min.js 60.24kb (gzipped: 21.62kb)\ndist/vue.js 302.27kb\ndist/vue.min.js 85.19kb (gzipped: 30.86kb)\npackages/vue-template-compiler/build.js 121.88kb\npackages/vue-template-compiler/browser.js 228.17kb\npackages/vue-server-renderer/build.js 220.73kb\npackages/vue-server-renderer/basic.js 304.00kb\npackages/vue-server-renderer/server-plugin.js 2.92kb\npackages/vue-server-renderer/client-plugin.js 3.03kb",lang:"js"}),t.createElement("p",null,"\u6253\u5305\u6210\u529f\u540e\u4f1a\u5728dist\u76ee\u5f55\u4e0b\u521b\u5efa\u4e0b\u5217\u6253\u5305\u6587\u4ef6\uff1a"),t.createElement("p",null,t.createElement("img",{src:"https://gitee.com/wongabner/picgo/raw/master/2021-03-23-19-14-21.png",alt:"\u56fe 13"})),t.createElement("p",null,'\u4ee5\u4e0a\u5c31\u662f\u4f7f\u7528build\u6307\u4ee4\u5bf9Vue.js\u6e90\u7801\u8fdb\u884c\u6253\u5305\u7684\u8fc7\u7a0b\uff0c\u9664\u6b64\u4e4b\u5916\uff0cVue.js\u8fd8\u63d0\u4f9b\u4e86\u53e6\u5916\u4e24\u79cd\u6253\u5305\u65b9\u5f0f\uff1a\u201cbuild:ssr"\u548c"build:weex\u201d\uff0c\u5148\u5c1d\u8bd5"build:ssr"\u6307\u4ee4\uff1a'),t.createElement(s.Z,{code:'$ npm run build:ssr\n\n> vue@2.5.17-beta.0 build:ssr /Users/sam/WebstormProjects/vue\n> npm run build -- web-runtime-cjs,web-server-renderer\n\n\n> vue@2.5.17-beta.0 build /Users/sam/WebstormProjects/vue\n> node scripts/build.js "web-runtime-cjs,web-server-renderer"\n\ndist/vue.runtime.common.js 209.20kb\npackages/vue-server-renderer/build.js 220.73kb\npackages/vue-server-renderer/basic.js 304.00kb\npackages/vue-server-renderer/server-plugin.js 2.92kb\npackages/vue-server-renderer/client-plugin.js 3.03kb',lang:"js"}),t.createElement("p",null,'\u518d\u5c1d\u8bd5"build:weex"\uff1a'),t.createElement(s.Z,{code:'$ npm run build:weex\n\n> vue@2.5.17-beta.0 build:weex /Users/sam/WebstormProjects/vue\n> npm run build -- weex\n\n\n> vue@2.5.17-beta.0 build /Users/sam/WebstormProjects/vue\n> node scripts/build.js "weex"\n\npackages/weex-vue-framework/factory.js 193.79kb\npackages/weex-vue-framework/index.js 5.68kb\npackages/weex-template-compiler/build.js 109.11kb',lang:"js"}),t.createElement("p",null,"\u901a\u8fc7\u547d\u4ee4\u884c\u65e5\u5fd7\u53ef\u4ee5\u770b\u51fa\u8fd9\u4e24\u4e2a\u6307\u4ee4\u548cbuild\u6307\u4ee4\u6ca1\u6709\u672c\u8d28\u533a\u522b\uff0c\u90fd\u662f\u901a\u8fc7node\u6267\u884cscripts/build.js\u6e90\u7801\uff0c\u53ea\u662f\u9644\u5e26\u7684\u53c2\u6570\u4e0d\u540c\uff1a"),t.createElement(s.Z,{code:'node scripts/build.js # build\nnode scripts/build.js "web-runtime-cjs,web-server-renderer" # build:ssr\nnode scripts/build.js "weex" # build:weex',lang:"js"}),t.createElement("p",null,"\u53ef\u89c1scripts/build.js\u662f\u89e3\u8bfbVue.js\u6e90\u7801\u6253\u5305\u7684\u5173\u952e\u3002\u4e0b\u9762\u6211\u4eec\u5c31\u6765\u5206\u6790Vue.js\u7684\u6e90\u7801\u6253\u5305\u6d41\u7a0b\u3002"),t.createElement("h3",{id:"vuejs\u6253\u5305\u6d41\u7a0b\u5206\u6790"},t.createElement(r.AnchorLink,{to:"#vuejs\u6253\u5305\u6d41\u7a0b\u5206\u6790","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"Vue.js\u6253\u5305\u6d41\u7a0b\u5206\u6790"),t.createElement("p",null,"Vue.js\u6e90\u7801\u6253\u5305\u57fa\u4e8erollup.js\u7684API\uff0c\u6d41\u7a0b\u5927\u81f4\u53ef\u5206\u4e3a\u4e94\u6b65\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),t.createElement("p",null,t.createElement("img",{src:"https://gitee.com/wongabner/picgo/raw/master/2021-03-23-19-14-59.png",alt:"\u56fe 14"})),t.createElement("ul",null,t.createElement("li",null,"\u7b2c\u4e00\u6b65\uff1a\u521b\u5efadist\u76ee\u5f55\u3002\u68c0\u67e5\u662f\u5426\u5b58\u5728dist\u76ee\u5f55\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u8fdb\u884c\u521b\u5efa\uff1b"),t.createElement("li",null,"\u7b2c\u4e8c\u6b65\uff1a\u751f\u6210rollup\u914d\u7f6e\u6587\u4ef6\u3002\u901a\u8fc7scripts/config.js\u751f\u6210rollup\u7684\u914d\u7f6e\u6587\u4ef6\uff1b"),t.createElement("li",null,"\u7b2c\u4e09\u6b65\uff1arollup\u914d\u7f6e\u6587\u4ef6\u8fc7\u6ee4\u3002\u6839\u636e\u4f20\u5165\u7684\u53c2\u6570\uff0c\u5bf9rollup\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6392\u9664\u4e0d\u5fc5\u8981\u7684\u6253\u5305\u9879\u76ee\u3002"),t.createElement("li",null,"\u7b2c\u56db\u6b65\uff1a\u904d\u5386\u914d\u7f6e\u6253\u5305\uff0c\u751f\u6210\u6253\u5305\u6e90\u7801\u3002\u904d\u5386\u914d\u7f6e\u6587\u4ef6\u9879\u76ee\uff0c\u901a\u8fc7rollup.js\u7684API\u8fdb\u884c\u6253\u5305\uff0c\u5e76\u751f\u6210\u6253\u5305\u540e\u7684\u6e90\u7801\u3002"),t.createElement("li",null,"\u7b2c\u4e94\u6b65\uff1a\u6e90\u7801\u8f93\u51fa\u6587\u4ef6\uff0cgzip\u538b\u7f29\u6d4b\u8bd5\u3002\u5982\u679c\u8f93\u51fa\u7684\u662f\u6700\u7ec8\u4ea7\u54c1\uff0c\u5219\u901a\u8fc7terser\u8fdb\u884c\u6700\u5c0f\u5316\u538b\u7f29\u5e76\u901a\u8fc7zlib\u8fdb\u884cgzip\u538b\u7f29\u6d4b\u8bd5\uff0c\u5e76\u5728\u63a7\u5236\u53f0\u8f93\u51fa\u6d4b\u8bd5\u7ed3\u679c\uff0c\u6700\u540e\u5c06\u6e90\u7801\u5185\u5bb9\u8f93\u51fa\u5230\u6307\u5b9a\u6587\u4ef6\u4e2d\uff0c\u5b8c\u6210\u6253\u5305\u3002")),t.createElement("h3",{id:"vuejs\u6253\u5305\u6e90\u7801\u5206\u6790"},t.createElement(r.AnchorLink,{to:"#vuejs\u6253\u5305\u6e90\u7801\u5206\u6790","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"Vue.js\u6253\u5305\u6e90\u7801\u5206\u6790"),t.createElement("p",null,"\u4e0b\u9762\u6211\u4eec\u5c06\u6df1\u5165Vue.js\u6253\u5305\u6e90\u7801\uff0c\u89e3\u6790Vue.js\u6253\u5305\u7684\u539f\u7406\u548c\u7ec6\u8282\u3002"),t.createElement("h4",{id:"\u521b\u5efadist\u76ee\u5f55"},t.createElement(r.AnchorLink,{to:"#\u521b\u5efadist\u76ee\u5f55","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"\u521b\u5efadist\u76ee\u5f55"),t.createElement("p",null,"\u6267\u884c",t.createElement("code",null,"npm run build"),"\u65f6\uff0c\u4f1a\u4ecescripts/build.js\u5f00\u59cb\u6267\u884c\uff1a"),t.createElement(s.Z,{code:"// scripts/build.js\nconst fs = require('fs')\nconst path = require('path')\nconst zlib = require('zlib')\nconst rollup = require('rollup')\nconst terser = require('terser')\n\nif (!fs.existsSync('dist')) {\n  fs.mkdirSync('dist')\n}",lang:"js"}),t.createElement("p",null,"\u524d5\u884c\u5206\u522b\u5bfc\u5165\u4e865\u4e2a\u6a21\u5757\uff0c\u8fd95\u4e2a\u6a21\u5757\u7684\u7528\u9014\u5728\u524d\u7f6e\u5b66\u4e60\u6559\u7a0b\u4e2d\u5df2\u7ecf\u8be6\u7ec6\u8fc7\u3002\u7b2c7\u884c\u901a\u8fc7\u540c\u6b65\u65b9\u6cd5\u5224\u65addist\u76ee\u5f55\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u901a\u8fc7\u540c\u6b65\u65b9\u6cd5\u521b\u5efadist\u76ee\u5f55\u3002"),t.createElement("h4",{id:"\u751f\u6210rollup\u914d\u7f6e"},t.createElement(r.AnchorLink,{to:"#\u751f\u6210rollup\u914d\u7f6e","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"\u751f\u6210rollup\u914d\u7f6e"),t.createElement("p",null,"\u751f\u6210dist\u76ee\u5f55\u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u751f\u6210\u4e86rollup\u7684\u914d\u7f6e\u6587\u4ef6\uff1a"),t.createElement(s.Z,{code:"// scripts/build.js\nlet builds = require('./config').getAllBuilds()",lang:"js"}),t.createElement("p",null,"\u4ee3\u7801\u867d\u7136\u53ea\u6709\u77ed\u77ed\u4e00\u53e5\uff0c\u4f46\u662f\u505a\u4e86\u5f88\u591a\u4e8b\u60c5\u3002\u9996\u5148\u5b83\u52a0\u8f7d\u4e86scripts/config.js\u6a21\u5757\uff0c\u7136\u540e\u8c03\u7528\u5176\u4e2d\u7684getAllBuilds()\u65b9\u6cd5\u3002\u4e0b\u9762\u6211\u4eec\u6765\u5206\u6790scripts/config.js\u7684\u52a0\u8f7d\u8fc7\u7a0b\uff0c\u52a0\u8f7dconfig.js\u65f6\u5148\u6267\u884c\u4e86\u4ee5\u4e0b\u5185\u5bb9\uff1a"),t.createElement(s.Z,{code:"// scripts/config.js\nconst path = require('path')\nconst buble = require('rollup-plugin-buble')\nconst alias = require('rollup-plugin-alias')\nconst cjs = require('rollup-plugin-commonjs')\nconst replace = require('rollup-plugin-replace')\nconst node = require('rollup-plugin-node-resolve')\nconst flow = require('rollup-plugin-flow-no-whitespace')",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e9b\u63d2\u4ef6\u7684\u7528\u9014\u548c\u7528\u6cd5\u5728\u8fdb\u9636\u6559\u7a0b\u548c\u524d\u7f6e\u6559\u7a0b\u4e2d\u90fd\u6709\u4ecb\u7ecd\u3002"),t.createElement(s.Z,{code:"const version = process.env.VERSION || require('../package.json').version\nconst weexVersion = process.env.WEEX_VERSION || require('../packages/weex-vue-framework/package.json').version",lang:"js"}),t.createElement("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u662f\u4ecepackage.json\u4e2d\u83b7\u53d6Vue\u7684\u7248\u672c\u53f7\u548cWeex\u7684\u7248\u672c\u53f7\u3002"),t.createElement(s.Z,{code:"const banner =\n  '/*!\\n' +\n  ` * Vue.js v${version}\\n` +\n  ` * (c) 2014-${new Date().getFullYear()} Evan You\\n` +\n  ' * Released under the MIT License.\\n' +\n  ' */'",lang:"js"}),t.createElement("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u751f\u6210\u4e86banner\u6587\u672c\uff0c\u5728Vue\u4ee3\u7801\u6253\u5305\u540e\uff0c\u4f1a\u5199\u5728\u6587\u4ef6\u9876\u90e8\u3002"),t.createElement(s.Z,{code:"const weexFactoryPlugin = {\n  intro () {\n    return 'module.exports = function weexFactory (exports, document) {'\n  },\n  outro () {\n    return '}'\n  }\n}",lang:"js"}),t.createElement("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u4ec5\u7528\u4e8e\u6253\u5305weex-factory\u6e90\u7801\u65f6\u4f7f\u7528\uff1a"),t.createElement(s.Z,{code:"// Weex runtime factory\n'weex-factory': {\n  weex: true,\n  entry: resolve('weex/entry-runtime-factory.js'),\n  dest: resolve('packages/weex-vue-framework/factory.js'),\n  format: 'cjs',\n  plugins: [weexFactoryPlugin]\n}",lang:"js"}),t.createElement("p",null,"\u63a5\u4e0b\u6765\u5bfc\u5165\u4e86scripts/alias.js\u6a21\u5757\uff1a"),t.createElement(s.Z,{code:"const aliases = require('./alias')",lang:"js"}),t.createElement("p",null,"alias.js\u6a21\u5757\u8f93\u51fa\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u4e2d\u5b9a\u4e49\u4e86\u6240\u6709\u7684\u522b\u540d\u53ca\u5176\u5bf9\u5e94\u7684\u7edd\u5bf9\u8def\u5f84\uff1a"),t.createElement(s.Z,{code:"// scripts/alias.js\nconst path = require('path')\n\nconst resolve = p => path.resolve(__dirname, '../', p)\n\nmodule.exports = {\n  vue: resolve('src/platforms/web/entry-runtime-with-compiler'),\n  compiler: resolve('src/compiler'),\n  core: resolve('src/core'),\n  shared: resolve('src/shared'),\n  web: resolve('src/platforms/web'),\n  weex: resolve('src/platforms/weex'),\n  server: resolve('src/server'),\n  entries: resolve('src/entries'),\n  sfc: resolve('src/sfc')\n}",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e2a\u6a21\u5757\u4e2d\u5b9a\u4e49\u4e86resolve()\u65b9\u6cd5\uff0c\u7528\u4e8e\u751f\u6210\u7edd\u5bf9\u8def\u5f84\uff1a"),t.createElement(s.Z,{code:"const resolve = p => path.resolve(__dirname, '../', p)",lang:"js"}),t.createElement("p",null,"__dirname\u4e3a\u5f53\u524d\u6a21\u5757\u5bf9\u5e94\u7684\u8def\u5f84\uff0c\u5373scripts/\u76ee\u5f55\uff0c\u2026/\u8868\u793a\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff0c\u5373\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0c\u7136\u540e\u901a\u8fc7path.resolve()\u65b9\u6cd5\u5c06\u9879\u76ee\u7684\u6839\u76ee\u5f55\u4e0e\u4f20\u5165\u7684\u76f8\u5bf9\u8def\u5f84\u7ed3\u5408\u8d77\u6765\u5f62\u6210\u6700\u7ec8\u7ed3\u679c\u3002\u56de\u5230scripts/config.js\u6a21\u5757\uff0c\u6211\u4eec\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\uff1a"),t.createElement(s.Z,{code:"// scripts/config.js\nconst resolve = p => {\n  // \u83b7\u53d6\u8def\u5f84\u7684\u522b\u540d\n  const base = p.split('/')[0]\n  // \u67e5\u627e\u522b\u540d\u662f\u5426\u5b58\u5728\n  if (aliases[base]) { \n    // \u5982\u679c\u522b\u540d\u5b58\u5728\uff0c\u5219\u5c06\u522b\u540d\u5bf9\u5e94\u7684\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u8fdb\u884c\u5408\u5e76\n    return path.resolve(aliases[base], p.slice(base.length + 1)) \n  } else {\n    // \u5982\u679c\u522b\u540d\u4e0d\u5b58\u5728\uff0c\u5219\u5c06\u9879\u76ee\u6839\u8def\u5f84\u4e0e\u4f20\u5165\u8def\u5f84\u8fdb\u884c\u5408\u5e76\n    return path.resolve(__dirname, '../', p) \n  }\n}",lang:"js"}),t.createElement("p",null,"config.js\u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e2aresolve\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u8def\u5f84\u53c2\u6570p\uff0c\u5047\u8bbep\u4e3aweb/entry-runtime.js\uff0c\u5219\u7b2c\u4e00\u6b65\u83b7\u53d6\u7684base\u4e3aweb\uff0c\u7136\u540e\u5230alias\u6a21\u5757\u8f93\u51fa\u7684\u5bf9\u8c61aliases\u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684\u522b\u540d\u662f\u5426\u5b58\u5728\uff0cweb\u6a21\u5757\u5bf9\u5e94\u7684\u522b\u540d\u662f\u5b58\u5728\u7684\uff0c\u5b83\u7684\u503c\u4e3a\uff1a"),t.createElement(s.Z,{code:"web: resolve('src/platforms/web')",lang:"js"}),t.createElement("p",null,"\u6240\u4ee5\u4f1a\u5c06\u522b\u540d\u7684\u5b9e\u9645\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u8fdb\u884c\u62fc\u63a5\uff0c\u83b7\u53d6\u6587\u4ef6\u7684\u771f\u5b9e\u8def\u5f84\u3002\u6587\u4ef6\u540d\u7684\u83b7\u53d6\u65b9\u6cd5\u662f\uff1a"),t.createElement(s.Z,{code:"p.slice(base.length + 1)",lang:"js"}),t.createElement("p",null,"\u5982\u679c\u4f20\u5165\u7684\u8def\u5f84\u4e3a\uff1adist/vue.runtime.common.js\uff0c\u5219\u4f1a\u67e5\u627e\u522b\u540ddist\uff0c\u8be5\u522b\u540d\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u6240\u4ee5\u4f1a\u6267\u884c\u53e6\u5916\u4e00\u6761\u8def\u5f84\uff0c\u5c06\u9879\u76ee\u6839\u8def\u5f84\u4e0e\u4f20\u5165\u7684\u53c2\u6570\u8def\u5f84\u8fdb\u884c\u62fc\u63a5\uff0c\u5373\u6267\u884c\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\uff1a"),t.createElement(s.Z,{code:"return path.resolve(__dirname, '../', p)",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e0escripts/alias.js\u6a21\u5757\u7684\u5b9e\u73b0\u662f\u7c7b\u4f3c\u7684\u3002\u63a5\u4e0b\u6765config.js\u6a21\u5757\u4e2d\u5b9a\u4e49\u4e86builds\u53d8\u91cf\uff0c\u4ee3\u7801\u8282\u9009\u5982\u4e0b\uff1a"),t.createElement(s.Z,{code:"const builds = {\n  // Runtime only (CommonJS). Used by bundlers e.g. Webpack & Browserify\n  'web-runtime-cjs': {\n    entry: resolve('web/entry-runtime.js'),\n    dest: resolve('dist/vue.runtime.common.js'),\n    format: 'cjs',\n    banner\n  }\n}",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u8c03\u7528resolve()\u65b9\u6cd5\u751f\u6210\u4e86\u6587\u4ef6\u7684\u771f\u5b9e\u8def\u5f84\uff0c\u7531\u4e8e\u914d\u7f6e\u9879\u91c7\u7528\u7684\u662frollup.js\u8001\u7248\u672c\u7684\u914d\u7f6e\u540d\u79f0\uff0c\u5728\u65b0\u7248\u672c\u4e2d\u5df2\u7ecf\u88ab\u5e9f\u5f03\uff0c\u6240\u4ee5\u7d27\u63a5\u7740config.js\u6a21\u5757\u53c8\u5b9a\u4e49\u4e86\u4e00\u4e2agenConfig(name)\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a"),t.createElement(s.Z,{code:"function genConfig (name) {\n  const opts = builds[name]\n  const config = {\n    input: opts.entry,\n    external: opts.external,\n    plugins: [\n      replace({\n        __WEEX__: !!opts.weex,\n        __WEEX_VERSION__: weexVersion,\n        __VERSION__: version\n      }),\n      flow(),\n      buble(),\n      alias(Object.assign({}, aliases, opts.alias))\n    ].concat(opts.plugins || []),\n    output: {\n      file: opts.dest,\n      format: opts.format,\n      banner: opts.banner,\n      name: opts.moduleName || 'Vue'\n    },\n    onwarn: (msg, warn) => {\n      if (!/Circular/.test(msg)) {\n        warn(msg)\n      }\n    }\n  }\n\n  if (opts.env) {\n    config.plugins.push(replace({\n      'process.env.NODE_ENV': JSON.stringify(opts.env)\n    }))\n  }\n\n  Object.defineProperty(config, '_name', {\n    enumerable: false,\n    value: name\n  })\n\n  return config\n}",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7528\u9014\u662f\u5c06\u8001\u7248\u672c\u7684rollup.js\u914d\u7f6e\u8f6c\u4e3a\u65b0\u7248\u672c\u7684\u683c\u5f0f\u3002\u5bf9\u4e8e\u63d2\u4ef6\u90e8\u5206\uff0c\u6bcf\u4e00\u4e2a\u6253\u5305\u9879\u76ee\u90fd\u4f1a\u91c7\u7528replace\u3001flow\u3001buble\u548calias\u63d2\u4ef6\uff0c\u5176\u4f59\u81ea\u5b9a\u4e49\u7684\u63d2\u4ef6\u4f1a\u5408\u5e76\u5230plugins\u4e2d\uff0c\u901a\u8fc7\u4ee5\u4e0b\u4ee3\u7801\u5b9e\u73b0\uff1a"),t.createElement(s.Z,{code:"plugins: [].concat(opts.plugins || []),",lang:"js"}),t.createElement("p",null,"genConfig()\u65b9\u6cd5\u8fd8\u5224\u65ad\u4e86\u73af\u5883\u53d8\u91cfNODE_ENV\u662f\u5426\u9700\u8981\u88ab\u66ff\u6362\uff1a"),t.createElement(s.Z,{code:"if (opts.env) {\n    config.plugins.push(replace({\n      'process.env.NODE_ENV': JSON.stringify(opts.env)\n    }))\n  }",lang:"js"}),t.createElement("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u5224\u65ad\u4e86\u4f20\u5165\u7684opts\u4e2d\u662f\u5426\u5b58\u5728env\u53c2\u6570\uff0c\u5982\u679c\u5b58\u5728\uff0c\u5219\u4f1a\u5c06\u4ee3\u7801\u4e2d\u7684",t.createElement("code",null,"process.env.NODE_ENV"),"\u90e8\u5206\u66ff\u6362\u4e3a",t.createElement("code",null,"JSON.stringify(opts.env)"),"\uff1a \uff0c\u5982\u4f20\u5165\u7684env\u503c\u4e3adevelopment\uff0c\u5219\u751f\u6210\u7684\u7ed3\u679c\u4e3a\u5e26\u53cc\u5f15\u53f7\u7684development"),t.createElement(s.Z,{code:'"development"',lang:"js"}),t.createElement("p",null,"\u9664\u6b64\u4e4b\u5916\uff0cgenConfig()\u65b9\u6cd5\u8fd8\u5c06builds\u5bf9\u8c61\u7684key\u4fdd\u5b58\u5728config\u5bf9\u8c61\u4e2d\uff1a"),t.createElement(s.Z,{code:"Object.defineProperty(config, '_name', {\n    enumerable: false,\n    value: name\n  })",lang:"js"}),t.createElement("p",null,"\u5982\u679cbuilds\u7684key\u4e3aweb-runtime-cjs\uff0c\u5219\u751f\u6210\u7684config\u4e3a\uff1a"),t.createElement(s.Z,{code:"config = {\n  '_name': 'web-runtime-cjs'\n}",lang:"js"}),t.createElement("p",null,"\u6700\u540econfig.js\u6a21\u5757\u5b9a\u4e49\u4e86getAllBuilds()\u65b9\u6cd5\uff1a"),t.createElement(s.Z,{code:"if (process.env.TARGET) {\n  module.exports = genConfig(process.env.TARGET)\n} else {\n  exports.getBuild = genConfig\n  exports.getAllBuilds = () => Object.keys(builds).map(genConfig)\n}",lang:"js"}),t.createElement("p",null,"\u8be5\u65b9\u6cd5\u9996\u5148\u5224\u65ad\u73af\u5883\u53d8\u91cfTARGET\u662f\u5426\u5b9a\u4e49\uff0c\u5728build\u7684\u4e09\u79cd\u65b9\u6cd5\u4e2d\u6ca1\u6709\u5b9a\u4e49TARGET\u73af\u5883\u53d8\u91cf\uff0c\u6240\u4ee5\u4f1a\u6267\u884celse\u4e2d\u7684\u903b\u8f91\uff0celse\u903b\u8f91\u4e2d\u4f1a\u66b4\u9732\u4e00\u4e2agetBuild()\u65b9\u6cd5\u548cgetAllBuilds()\u65b9\u6cd5\uff0cgetAllBuilds()\u65b9\u6cd5\u4f1a\u83b7\u53d6builds\u5bf9\u8c61\u7684key\u6570\u7ec4\uff0c\u8fdb\u884c\u904d\u5386\u5e76\u8c03\u7528genConfig\u65b9\u6cd5\u751f\u6210\u914d\u7f6e\u5bf9\u8c61\uff0c\u8fd9\u6837rollup\u7684\u914d\u7f6e\u5c31\u751f\u6210\u4e86\u3002"),t.createElement("h3",{id:"rollup\u914d\u7f6e\u8fc7\u6ee4"},t.createElement(r.AnchorLink,{to:"#rollup\u914d\u7f6e\u8fc7\u6ee4","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"rollup\u914d\u7f6e\u8fc7\u6ee4"),t.createElement("p",null,"\u6211\u4eec\u56de\u5230scripts/build.js\u6a21\u5757\uff0c\u914d\u7f6e\u751f\u6210\u5b8c\u6bd5\u540e\uff0c\u5c06\u5bf9\u914d\u7f6e\u9879\u8fdb\u884c\u8fc7\u6ee4\uff0c\u56e0\u4e3a\u6bcf\u4e00\u79cd\u6253\u5305\u6a21\u5f0f\u90fd\u5c06\u8f93\u51fa\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u8fc7\u6ee4\u90e8\u5206\u7684\u6e90\u7801\u5982\u4e0b\uff1a"),t.createElement(s.Z,{code:"// scripts/build.js\n// filter builds via command line arg\nif (process.argv[2]) {\n  const filters = process.argv[2].split(',')\n  builds = builds.filter(b => {\n    return filters.some(f => b.output.file.indexOf(f) > -1 || b._name.indexOf(f) > -1)\n  })\n} else {\n  // filter out weex builds by default\n  builds = builds.filter(b => {\n    return b.output.file.indexOf('weex') === -1\n  })\n}",lang:"js"}),t.createElement("p",null,"\u9996\u5148\u5206\u6790build\u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u5b9e\u9645\u6267\u884c\u6307\u4ee4\u4e3a\uff1a"),t.createElement(s.Z,{code:"node scripts/build.js",lang:"js"}),t.createElement("p",null,"\u6240\u4ee5process.argv\u7684\u5185\u5bb9\u4e3a\uff1a"),t.createElement(s.Z,{code:"[ '/Users/sam/.nvm/versions/node/v11.2.0/bin/node',\n  '/Users/sam/WebstormProjects/vue/scripts/build.js' ]",lang:"js"}),t.createElement("p",null,"\u4e0d\u5b58\u5728process.argv[2]\uff0c\u6240\u4ee5\u4f1a\u6267\u884celse\u4e2d\u7684\u5185\u5bb9\uff1a"),t.createElement(s.Z,{code:"builds = builds.filter(b => {\n  return b.output.file.indexOf('weex') === -1\n})",lang:"js"}),t.createElement("p",null,"\u8fd9\u6bb5\u4ee3\u7801\u7684\u7528\u9014\u662f\u6392\u9664weex\u7684\u4ee3\u7801\u6253\u5305\uff0c\u901a\u8fc7output.file\u662f\u5426\u5305\u542bweex\u5b57\u7b26\u4e32\u5224\u65ad\u662f\u5426\u4e3aweex\u4ee3\u7801\u3002build:ssr\u547d\u4ee4\u5b9e\u9645\u6267\u884c\u6307\u4ee4\u4e3a\uff1a"),t.createElement(s.Z,{code:'node scripts/build.js "web-runtime-cjs,web-server-renderer"',lang:"js"}),t.createElement("p",null,"\u6b64\u65f6process.argv\u7684\u503c\u4e3a\uff1a"),t.createElement(s.Z,{code:"[ '/Users/sam/.nvm/versions/node/v11.2.0/bin/node',\n  '/Users/sam/WebstormProjects/vue/scripts/build.js',\n  'web-runtime-cjs,web-server-renderer' ]",lang:"js"}),t.createElement("p",null,"process.argv[2]\u7684\u503c\u4e3aweb-runtime-cjs,web-server-renderer\uff0c\u6240\u4ee5\u4f1a\u6267\u884cif\u4e2d\u7684\u903b\u8f91\uff1a"),t.createElement(s.Z,{code:"const filters = process.argv[2].split(',')\n  builds = builds.filter(b => {\n    return filters.some(f => b.output.file.indexOf(f) > -1 || b._name.indexOf(f) > -1)",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u9996\u5148\u5c06\u53c2\u6570\u901a\u8fc7\u9017\u53f7\u5206\u9694\u4e3a\u4e00\u4e2afilters\u6570\u7ec4\uff0c\u7136\u540e\u904d\u5386builds\u6570\u7ec4\uff0c\u5bfb\u627eoutput.file\u6216_name\u4e2d\u4efb\u4e00\u4e2a\u5305\u542bfilters\u4e2d\u4efb\u4e00\u4e2a\u7684\u914d\u7f6e\u9879\u3002\u6bd4\u5982filters\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3a\uff1aweb-runtime-cjs\uff0c\u5219\u4f1a\u5bfb\u627eoutput.file\u6216_name\u4e2d\u5305\u542bweb-runtime-cjs\u7684\u914d\u7f6e\u9879\uff0c_name\u4e4b\u524d\u5206\u6790\u8fc7\uff0c\u5b83\u6307\u5411\u914d\u7f6e\u9879\u7684key\uff0c\u6b64\u65f6\u4f1a\u627e\u5230\u4e0b\u9762\u7684\u914d\u7f6e\u9879\u7b26\u5408\u6761\u4ef6\uff1a"),t.createElement(s.Z,{code:"'web-runtime-cjs': {\n  entry: resolve('web/entry-runtime.js'),\n  dest: resolve('dist/vue.runtime.common.js'),\n  format: 'cjs',\n  banner\n}",lang:"js"}),t.createElement("p",null,"\u90a3\u4e48\u8be5\u914d\u7f6e\u5c31\u4f1a\u88ab\u4fdd\u7559\uff0c\u5e76\u6700\u7ec8\u88ab\u6253\u5305\u3002"),t.createElement("h3",{id:"rollup\u6253\u5305"},t.createElement(r.AnchorLink,{to:"#rollup\u6253\u5305","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"rollup\u6253\u5305"),t.createElement("p",null,"\u914d\u7f6e\u8fc7\u6ee4\u5b8c\u4e4b\u540e\u5c31\u4f1a\u8c03\u7528\u6253\u5305\u51fd\u6570\uff1a"),t.createElement(s.Z,{code:"build(builds)",lang:"js"}),t.createElement("p",null,"build\u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\uff1a"),t.createElement(s.Z,{code:"function build (builds) {\n  let built = 0 // \u5f53\u524d\u6253\u5305\u9879\u5e8f\u53f7\n  const total = builds.length // \u9700\u8981\u6253\u5305\u7684\u603b\u6b21\u6570\n  const next = () => {\n    buildEntry(builds[built]).then(() => {\n      built++ // \u6253\u5305\u5b8c\u6210\u540e\u5e8f\u53f7\u52a01\n      if (built < total) {\n        next() // \u5982\u679c\u6253\u5305\u5e8f\u53f7\u5c0f\u4e8e\u6253\u5305\u603b\u6b21\u6570\uff0c\u5219\u7ee7\u7eed\u6267\u884cnext()\u51fd\u6570\n      }\n    }).catch(logError) // \u8f93\u51fa\u9519\u8bef\u4fe1\u606f\n  }\n\n  next() // \u8c03\u7528next()\u51fd\u6570\n}",lang:"js"}),t.createElement("p",null,"build()\u51fd\u6570\u63a5\u6536builds\u53c2\u6570\uff0c\u8fdb\u884c\u904d\u5386\uff0c\u5e76\u8c03\u7528buildEntry()\u51fd\u6570\u6267\u884c\u5b9e\u9645\u7684\u6253\u5305\u903b\u8f91\uff0cbuildEntry()\u51fd\u6570\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61\uff0c\u5982\u679c\u51fa\u9519\uff0c\u4f1a\u8c03\u7528logError(e)\u51fd\u6570\u6253\u5370\u62a5\u9519\u4fe1\u606f\uff1a"),t.createElement(s.Z,{code:"function logError (e) {\n  console.log(e)\n}",lang:"js"}),t.createElement("p",null,"\u6253\u5305\u7684\u6838\u5fc3\u51fd\u6570\u662fbuildEntry(config)"),t.createElement(s.Z,{code:"function buildEntry (config) {\n  const output = config.output // \u83b7\u53d6config\u7684output\u914d\u7f6e\u9879\n  const { file, banner } = output // \u83b7\u53d6output\u4e2d\u7684file\u548cbanner\n  const isProd = /min\\.js$/.test(file) // \u5224\u65adfile\u4e2d\u662f\u5426\u4ee5min.js\u7ed3\u5c3e\uff0c\u5982\u679c\u662f\u5219\u6807\u8bb0isProd\u4e3atrue\n  return rollup.rollup(config) // \u6267\u884crollup\u6253\u5305\n    .then(bundle => bundle.generate(output)) // \u5c06\u6253\u5305\u7684\u7ed3\u679c\u751f\u6210\u6e90\u7801\n    .then(({ code }) => { // \u83b7\u53d6\u6253\u5305\u751f\u6210\u7684\u6e90\u7801\n      if (isProd) { // \u5224\u65ad\u662f\u5426\u4e3aisProd\n        const minified = (banner ? banner + '\\n' : '') + terser.minify(code, { // \u6267\u884c\u4ee3\u7801\u6700\u5c0f\u5316\u6253\u5305\uff0c\u5e76\u5728\u4ee3\u7801\u6807\u9898\u5904\u624b\u52a8\u6dfb\u52a0banner\uff0c\u56e0\u4e3a\u6700\u5c0f\u5316\u6253\u5305\u4f1a\u5bfc\u81f4\u6ce8\u91ca\u88ab\u5220\u9664\n          output: { \n            ascii_only: true // \u53ea\u652f\u6301ascii\u5b57\u7b26\n          },\n          compress: {\n            pure_funcs: ['makeMap'] // \u8fc7\u6ee4makeMap\u51fd\u6570\n          }\n        }).code // \u83b7\u53d6\u6700\u5c0f\u5316\u6253\u5305\u7684\u4ee3\u7801\n        return write(file, minified, true) // \u5c06\u4ee3\u7801\u5199\u5165\u8f93\u51fa\u8def\u5f84\n      } else {\n        return write(file, code) // \u5c06\u4ee3\u7801\u5199\u5165\u8f93\u51fa\u8def\u5f84\n      }\n    })\n}",lang:"js"}),t.createElement("p",null,"\u5982\u679c\u7406\u89e3\u4e86rollup\u7684\u539f\u7406\u53caterser\u7684\u4f7f\u7528\u65b9\u6cd5\uff0c\u7406\u89e3\u4e0a\u8ff0\u4ee3\u7801\u5e76\u4e0d\u96be\uff0c\u8fd9\u91cc\u4e0e\u6211\u4eec\u4e4b\u524d\u4f7f\u7528rollup.js\u6253\u5305\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u91c7\u7528\u4e86\u624b\u52a8\u6dfb\u52a0banner\u6ce8\u91ca\u548c\u624b\u52a8\u8f93\u51fa\u4ee3\u7801\u6587\u4ef6\uff0c\u800c\u4e4b\u524d\u90fd\u662frollup.js\u81ea\u52a8\u8f93\u51fa\u3002\u4e4b\u524d\u6211\u4eec\u91c7\u7528\u7684\u65b9\u6cd5\u4e3a\uff1a"),t.createElement(s.Z,{code:"const bundle = await rollup.rollup(input) // \u83b7\u53d6\u6253\u5305\u5bf9\u8c61bundle\nbundle.write(output) // \u5c06\u6253\u5305\u5bf9\u8c61\u8f93\u51fa\u5230\u6587\u4ef6",lang:"js"}),t.createElement("p",null,"\u800cVue.js\u91c7\u7528\u7684\u65b9\u6cd5\u662f\uff1a"),t.createElement(s.Z,{code:"const bundle = await rollup.rollup(input) // \u83b7\u53d6\u6253\u5305\u5bf9\u8c61bundle\nconst { code, map } = await bundle.generate(output) // \u6839\u636ebundle\u751f\u6210\u6e90\u7801\u548csource map",lang:"js"}),t.createElement("p",null,"\u901a\u8fc7bundle\u83b7\u53d6\u6e90\u7801\uff0c\u7136\u540e\u624b\u52a8\u8f93\u51fa\u5230\u6587\u4ef6\u4e2d\u3002"),t.createElement("h3",{id:"\u6e90\u7801\u8f93\u51fa"},t.createElement(r.AnchorLink,{to:"#\u6e90\u7801\u8f93\u51fa","aria-hidden":"true",tabIndex:-1},t.createElement("span",{className:"icon icon-link"})),"\u6e90\u7801\u8f93\u51fa"),t.createElement("p",null,"\u6e90\u7801\u8f93\u51fa\u4e3b\u8981\u662f\u8c03\u7528write()\u51fd\u6570\uff0c\u8fd9\u91cc\u9700\u8981\u63d0\u4f9b3\u4e2a\u53c2\u6570\uff1a"),t.createElement("ul",null,t.createElement("li",null,"dest\uff1a\u8f93\u51fa\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u901a\u8fc7output.file\u83b7\u53d6\uff1b"),t.createElement("li",null,"code\uff1a\u6e90\u7801\u5b57\u7b26\u4e32\uff0c\u901a\u8fc7bundle.generate()\u83b7\u53d6\uff1b"),t.createElement("li",null,"zip\uff1a\u662f\u5426\u9700\u8981\u8fdb\u884cgzip\u538b\u7f29\u6d4b\u8bd5\uff0c\u5982\u679cisProd\u4e3atrue\uff0c\u5219zip\u4e3atrue\uff0c\u53cd\u4e4b\u4e3afalse\u3002")),t.createElement(s.Z,{code:"function write (dest, code, zip) {\n  return new Promise((resolve, reject) => {\n    function report (extra) { // \u8f93\u51fa\u65e5\u5fd7\u51fd\u6570\n      console.log(blue(path.relative(process.cwd(), dest)) + ' ' + getSize(code) + (extra || '')) // \u6253\u5370\u6587\u4ef6\u540d\u79f0\u3001\u6587\u4ef6\u5bb9\u91cf\u548cgzip\u538b\u7f29\u6d4b\u8bd5\u7ed3\u679c\n      resolve()\n    }\n\n    fs.writeFile(dest, code, err => {\n      if (err) return reject(err) // \u5982\u679c\u62a5\u9519\u5219\u76f4\u63a5\u8c03\u7528reject()\u65b9\u6cd5\n      if (zip) { // \u5982\u679cisProd\u5219\u8fdb\u884cgzip\u6d4b\u8bd5\n        zlib.gzip(code, (err, zipped) => { // \u901a\u8fc7gzip\u5bf9\u6e90\u7801\u8fdb\u884c\u538b\u7f29\u6d4b\u8bd5\n          if (err) return reject(err)\n          report(' (gzipped: ' + getSize(zipped) + ')') // \u6d4b\u8bd5\u6210\u529f\u540e\u83b7\u53d6gzip\u5b57\u7b26\u4e32\u957f\u5ea6\u5e76\u8f93\u51fagizp\u5bb9\u91cf\n        })\n      } else {\n        report() // \u8f93\u51fa\u65e5\u5fd7\n      }\n    })\n  })\n}",lang:"js"}),t.createElement("p",null,"\u8fd9\u91cc\u6709\u51e0\u4e2a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\uff0c\u7b2c\u4e00\u662f\u83b7\u53d6\u5f53\u524d\u547d\u4ee4\u884c\u8def\u5f84\u5230\u6700\u7ec8\u751f\u6210\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\uff1a"),t.createElement(s.Z,{code:"path.relative(process.cwd(), dest)",lang:"js"}),t.createElement("p",null,"\u7b2c\u4e8c\u662f\u8c03\u7528blue()\u51fd\u6570\u751f\u6210\u547d\u4ee4\u884c\u84dd\u8272\u7684\u6587\u672c\uff1a"),t.createElement(s.Z,{code:"function blue (str) {\n  return '\\x1b[1m\\x1b[34m' + str + '\\x1b[39m\\x1b[22m'\n}",lang:"js"}),t.createElement("p",null,"\u7b2c\u4e09\u662f\u83b7\u53d6\u6587\u4ef6\u5bb9\u91cf\u7684\u65b9\u6cd5\uff1a"),t.createElement(s.Z,{code:"function getSize (code) {\n  return (code.length / 1024).toFixed(2) + 'kb'\n}",lang:"js"}),t.createElement("p",null,"\u8fd9\u4e09\u4e2a\u65b9\u6cd5\u4e0d\u96be\u7406\u89e3\uff0c\u4f46\u662f\u90fd\u975e\u5e38\u5b9e\u7528\uff0c\u5927\u5bb6\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u591a\u591a\u501f\u9274\u3002")))}));n["default"]=e=>{var n=t.useContext(r.context),l=n.demos;return t.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&r.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),t.createElement(i,{demos:l})}}}]);