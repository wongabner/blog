(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[8147],{27179:function(e,t,n){"use strict";n.r(t);var l=n(67294),a=n(96089),c=n(65659),s=l.memo((e=>{e.demos;return l.createElement(l.Fragment,null,l.createElement("div",{className:"markdown"},l.createElement("h2",{id:"\u4e00-\u524d\u8a00"},l.createElement(a.AnchorLink,{to:"#\u4e00-\u524d\u8a00","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e00 \u524d\u8a00"),l.createElement("p",null,"\u672c\u7ae0\u8282\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u4e00\u4e0b state \uff0c\u9898\u76ee\u53eb\u505a\u7384\u5b66 state \uff0c\u4e3a\u4ec0\u4e48\u8bf4\u7384\u5b66 state \u5462\uff0c\u56e0\u4e3a\u5728\u4e0d\u540c\u7684\u6267\u884c\u73af\u5883\u4e0b\uff0c\u6216\u8005\u4e0d\u540c\u7684 React \u6a21\u5f0f\u4e0b\uff0cState \u66f4\u65b0\u6d41\u7a0b\u90fd\u662f\u4e0d\u540c\u7684\u3002"),l.createElement("p",null,"\u4e3a\u4e86\u8bc1\u5b9e\u4e0a\u9762\u7684\u8bdd\uff0c\u9996\u5148\u7ffb\u51fa\u4e00\u9053\u8001\u6389\u7259\u7684\u9762\u8bd5\u9898\uff1a",l.createElement("strong",null,"state \u5230\u5e95\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65\u7684\uff1f")),l.createElement("p",null,"\u5982\u679c\u5bf9 React \u5e95\u5c42\u6709\u4e00\u5b9a\u4e86\u89e3\uff0c\u56de\u7b54\u51fa batchUpdate \u6279\u91cf\u66f4\u65b0\u6982\u5ff5\uff0c\u4ee5\u53ca\u6279\u91cf\u66f4\u65b0\u88ab\u6253\u7834\u7684\u6761\u4ef6\u3002\u4f3c\u4e4e\u5df2\u7ecf\u8fbe\u5230\u4e86\u9762\u8bd5\u5b98\u7684\u8981\u6c42\uff0c\u4f46\u662f\u8fd9\u91cc\u60f3\u8bf4\u7684\u662f\uff0c\u8fd9\u4e2a\u7b54\u6848\u5728\u4e0d\u4e45\u7684\u5c06\u6765\u6709\u53ef\u80fd\u88ab\u98a0\u8986\u3002"),l.createElement("p",null,"\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bf4\u5462\uff1f"),l.createElement("p",null,"React \u662f\u6709\u591a\u79cd\u6a21\u5f0f\u7684\uff0c\u57fa\u672c\u5e73\u65f6\u7528\u7684\u90fd\u662f legacy \u6a21\u5f0f\u4e0b\u7684 React\uff0c\u9664\u4e86",l.createElement("code",null,"legacy")," \u6a21\u5f0f\uff0c\u8fd8\u6709 ",l.createElement("code",null,"blocking")," \u6a21\u5f0f\u548c ",l.createElement("code",null,"concurrent")," \u6a21\u5f0f\uff0c blocking \u53ef\u4ee5\u89c6\u4e3a concurrent \u7684\u4f18\u96c5\u964d\u7ea7\u7248\u672c\u548c\u8fc7\u6e21\u7248\u672c\uff0cReact \u6700\u7ec8\u76ee\u7684\uff0c\u4e0d\u4e45\u7684\u672a\u6765\u5c06\u4ee5 concurrent \u6a21\u5f0f\u4f5c\u4e3a\u9ed8\u8ba4\u7248\u672c\uff0c\u8fd9\u4e2a\u6a21\u5f0f\u4e0b\u4f1a\u5f00\u542f\u4e00\u4e9b\u65b0\u529f\u80fd\u3002"),l.createElement("p",null,"\u5bf9\u4e8e concurrent \u6a21\u5f0f\u4e0b\uff0c\u4f1a\u91c7\u7528\u4e0d\u540c State \u66f4\u65b0\u903b\u8f91\u3002\u524d\u4e0d\u4e45\u900f\u9732\u51fa\u672a\u6765\u7684Reactv18 \u7248\u672c\uff0cconcurrent \u5c06\u4f5c\u4e3a\u4e00\u4e2a\u7a33\u5b9a\u7684\u529f\u80fd\u51fa\u73b0\u3002"),l.createElement("p",null,"\u672c\u7ae0\u8282\u4e3b\u8981\u8fd8\u662f\u56f4\u7ed5 legacy \u6a21\u5f0f\u4e0b\u7684 state \u3002\u901a\u8fc7\u672c\u6587\u5b66\u4e60\uff0c\u76ee\u7684\u662f\u8ba9\u5927\u5bb6\u4e86\u89e3 React \u66f4\u65b0\u6d41\u7a0b\uff0c\u4ee5\u53ca\u7c7b\u7ec4\u4ef6 setState \u548c\u51fd\u6570\u7ec4\u4ef6 useState \u7684\u8bf8\u591a\u7ec6\u8282\u95ee\u9898\u3002"),l.createElement("h2",{id:"\u4e8c-\u7c7b\u7ec4\u4ef6\u4e2d\u7684-state"},l.createElement(a.AnchorLink,{to:"#\u4e8c-\u7c7b\u7ec4\u4ef6\u4e2d\u7684-state","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e8c \u7c7b\u7ec4\u4ef6\u4e2d\u7684 state"),l.createElement("h3",{id:"setstate\u7528\u6cd5"},l.createElement(a.AnchorLink,{to:"#setstate\u7528\u6cd5","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"setState\u7528\u6cd5"),l.createElement("p",null,"React \u9879\u76ee\u4e2d UI \u7684\u6539\u53d8\u6765\u6e90\u4e8e state \u6539\u53d8\uff0c\u7c7b\u7ec4\u4ef6\u4e2d ",l.createElement("code",null,"setState")," \u662f\u66f4\u65b0\u7ec4\u4ef6\uff0c\u6e32\u67d3\u89c6\u56fe\u7684\u4e3b\u8981\u65b9\u5f0f\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u57fa\u672c\u7528\u6cd5")),l.createElement(c.Z,{code:"setState(obj,callback)",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u5f53 obj \u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5219\u4e3a\u5373\u5c06\u5408\u5e76\u7684 state \uff1b\u5982\u679c obj \u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u5f53\u524d\u7ec4\u4ef6\u7684 state \u548c props \u5c06\u4f5c\u4e3a\u53c2\u6570\uff0c\u8fd4\u56de\u503c\u7528\u4e8e\u5408\u5e76\u65b0\u7684 state\u3002"),l.createElement("li",null,"\u7b2c\u4e8c\u4e2a\u53c2\u6570 callback \uff1acallback \u4e3a\u4e00\u4e2a\u51fd\u6570\uff0c\u51fd\u6570\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d setState \u66f4\u65b0\u540e\u7684\u6700\u65b0 state \u7684\u503c\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4f9d\u8d56 state \u53d8\u5316\u7684\u526f\u4f5c\u7528\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u6765\u505a\u4e00\u4e9b\u57fa\u4e8e DOM \u7684\u64cd\u4f5c\u3002")),l.createElement(c.Z,{code:"/* \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3afunction\u7c7b\u578b */\nthis.setState((state,props)=>{\n    return { number:1 } \n})\n/* \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3aobject\u7c7b\u578b */\nthis.setState({ number:1 },()=>{\n    console.log(this.state.number) //\u83b7\u53d6\u6700\u65b0\u7684number\n})",lang:"js"}),l.createElement("p",null,"\u5047\u5982\u4e00\u6b21\u4e8b\u4ef6\u4e2d\u89e6\u53d1\u4e00\u6b21\u5982\u4e0a setState \uff0c\u5728 React \u5e95\u5c42\u4e3b\u8981\u505a\u4e86\u90a3\u4e9b\u4e8b\u5462\uff1f"),l.createElement("ul",null,l.createElement("li",null,"\u9996\u5148\uff0csetState \u4f1a\u4ea7\u751f\u5f53\u524d\u66f4\u65b0\u7684\u4f18\u5148\u7ea7\uff08\u8001\u7248\u672c\u7528 expirationTime \uff0c\u65b0\u7248\u672c\u7528 lane \uff09\u3002"),l.createElement("li",null,"\u63a5\u4e0b\u6765 React \u4f1a\u4ece fiber Root \u6839\u90e8 fiber \u5411\u4e0b\u8c03\u548c\u5b50\u8282\u70b9\uff0c\u8c03\u548c\u9636\u6bb5\u5c06\u5bf9\u6bd4\u53d1\u751f\u66f4\u65b0\u7684\u5730\u65b9\uff0c\u66f4\u65b0\u5bf9\u6bd4 expirationTime \uff0c\u627e\u5230\u53d1\u751f\u66f4\u65b0\u7684\u7ec4\u4ef6\uff0c\u5408\u5e76 state\uff0c\u7136\u540e\u89e6\u53d1 render \u51fd\u6570\uff0c\u5f97\u5230\u65b0\u7684 UI \u89c6\u56fe\u5c42\uff0c\u5b8c\u6210 render \u9636\u6bb5\u3002"),l.createElement("li",null,"\u63a5\u4e0b\u6765\u5230 commit \u9636\u6bb5\uff0ccommit \u9636\u6bb5\uff0c\u66ff\u6362\u771f\u5b9e DOM \uff0c\u5b8c\u6210\u6b64\u6b21\u66f4\u65b0\u6d41\u7a0b\u3002"),l.createElement("li",null,"\u6b64\u65f6\u4ecd\u7136\u5728 commit \u9636\u6bb5\uff0c\u4f1a\u6267\u884c setState \u4e2d callback \u51fd\u6570,\u5982\u4e0a\u7684",l.createElement("code",null,"()=>","{"," console.log(this.state.number) ","}"),"\uff0c\u5230\u6b64\u4e3a\u6b62\u5b8c\u6210\u4e86\u4e00\u6b21 setState \u5168\u8fc7\u7a0b\u3002")),l.createElement("p",null,l.createElement("strong",null,"\u66f4\u65b0\u7684\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a")),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d5e25a4ed464547bdd0e7c3a44d0ccc~tplv-k3u1fbpfcp-watermark.awebp",alt:"02.jpg"})),l.createElement("p",null,"\u8bf7\u8bb0\u4f4f\u4e00\u4e2a\u4e3b\u8981\u4efb\u52a1\u7684\u5148\u540e\u987a\u5e8f\uff0c\u8fd9\u5bf9\u4e8e\u5f04\u6e05\u6e32\u67d3\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u6709\u5e2e\u52a9\uff1a render \u9636\u6bb5 render \u51fd\u6570\u6267\u884c -> commit \u9636\u6bb5\u771f\u5b9e DOM \u66ff\u6362 -> setState \u56de\u8c03\u51fd\u6570\u6267\u884c callback \u3002"),l.createElement("p",null,l.createElement("strong",null,"\u7c7b\u7ec4\u4ef6\u5982\u4f55\u9650\u5236 state \u66f4\u65b0\u89c6\u56fe")),l.createElement("p",null,"\u5bf9\u4e8e\u7c7b\u7ec4\u4ef6\u5982\u4f55\u9650\u5236 state \u5e26\u6765\u7684\u66f4\u65b0\u4f5c\u7528\u7684\u5462\uff1f"),l.createElement("ul",null,l.createElement("li",null,"\u2460 pureComponent \u53ef\u4ee5\u5bf9 state \u548c props \u8fdb\u884c\u6d45\u6bd4\u8f83\uff0c\u5982\u679c\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u90a3\u4e48\u7ec4\u4ef6\u4e0d\u66f4\u65b0\u3002"),l.createElement("li",null,"\u2461 shouldComponentUpdate \u751f\u547d\u5468\u671f\u53ef\u4ee5\u901a\u8fc7\u5224\u65ad\u524d\u540e state \u53d8\u5316\u6765\u51b3\u5b9a\u7ec4\u4ef6\u9700\u4e0d\u9700\u8981\u66f4\u65b0\uff0c\u9700\u8981\u66f4\u65b0\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002")),l.createElement("h3",{id:"setstate\u539f\u7406\u63ed\u79d8"},l.createElement(a.AnchorLink,{to:"#setstate\u539f\u7406\u63ed\u79d8","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"setState\u539f\u7406\u63ed\u79d8"),l.createElement("p",null,"\u77e5\u5176\u7136\uff0c\u77e5\u5176\u6240\u4ee5\u7136\uff0c\u60f3\u8981\u5403\u900f setState\uff0c\u5c31\u9700\u8981\u638c\u63e1\u4e00\u4e9b setState \u7684\u5e95\u5c42\u903b\u8f91\u3002 \u4e0a\u4e00\u7ae0\u8282\u8bb2\u5230\u5bf9\u4e8e\u7c7b\u7ec4\u4ef6\uff0c\u7c7b\u7ec4\u4ef6\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u7ed1\u5b9a\u4e86\u8d1f\u8d23\u66f4\u65b0\u7684",l.createElement("code",null,"Updater"),"\u5bf9\u8c61\uff0c\u5bf9\u4e8e\u5982\u679c\u8c03\u7528 setState \u65b9\u6cd5\uff0c\u5b9e\u9645\u4e0a\u662f React \u5e95\u5c42\u8c03\u7528 Updater \u5bf9\u8c61\u4e0a\u7684 enqueueSetState \u65b9\u6cd5\u3002"),l.createElement("p",null,"\u56e0\u4e3a\u8981\u5f04\u660e\u767d state \u66f4\u65b0\u673a\u5236\uff0c\u6240\u4ee5\u63a5\u4e0b\u6765\u8981\u4ece\u4e24\u4e2a\u65b9\u5411\u5206\u6790\u3002"),l.createElement("ul",null,l.createElement("li",null,"\u4e00\u662f\u63ed\u79d8 enqueueSetState \u5230\u5e95\u505a\u4e86\u4e9b\u4ec0\u4e48\uff1f"),l.createElement("li",null,"\u4e8c\u662f React \u5e95\u5c42\u662f\u5982\u4f55\u8fdb\u884c\u6279\u91cf\u66f4\u65b0\u7684\uff1f")),l.createElement("p",null,"\u9996\u5148\uff0c\u8fd9\u91cc\u6781\u81f4\u7cbe\u7b80\u4e86\u4e00\u6ce2 enqueueSetState \u4ee3\u7801\u3002\u5982\u4e0b"),l.createElement("blockquote",null,l.createElement("p",null,"react-reconciler/src/ReactFiberClassComponent.js")),l.createElement(c.Z,{code:"enqueueSetState(){\n     /* \u6bcf\u4e00\u6b21\u8c03\u7528`setState`\uff0creact \u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a update \u91cc\u9762\u4fdd\u5b58\u4e86 */\n     const update = createUpdate(expirationTime, suspenseConfig);\n     /* callback \u53ef\u4ee5\u7406\u89e3\u4e3a setState \u56de\u8c03\u51fd\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570 */\n     callback && (update.callback = callback) \n     /* enqueueUpdate \u628a\u5f53\u524d\u7684update \u4f20\u5165\u5f53\u524dfiber\uff0c\u5f85\u66f4\u65b0\u961f\u5217\u4e2d */\n     enqueueUpdate(fiber, update); \n     /* \u5f00\u59cb\u8c03\u5ea6\u66f4\u65b0 */\n     scheduleUpdateOnFiber(fiber, expirationTime);\n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"enqueueSetState")," \u4f5c\u7528\u5b9e\u9645\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a update \uff0c\u7136\u540e\u653e\u5165\u5f53\u524d fiber \u5bf9\u8c61\u7684\u5f85\u66f4\u65b0\u961f\u5217\u4e2d\uff0c\u6700\u540e\u5f00\u542f\u8c03\u5ea6\u66f4\u65b0\uff0c\u8fdb\u5165\u4e0a\u8ff0\u8bb2\u5230\u7684\u66f4\u65b0\u6d41\u7a0b\u3002"),l.createElement("p",null,"\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0cReact \u7684 batchUpdate \u6279\u91cf\u66f4\u65b0\u662f\u4ec0\u4e48\u65f6\u5019\u52a0\u4e0a\u53bb\u7684\u5462\uff1f"),l.createElement("p",null,"\u8fd9\u5c31\u8981\u63d0\u524d\u804a\u4e00\u4e0b\u4e8b\u4ef6\u7cfb\u7edf\u4e86\u3002\u6b63\u5e38 ",l.createElement("strong",null,"state \u66f4\u65b0"),"\u3001",l.createElement("strong",null,"UI \u4ea4\u4e92"),"\uff0c\u90fd\u79bb\u4e0d\u5f00\u7528\u6237\u7684\u4e8b\u4ef6\uff0c\u6bd4\u5982\u70b9\u51fb\u4e8b\u4ef6\uff0c\u8868\u5355\u8f93\u5165\u7b49\uff0cReact \u662f\u91c7\u7528\u4e8b\u4ef6\u5408\u6210\u7684\u5f62\u5f0f\uff0c\u6bcf\u4e00\u4e2a\u4e8b\u4ef6\u90fd\u662f\u7531 React \u4e8b\u4ef6\u7cfb\u7edf\u7edf\u4e00\u8c03\u5ea6\u7684\uff0c\u90a3\u4e48 State \u6279\u91cf\u66f4\u65b0\u6b63\u662f\u548c\u4e8b\u4ef6\u7cfb\u7edf\u606f\u606f\u76f8\u5173\u7684\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"react-dom/src/events/DOMLegacyEventPluginSystem.js")),l.createElement(c.Z,{code:"/* \u5728`legacy`\u6a21\u5f0f\u4e0b\uff0c\u6240\u6709\u7684\u4e8b\u4ef6\u90fd\u5c06\u7ecf\u8fc7\u6b64\u51fd\u6570\u540c\u4e00\u5904\u7406 */\nfunction dispatchEventForLegacyPluginEventSystem(){\n    // handleTopLevel \u4e8b\u4ef6\u5904\u7406\u51fd\u6570\n    batchedEventUpdates(handleTopLevel, bookKeeping);\n}",lang:"js"}),l.createElement("p",null,"\u91cd\u70b9\u6765\u4e86\uff0c\u5c31\u662f\u4e0b\u9762\u8fd9\u4e2a batchedEventUpdates \u65b9\u6cd5\u3002"),l.createElement("blockquote",null,l.createElement("p",null,"react-dom/src/events/ReactDOMUpdateBatching.js")),l.createElement(c.Z,{code:"function batchedEventUpdates(fn,a){\n    /* \u5f00\u542f\u6279\u91cf\u66f4\u65b0  */\n   isBatchingEventUpdates = true;\n  try {\n    /* \u8fd9\u91cc\u6267\u884c\u4e86\u7684\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\uff0c \u6bd4\u5982\u5728\u4e00\u6b21\u70b9\u51fb\u4e8b\u4ef6\u4e2d\u89e6\u53d1setState,\u90a3\u4e48\u5b83\u5c06\u5728\u8fd9\u4e2a\u51fd\u6570\u5185\u6267\u884c */\n    return batchedEventUpdatesImpl(fn, a, b);\n  } finally {\n    /* try \u91cc\u9762 return \u4e0d\u4f1a\u5f71\u54cd finally \u6267\u884c  */\n    /* \u5b8c\u6210\u4e00\u6b21\u4e8b\u4ef6\uff0c\u6279\u91cf\u66f4\u65b0  */\n    isBatchingEventUpdates = false;\n  }\n}",lang:"js"}),l.createElement("p",null,"\u5982\u4e0a\u53ef\u4ee5\u5206\u6790\u51fa\u6d41\u7a0b\uff0c\u5728 React \u4e8b\u4ef6\u6267\u884c\u4e4b\u524d\u901a\u8fc7 ",l.createElement("code",null,"isBatchingEventUpdates=true")," \u6253\u5f00\u5f00\u5173\uff0c\u5f00\u542f\u4e8b\u4ef6\u6279\u91cf\u66f4\u65b0\uff0c\u5f53\u8be5\u4e8b\u4ef6\u7ed3\u675f\uff0c\u518d\u901a\u8fc7 ",l.createElement("code",null,"isBatchingEventUpdates = false;")," \u5173\u95ed\u5f00\u5173\uff0c\u7136\u540e\u5728 scheduleUpdateOnFiber \u4e2d\u6839\u636e\u8fd9\u4e2a\u5f00\u5173\u6765\u786e\u5b9a\u662f\u5426\u8fdb\u884c\u6279\u91cf\u66f4\u65b0\u3002"),l.createElement("p",null,"\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u4e0b\u7ec4\u4ef6\u4e2d\u8fd9\u4e48\u5199\uff1a"),l.createElement(c.Z,{code:"export default class index extends React.Component{\n    state = { number:0 }\n    handleClick= () => {\n          this.setState({ number:this.state.number + 1 },()=>{   console.log( 'callback1', this.state.number)  })\n          console.log(this.state.number)\n          this.setState({ number:this.state.number + 1 },()=>{   console.log( 'callback2', this.state.number)  })\n          console.log(this.state.number)\n          this.setState({ number:this.state.number + 1 },()=>{   console.log( 'callback3', this.state.number)  })\n          console.log(this.state.number)\n    }\n    render(){\n        return <div>\n            { this.state.number }\n            <button onClick={ this.handleClick }  >number++</button>\n        </div>\n    }\n}",lang:"js"}),l.createElement("p",null,"\u70b9\u51fb\u6253\u5370\uff1a",l.createElement("strong",null,"0, 0, 0, callback1 1 ,callback2 1 ,callback3 1")),l.createElement("p",null,"\u5982\u4e0a\u4ee3\u7801\uff0c\u5728\u6574\u4e2a React \u4e0a\u4e0b\u6587\u6267\u884c\u6808\u4e2d\u4f1a\u53d8\u6210\u8fd9\u6837\uff1a"),l.createElement("p",null,l.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/478aef991b4146c898095b83fe3dc0e7~tplv-k3u1fbpfcp-watermark.awebp",alt:"03.jpg"})),l.createElement("p",null,"\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u5f02\u6b65\u64cd\u4f5c\u91cc\u9762\u7684\u6279\u91cf\u66f4\u65b0\u89c4\u5219\u4f1a\u88ab\u6253\u7834\u5462\uff1f\u6bd4\u5982\u7528 promise \u6216\u8005 setTimeout \u5728 handleClick \u4e2d\u8fd9\u4e48\u5199\uff1a"),l.createElement(c.Z,{code:"setTimeout(()=>{\n    this.setState({ number:this.state.number + 1 },()=>{   console.log( 'callback1', this.state.number)  })\n    console.log(this.state.number)\n    this.setState({ number:this.state.number + 1 },()=>{    console.log( 'callback2', this.state.number)  })\n    console.log(this.state.number)\n    this.setState({ number:this.state.number + 1 },()=>{   console.log( 'callback3', this.state.number)  })\n    console.log(this.state.number)\n})",lang:"js"}),l.createElement("p",null,"\u6253\u5370 \uff1a ",l.createElement("strong",null,"callback1 1 , 1, callback2 2 , 2,callback3 3 , 3")),l.createElement("p",null,"\u90a3\u4e48\u5728\u6574\u4e2a React \u4e0a\u4e0b\u6587\u6267\u884c\u6808\u4e2d\u5c31\u4f1a\u53d8\u6210\u5982\u4e0b\u56fe\u8fd9\u6837:"),l.createElement("p",null,l.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48e730fc687c4ce087e5c0eab2832273~tplv-k3u1fbpfcp-watermark.awebp",alt:"04.jpg"})),l.createElement("p",null,l.createElement("strong",null,"\u6240\u4ee5\u6279\u91cf\u66f4\u65b0\u89c4\u5219\u88ab\u6253\u7834"),"\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u90a3\u4e48\uff0c\u5982\u4f55\u5728\u5982\u4e0a\u5f02\u6b65\u73af\u5883\u4e0b\uff0c\u7ee7\u7eed\u5f00\u542f\u6279\u91cf\u66f4\u65b0\u6a21\u5f0f\u5462\uff1f")),l.createElement("p",null,"React-Dom \u4e2d\u63d0\u4f9b\u4e86\u6279\u91cf\u66f4\u65b0\u65b9\u6cd5 ",l.createElement("code",null,"unstable_batchedUpdates"),"\uff0c\u53ef\u4ee5\u53bb\u624b\u52a8\u6279\u91cf\u66f4\u65b0\uff0c\u53ef\u4ee5\u5c06\u4e0a\u8ff0 setTimeout \u91cc\u9762\u7684\u5185\u5bb9\u505a\u5982\u4e0b\u4fee\u6539:"),l.createElement(c.Z,{code:"import ReactDOM from 'react-dom'\nconst { unstable_batchedUpdates } = ReactDOM\nsetTimeout(()=>{\n    unstable_batchedUpdates(()=>{\n        this.setState({ number:this.state.number + 1 })\n        console.log(this.state.number)\n        this.setState({ number:this.state.number + 1})\n        console.log(this.state.number)\n        this.setState({ number:this.state.number + 1 })\n        console.log(this.state.number) \n    })\n})",lang:"js"}),l.createElement("p",null,"\u6253\u5370\uff1a ",l.createElement("strong",null,"0 , 0 , 0 , callback1 1 , callback2 1 ,callback3 1")),l.createElement("p",null,"\u5728\u5b9e\u9645\u5de5\u4f5c\u4e2d\uff0cunstable_batchedUpdates \u53ef\u4ee5\u7528\u4e8e Ajax \u6570\u636e\u4ea4\u4e92\u4e4b\u540e\uff0c\u5408\u5e76\u591a\u6b21 setState\uff0c\u6216\u8005\u662f\u591a\u6b21 useState \u3002\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u6240\u6709\u7684\u6570\u636e\u4ea4\u4e92\u90fd\u662f\u5728\u5f02\u6b65\u73af\u5883\u4e0b\uff0c\u5982\u679c\u6ca1\u6709\u6279\u91cf\u66f4\u65b0\u5904\u7406\uff0c\u4e00\u6b21\u6570\u636e\u4ea4\u4e92\u591a\u6b21\u6539\u53d8 state \u4f1a\u4fc3\u4f7f\u89c6\u56fe\u591a\u6b21\u6e32\u67d3\u3002"),l.createElement("p",null,l.createElement("strong",null,"\u90a3\u4e48\u5982\u4f55\u63d0\u5347\u66f4\u65b0\u4f18\u5148\u7ea7\u5462\uff1f")),l.createElement("p",null,"React-dom \u63d0\u4f9b\u4e86 flushSync \uff0cflushSync \u53ef\u4ee5\u5c06\u56de\u8c03\u51fd\u6570\u4e2d\u7684\u66f4\u65b0\u4efb\u52a1\uff0c\u653e\u5728\u4e00\u4e2a\u8f83\u9ad8\u7684\u4f18\u5148\u7ea7\u4e2d\u3002React \u8bbe\u5b9a\u4e86\u5f88\u591a\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u66f4\u65b0\u4efb\u52a1\u3002\u5982\u679c\u4e00\u6b21\u66f4\u65b0\u4efb\u52a1\u5728 flushSync \u56de\u8c03\u51fd\u6570\u5185\u90e8\uff0c\u90a3\u4e48\u5c06\u83b7\u5f97\u4e00\u4e2a\u8f83\u9ad8\u4f18\u5148\u7ea7\u7684\u66f4\u65b0\u3002"),l.createElement("p",null,"\u63a5\u4e0b\u6765\uff0c\u5c06\u4e0a\u8ff0 ",l.createElement("code",null,"handleClick")," \u6539\u7248\u5982\u4e0b\u6837\u5b50\uff1a"),l.createElement(c.Z,{code:"handerClick=()=>{\n    setTimeout(()=>{\n        this.setState({ number: 1  })\n    })\n    this.setState({ number: 2  })\n    ReactDOM.flushSync(()=>{\n        this.setState({ number: 3  })\n    })\n    this.setState({ number: 4  })\n}\nrender(){\n   console.log(this.state.number)\n   return ...\n}",lang:"js"}),l.createElement("p",null,"\u6253\u5370 ",l.createElement("strong",null,"3 4 1")," \uff0c\u76f8\u4fe1\u4e0d\u96be\u7406\u89e3\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u6253\u5370\u4e86\u3002"),l.createElement("ul",null,l.createElement("li",null,"\u9996\u5148 ",l.createElement("code",null,"flushSync")," ",l.createElement("code",null,"this.setState(","{"," number: 3 ","}",")"),"\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u9ad8\u4f18\u5148\u7ea7\u7684\u66f4\u65b0\uff0c\u6240\u4ee5 2 \u548c 3 \u88ab\u6279\u91cf\u66f4\u65b0\u5230 3 \uff0c\u6240\u4ee5 3 \u5148\u88ab\u6253\u5370\u3002"),l.createElement("li",null,"\u66f4\u65b0\u4e3a 4\u3002"),l.createElement("li",null,"\u6700\u540e\u66f4\u65b0 setTimeout \u4e2d\u7684 number = 1\u3002")),l.createElement("p",null,l.createElement("strong",null,"flushSync\u8865\u5145\u8bf4\u660e"),"\uff1aflushSync \u5728\u540c\u6b65\u6761\u4ef6\u4e0b\uff0c\u4f1a\u5408\u5e76\u4e4b\u524d\u7684 setState | useState\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\uff0c\u5982\u679c\u53d1\u73b0\u4e86 flushSync \uff0c\u5c31\u4f1a\u5148\u6267\u884c\u66f4\u65b0\uff0c\u5982\u679c\u4e4b\u524d\u6709\u672a\u66f4\u65b0\u7684 setState \uff5c useState \uff0c\u5c31\u4f1a\u4e00\u8d77\u5408\u5e76\u4e86\uff0c\u6240\u4ee5\u5c31\u89e3\u91ca\u4e86\u5982\u4e0a\uff0c2 \u548c 3 \u88ab\u6279\u91cf\u66f4\u65b0\u5230 3 \uff0c\u6240\u4ee5 3 \u5148\u88ab\u6253\u5370\u3002"),l.createElement("p",null,"\u7efc\u4e0a\u6240\u8ff0\uff0c React \u540c\u4e00\u7ea7\u522b",l.createElement("strong",null,"\u66f4\u65b0\u4f18\u5148\u7ea7"),"\u5173\u7cfb\u662f:"),l.createElement("p",null,"flushSync \u4e2d\u7684 setState ",l.createElement("strong",null,">")," \u6b63\u5e38\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d setState ",l.createElement("strong",null,">")," setTimeout \uff0cPromise \u4e2d\u7684 setState\u3002"),l.createElement("h2",{id:"\u4e09-\u51fd\u6570\u7ec4\u4ef6\u4e2d\u7684state"},l.createElement(a.AnchorLink,{to:"#\u4e09-\u51fd\u6570\u7ec4\u4ef6\u4e2d\u7684state","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u4e09 \u51fd\u6570\u7ec4\u4ef6\u4e2d\u7684state"),l.createElement("p",null,"React-hooks \u6b63\u5f0f\u53d1\u5e03\u4ee5\u540e\uff0c useState \u53ef\u4ee5\u4f7f\u51fd\u6570\u7ec4\u4ef6\u50cf\u7c7b\u7ec4\u4ef6\u4e00\u6837\u62e5\u6709 state\uff0c\u4e5f\u5c31\u8bf4\u660e\u51fd\u6570\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7 useState \u6539\u53d8 UI \u89c6\u56fe\u3002\u90a3\u4e48 useState \u5230\u5e95\u5e94\u8be5\u5982\u4f55\u4f7f\u7528\uff0c\u5e95\u5c42\u53c8\u662f\u600e\u4e48\u8fd0\u4f5c\u7684\u5462\uff0c\u9996\u5148\u4e00\u8d77\u770b\u4e00\u4e0b useState \u3002"),l.createElement("h3",{id:"usestate\u7528\u6cd5"},l.createElement(a.AnchorLink,{to:"#usestate\u7528\u6cd5","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"useState\u7528\u6cd5"),l.createElement("p",null,l.createElement("strong",null,"\u57fa\u672c\u7528\u6cd5")),l.createElement(c.Z,{code:"[ \u2460state , \u2461dispatch ] = useState(\u2462initData)",lang:"js"}),l.createElement("ul",null,l.createElement("li",null,"\u2460 state\uff0c\u76ee\u7684\u63d0\u4f9b\u7ed9 UI \uff0c\u4f5c\u4e3a\u6e32\u67d3\u89c6\u56fe\u7684\u6570\u636e\u6e90\u3002"),l.createElement("li",null,"\u2461 dispatch \u6539\u53d8 state \u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u63a8\u52a8\u51fd\u6570\u7ec4\u4ef6\u6e32\u67d3\u7684\u6e32\u67d3\u51fd\u6570\u3002"),l.createElement("li",null,"\u2462 initData \u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u79cd\u60c5\u51b5\u662f\u975e\u51fd\u6570\uff0c\u5c06\u4f5c\u4e3a state \u521d\u59cb\u5316\u7684\u503c\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\u662f\u51fd\u6570\uff0c\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a useState \u521d\u59cb\u5316\u7684\u503c\u3002")),l.createElement("p",null,"initData \u4e3a\u975e\u51fd\u6570\u7684\u60c5\u51b5:"),l.createElement(c.Z,{code:"/* \u6b64\u65f6\u5c06\u628a 0 \u4f5c\u4e3a\u521d\u4f7f\u503c */\nconst [ number , setNumber ] = React.useState(0)",lang:"js"}),l.createElement("p",null,"initData \u4e3a\u51fd\u6570\u7684\u60c5\u51b5:"),l.createElement(c.Z,{code:"const [ number , setNumber ] = React.useState(()=>{\n       /*  props \u4e2d a = 1 state \u4e3a 0-1 \u968f\u673a\u6570 \uff0c a = 2 state \u4e3a 1 -10\u968f\u673a\u6570 \uff0c \u5426\u5219\uff0cstate \u4e3a 1 - 100 \u968f\u673a\u6570   */\n       if(props.a === 1) return Math.random() \n       if(props.a === 2) return Math.ceil(Math.random() * 10 )\n       return Math.ceil(Math.random() * 100 ) \n    })",lang:"js"}),l.createElement("p",null,"\u5bf9\u4e8e dispatch\u7684\u53c2\u6570,\u4e5f\u6709\u4e24\u79cd\u60c5\u51b5\uff1a"),l.createElement("ul",null,l.createElement("li",null,"\u7b2c\u4e00\u79cd\u975e\u51fd\u6570\u60c5\u51b5\uff0c\u6b64\u65f6\u5c06\u4f5c\u4e3a\u65b0\u7684\u503c\uff0c\u8d4b\u4e88\u7ed9 state\uff0c\u4f5c\u4e3a\u4e0b\u4e00\u6b21\u6e32\u67d3\u4f7f\u7528;"),l.createElement("li",null,"\u7b2c\u4e8c\u79cd\u662f\u51fd\u6570\u7684\u60c5\u51b5\uff0c\u5982\u679c dispatch \u7684\u53c2\u6570\u4e3a\u4e00\u4e2a\u51fd\u6570\uff0c\u8fd9\u91cc\u53ef\u4ee5\u79f0\u5b83\u4e3areducer\uff0creducer \u53c2\u6570\uff0c\u662f\u4e0a\u4e00\u6b21\u8fd4\u56de\u6700\u65b0\u7684 state\uff0c\u8fd4\u56de\u503c\u4f5c\u4e3a\u65b0\u7684 state\u3002")),l.createElement("p",null,l.createElement("strong",null,"dispatch \u53c2\u6570\u662f\u4e00\u4e2a\u975e\u51fd\u6570\u503c")),l.createElement(c.Z,{code:"const [ number , setNumbsr ] = React.useState(0)\n/* \u4e00\u4e2a\u70b9\u51fb\u4e8b\u4ef6 */\nconst handleClick=()=>{\n   setNumber(1)\n   setNumber(2)\n   setNumber(3)\n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"dispatch \u53c2\u6570\u662f\u4e00\u4e2a\u51fd\u6570")),l.createElement(c.Z,{code:"const [ number , setNumbsr ] = React.useState(0)\nconst handleClick=()=>{\n   setNumber((state)=> state + 1)  // state - > 0 + 1 = 1\n   setNumber(8)  // state - > 8\n   setNumber((state)=> state + 1)  // state - > 8 + 1 = 9\n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u5982\u4f55\u76d1\u542c state \u53d8\u5316\uff1f")),l.createElement("p",null,"\u7c7b\u7ec4\u4ef6 setState \u4e2d\uff0c\u6709\u7b2c\u4e8c\u4e2a\u53c2\u6570 callback \u6216\u8005\u662f\u751f\u547d\u5468\u671fcomponentDidUpdate \u53ef\u4ee5\u68c0\u6d4b\u76d1\u542c\u5230 state \u6539\u53d8\u6216\u662f\u7ec4\u4ef6\u66f4\u65b0\u3002"),l.createElement("p",null,"\u90a3\u4e48\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\uff0c\u5982\u4f55\u600e\u4e48\u76d1\u542c state \u53d8\u5316\u5462\uff1f\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981 useEffect \u51fa\u573a\u4e86\uff0c\u901a\u5e38\u53ef\u4ee5\u628a state \u4f5c\u4e3a\u4f9d\u8d56\u9879\u4f20\u5165 useEffect \u7b2c\u4e8c\u4e2a\u53c2\u6570 deps \uff0c\u4f46\u662f\u6ce8\u610f useEffect \u521d\u59cb\u5316\u4f1a\u9ed8\u8ba4\u6267\u884c\u4e00\u6b21\u3002"),l.createElement("p",null,"\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b Demo :"),l.createElement(c.Z,{code:"export default function Index(props){\n    const [ number , setNumber ] = React.useState(0)\n    /* \u76d1\u542c number \u53d8\u5316 */\n    React.useEffect(()=>{\n        console.log('\u76d1\u542cnumber\u53d8\u5316\uff0c\u6b64\u65f6\u7684number\u662f:  ' + number )\n    },[ number ])\n    const handerClick = ()=>{\n        /** \u9ad8\u4f18\u5148\u7ea7\u66f4\u65b0 **/\n        ReactDOM.flushSync(()=>{\n            setNumber(2) \n        })\n        /* \u6279\u91cf\u66f4\u65b0 */\n        setNumber(1) \n        /* \u6ede\u540e\u66f4\u65b0 \uff0c\u6279\u91cf\u66f4\u65b0\u89c4\u5219\u88ab\u6253\u7834 */\n        setTimeout(()=>{\n            setNumber(3) \n        })\n       \n    }\n    console.log(number)\n    return <div>\n        <span> { number }</span>\n        <button onClick={ handerClick }  >number++</button>\n    </div>\n}",lang:"js"}),l.createElement("p",null,"\u6548\u679c:"),l.createElement("p",null,l.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7ac7c4b4be454d6b937b1da56eab8984~tplv-k3u1fbpfcp-watermark.awebp",alt:"01.jpg"})),l.createElement("p",null,l.createElement("strong",null,l.createElement("code",null,"dispatch"),"\u66f4\u65b0\u7279\u70b9")),l.createElement("p",null,"\u4e0a\u8ff0\u8bb2\u7684\u6279\u91cf\u66f4\u65b0\u548c flushSync \uff0c\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\uff0cdispatch \u66f4\u65b0\u6548\u679c\u548c\u7c7b\u7ec4\u4ef6\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f useState \u6709\u4e00\u70b9\u503c\u5f97\u6ce8\u610f\uff0c\u5c31\u662f\u5f53\u8c03\u7528\u6539\u53d8 state \u7684\u51fd\u6570dispatch\uff0c\u5728\u672c\u6b21\u51fd\u6570\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d\uff0c\u662f\u83b7\u53d6\u4e0d\u5230\u6700\u65b0\u7684 state \u503c\u7684\uff0c\u628a\u4e0a\u8ff0demo \u5982\u4e0b\u8fd9\u4e48\u6539\uff1a"),l.createElement(c.Z,{code:"const [ number , setNumber ] = React.useState(0)\nconst handleClick = ()=>{\n    ReactDOM.flushSync(()=>{\n        setNumber(2) \n        console.log(number) \n    })\n    setNumber(1) \n    console.log(number)\n    setTimeout(()=>{\n        setNumber(3) \n        console.log(number)\n    })   \n}",lang:"js"}),l.createElement("p",null,l.createElement("strong",null,"\u7ed3\u679c\uff1a 0 0 0")),l.createElement("p",null,"\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u51fd\u6570\u7ec4\u4ef6\u66f4\u65b0\u5c31\u662f\u51fd\u6570\u7684\u6267\u884c\uff0c\u5728\u51fd\u6570\u4e00\u6b21\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u51fd\u6570\u5185\u90e8\u6240\u6709\u53d8\u91cf\u91cd\u65b0\u58f0\u660e\uff0c\u6240\u4ee5\u6539\u53d8\u7684 state \uff0c\u53ea\u6709\u5728\u4e0b\u4e00\u6b21\u51fd\u6570\u7ec4\u4ef6\u6267\u884c\u65f6\u624d\u4f1a\u88ab\u66f4\u65b0\u3002\u6240\u4ee5\u5728\u5982\u4e0a\u540c\u4e00\u4e2a\u51fd\u6570\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d\uff0cnumber \u4e00\u76f4\u4e3a0\uff0c\u65e0\u8bba\u600e\u4e48\u6253\u5370\uff0c\u90fd\u62ff\u4e0d\u5230\u6700\u65b0\u7684 state \u3002"),l.createElement("p",null,l.createElement("strong",null,"useState\u6ce8\u610f\u4e8b\u9879")),l.createElement("p",null,"\u5728\u4f7f\u7528 useState \u7684 dispatchAction \u66f4\u65b0 state \u7684\u65f6\u5019\uff0c\u8bb0\u5f97\u4e0d\u8981\u4f20\u5165\u76f8\u540c\u7684 state\uff0c\u8fd9\u6837\u4f1a\u4f7f\u89c6\u56fe\u4e0d\u66f4\u65b0\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e48\u5199\uff1a"),l.createElement(c.Z,{code:"export default function Index(){\n    const [ state  , dispatchState ] = useState({ name:'alien' })\n    const  handleClick = ()=>{ // \u70b9\u51fb\u6309\u94ae\uff0c\u89c6\u56fe\u6ca1\u6709\u66f4\u65b0\u3002\n        state.name = 'Alien'\n        dispatchState(state) // \u76f4\u63a5\u6539\u53d8 `state`\uff0c\u5728\u5185\u5b58\u4e2d\u6307\u5411\u7684\u5730\u5740\u76f8\u540c\u3002\n    }\n    return <div>\n         <span> { state.name }</span>\n        <button onClick={ handleClick }  >changeName++</button>\n    </div>\n}",lang:"js"}),l.createElement("p",null,"\u5982\u4e0a\u4f8b\u5b50\ud83c\udf30\u4e2d\uff0c\u5f53\u70b9\u51fb\u6309\u94ae\u540e\uff0c\u53d1\u73b0\u89c6\u56fe\u6ca1\u6709\u6539\u53d8\uff0c\u4e3a\u4ec0\u4e48\u4f1a\u9020\u6210\u8fd9\u4e2a\u539f\u56e0\u5462\uff1f"),l.createElement("p",null,"\u5728 useState \u7684 dispatchAction \u5904\u7406\u903b\u8f91\u4e2d\uff0c\u4f1a\u6d45\u6bd4\u8f83\u4e24\u6b21 state \uff0c\u53d1\u73b0 state \u76f8\u540c\uff0c\u4e0d\u4f1a\u5f00\u542f\u66f4\u65b0\u8c03\u5ea6\u4efb\u52a1\uff1b demo \u4e2d\u4e24\u6b21 state \u6307\u5411\u4e86\u76f8\u540c\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u6240\u4ee5\u9ed8\u8ba4\u4e3a state \u76f8\u7b49\uff0c\u5c31\u4e0d\u4f1a\u53d1\u751f\u89c6\u56fe\u66f4\u65b0\u4e86\u3002"),l.createElement("p",null,"\u89e3\u51b3\u95ee\u9898\uff1a \u628a\u4e0a\u8ff0\u7684 dispatchState \u6539\u6210 dispatchState(","{","...state","}",") \u6839\u672c\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u6d45\u62f7\u8d1d\u4e86\u5bf9\u8c61\uff0c\u91cd\u65b0\u7533\u8bf7\u4e86\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\u3002"),l.createElement("h3",{id:"usestate\u539f\u7406\u63ed\u79d8"},l.createElement(a.AnchorLink,{to:"#usestate\u539f\u7406\u63ed\u79d8","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"useState\u539f\u7406\u63ed\u79d8"),l.createElement("p",null,"\u5bf9\u4e8e useState \u539f\u7406\uff0c\u540e\u9762\u4f1a\u6709\u72ec\u7acb\u7684\u7bc7\u7ae0\u4ecb\u7ecd\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002"),l.createElement("p",null,l.createElement("strong",null,"\uff5c--------\u95ee\u4e0e\u7b54---------\uff5c")),l.createElement("p",null,"\u7c7b\u7ec4\u4ef6\u4e2d\u7684 ",l.createElement("code",null,"setState")," \u548c\u51fd\u6570\u7ec4\u4ef6\u4e2d\u7684 ",l.createElement("code",null,"useState")," \u6709\u4ec0\u4e48\u5f02\u540c\uff1f ",l.createElement("strong",null,"\u76f8\u540c\u70b9\uff1a")),l.createElement("ul",null,l.createElement("li",null,"\u9996\u5148\u4ece\u539f\u7406\u89d2\u5ea6\u51fa\u53d1\uff0csetState\u548c useState \u66f4\u65b0\u89c6\u56fe\uff0c\u5e95\u5c42\u90fd\u8c03\u7528\u4e86 scheduleUpdateOnFiber \u65b9\u6cd5\uff0c\u800c\u4e14\u4e8b\u4ef6\u9a71\u52a8\u60c5\u51b5\u4e0b\u90fd\u6709\u6279\u91cf\u66f4\u65b0\u89c4\u5219\u3002")),l.createElement("p",null,l.createElement("strong",null,"\u4e0d\u540c\u70b9")),l.createElement("ul",null,l.createElement("li",null,"\u5728\u4e0d\u662f pureComponent \u7ec4\u4ef6\u6a21\u5f0f\u4e0b\uff0c setState \u4e0d\u4f1a\u6d45\u6bd4\u8f83\u4e24\u6b21 state \u7684\u503c\uff0c\u53ea\u8981\u8c03\u7528 setState\uff0c\u5728\u6ca1\u6709\u5176\u4ed6\u4f18\u5316\u624b\u6bb5\u7684\u524d\u63d0\u4e0b\uff0c\u5c31\u4f1a\u6267\u884c\u66f4\u65b0\u3002\u4f46\u662f useState \u4e2d\u7684 dispatchAction \u4f1a\u9ed8\u8ba4\u6bd4\u8f83\u4e24\u6b21 state \u662f\u5426\u76f8\u540c\uff0c\u7136\u540e\u51b3\u5b9a\u662f\u5426\u66f4\u65b0\u7ec4\u4ef6\u3002"),l.createElement("li",null,"setState \u6709\u4e13\u95e8\u76d1\u542c state \u53d8\u5316\u7684\u56de\u8c03\u51fd\u6570 callback\uff0c\u53ef\u4ee5\u83b7\u53d6\u6700\u65b0state\uff1b\u4f46\u662f\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\uff0c\u53ea\u80fd\u901a\u8fc7 useEffect \u6765\u6267\u884c state \u53d8\u5316\u5f15\u8d77\u7684\u526f\u4f5c\u7528\u3002"),l.createElement("li",null,"setState \u5728\u5e95\u5c42\u5904\u7406\u903b\u8f91\u4e0a\u4e3b\u8981\u662f\u548c\u8001 state \u8fdb\u884c\u5408\u5e76\u5904\u7406\uff0c\u800c useState \u66f4\u503e\u5411\u4e8e\u91cd\u65b0\u8d4b\u503c\u3002")),l.createElement("p",null,l.createElement("strong",null,"\uff5c--------end---------\uff5c")),l.createElement("h2",{id:"\u56db-\u603b\u7ed3"},l.createElement(a.AnchorLink,{to:"#\u56db-\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},l.createElement("span",{className:"icon icon-link"})),"\u56db \u603b\u7ed3"),l.createElement("p",null,"\u4ece\u672c\u7ae0\u8282\u5b66\u5230\u4e86\u54ea\u4e9b\u77e5\u8bc6\uff1a"),l.createElement("ul",null,l.createElement("li",null,"1 setState\u7528\u6cd5\u8be6\u89e3\uff0c\u5e95\u5c42\u66f4\u65b0\u6d41\u7a0b\u3002"),l.createElement("li",null,"2 useState\u7528\u6cd5\u8be6\u89e3\uff0c\u6ce8\u610f\u4e8b\u9879\u3002"),l.createElement("li",null,"3 \u51e0\u79cd\u4e0d\u540c\u4f18\u5148\u7ea7\u7684\u66f4\u65b0\u4efb\u52a1\u3002"))))}));t["default"]=e=>{var t=l.useContext(a.context),n=t.demos;return l.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&a.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),l.createElement(s,{demos:n})}}}]);