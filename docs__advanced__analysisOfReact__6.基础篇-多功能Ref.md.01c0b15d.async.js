(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[960],{31229:function(e,n,t){"use strict";t.r(n);var r=t(67294),l=t(96089),c=t(65659),a=r.memo((e=>{e.demos;return r.createElement(r.Fragment,null,r.createElement("div",{className:"markdown"},r.createElement("h2",{id:"\u4e00-\u524d\u8a00"},r.createElement(l.AnchorLink,{to:"#\u4e00-\u524d\u8a00","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u4e00 \u524d\u8a00"),r.createElement("p",null,"\u5bf9\u4e8e Ref \u7406\u89e3\u4e0e\u4f7f\u7528\uff0c\u4e00\u4e9b\u540c\u5b66\u53ef\u80fd\u8fd8\u505c\u7559\u5728\u7528 Ref \u83b7\u53d6\u771f\u5b9e DOM \u5143\u7d20\u548c\u83b7\u53d6\u7c7b\u7ec4\u4ef6\u5b9e\u4f8b\u5c42\u9762\u4e0a\uff0c\u4f46\u5b9e\u9645 ref \u9664\u4e86\u8fd9\u4e24\u9879\u529f\u80fd\u4e4b\u5916\uff0c\u5728\u4f7f\u7528\u4e0a\u8fd8\u6709\u5f88\u591a\u5c0f\u6280\u5de7\u3002\u672c\u7ae0\u8282\uff0c\u6211\u4eec\u5c31\u4e00\u8d77\u6df1\u5165\u7814\u7a76\u4e00\u4e0b React Ref\uff0c\u63a2\u7d22 React Ref \u7684\u5965\u79d8\u3002"),r.createElement("p",null,"\u901a\u8fc7\u672c\u7ae0\u8282\u7684\u9605\u8bfb\uff0c\u4f60\u5c06\u6536\u83b7 Ref \u7684\u57fa\u672c\u4f7f\u7528\u548c\u8fdb\u9636\u7528\u6cd5\uff0c\u660e\u767d React \u5185\u90e8\u5982\u4f55\u5904\u7406Ref\uff0c\u4ee5\u53ca Ref \u7684\u539f\u7406\u3002"),r.createElement("h2",{id:"\u4e8c-ref\u57fa\u672c\u6982\u5ff5\u548c\u4f7f\u7528"},r.createElement(l.AnchorLink,{to:"#\u4e8c-ref\u57fa\u672c\u6982\u5ff5\u548c\u4f7f\u7528","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u4e8c ref\u57fa\u672c\u6982\u5ff5\u548c\u4f7f\u7528"),r.createElement("p",null,"\u5bf9\u4e8e Ref \uff0c\u6211\u8ba4\u4e3a\u5e94\u8be5\u5206\u6210\u4e24\u4e2a\u90e8\u5206\u53bb\u5206\u6790\uff0c\u7b2c\u4e00\u4e2a\u90e8\u5206\u662f ",r.createElement("strong",null,"Ref \u5bf9\u8c61\u7684\u521b\u5efa"),"\uff0c\u7b2c\u4e8c\u4e2a\u90e8\u5206\u662f ",r.createElement("strong",null,"React \u672c\u8eab\u5bf9Ref\u7684\u5904\u7406"),"\u3002\u4e24\u8005\u4e0d\u8981\u6df7\u4e3a\u4e00\u8c08\uff0c\u6240\u8c13 Ref \u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u5c31\u662f\u901a\u8fc7 React.createRef \u6216\u8005 React.useRef \u6765\u521b\u5efa\u4e00\u4e2a Ref \u539f\u59cb\u5bf9\u8c61\u3002\u800c React \u5bf9 Ref \u5904\u7406\uff0c\u4e3b\u8981\u6307\u7684\u662f\u5bf9\u4e8e\u6807\u7b7e\u4e2d ref \u5c5e\u6027\uff0cReact \u662f\u5982\u4f55\u5904\u7406\u4ee5\u53ca React \u8f6c\u53d1 Ref \u3002\u4e0b\u9762\u6765\u4ed4\u7ec6\u4ecb\u7ecd\u4e00\u4e0b\u3002"),r.createElement("h3",{id:"ref\u5bf9\u8c61\u521b\u5efa"},r.createElement(l.AnchorLink,{to:"#ref\u5bf9\u8c61\u521b\u5efa","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"Ref\u5bf9\u8c61\u521b\u5efa"),r.createElement("p",null,r.createElement("strong",null,"\u4ec0\u4e48\u662f ref \u5bf9\u8c61"),"\uff0c\u6240\u8c13 ref \u5bf9\u8c61\u5c31\u662f\u7528 ",r.createElement("code",null,"createRef")," \u6216\u8005 ",r.createElement("code",null,"useRef")," \u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\uff0c\u4e00\u4e2a\u6807\u51c6\u7684 ref \u5bf9\u8c61\u5e94\u8be5\u662f\u5982\u4e0b\u7684\u6837\u5b50\uff1a"),r.createElement(c.Z,{code:"{\n    current:null , // current\u6307\u5411ref\u5bf9\u8c61\u83b7\u53d6\u5230\u7684\u5b9e\u9645\u5185\u5bb9\uff0c\u53ef\u4ee5\u662fdom\u5143\u7d20\uff0c\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u6216\u8005\u5176\u4ed6\u3002\n}",lang:"js"}),r.createElement("p",null,"React \u63d0\u4f9b\u4e24\u79cd\u65b9\u6cd5\u521b\u5efa Ref \u5bf9\u8c61\uff0c"),r.createElement("p",null,r.createElement("strong",null,"\u2460\u7c7b\u7ec4\u4ef6React.createRef")),r.createElement("p",null,"\u7b2c\u4e00\u79cd\u65b9\u5f0f\u901a\u8fc7 React.createRef \u521b\u5efa\u4e00\u4e2a ref \u5bf9\u8c61\u3002"),r.createElement(c.Z,{code:"class Index extends React.Component{\n    constructor(props){\n       super(props)\n       this.currentDom = React.createRef(null)\n    }\n    componentDidMount(){\n        console.log(this.currentDom)\n    }\n    render= () => <div ref={ this.currentDom } >ref\u5bf9\u8c61\u6a21\u5f0f\u83b7\u53d6\u5143\u7d20\u6216\u7ec4\u4ef6</div>\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6253\u5370")),r.createElement("p",null,r.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a03858d0d9447ac9d29f3faa2fc1851~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref.jpg"})),r.createElement("p",null,"React.createRef \u7684\u5e95\u5c42\u903b\u8f91\u5f88\u7b80\u5355\u3002\u4e0b\u9762\u4e00\u8d77\u6765\u770b\u4e00\u4e0b\uff1a"),r.createElement("blockquote",null,r.createElement("p",null,"react/src/ReactCreateRef.js")),r.createElement(c.Z,{code:"export function createRef() {\n  const refObject = {\n    current: null,\n  }\n  return refObject;\n}",lang:"js"}),r.createElement("p",null,"createRef \u53ea\u505a\u4e86\u4e00\u4ef6\u4e8b\uff0c\u5c31\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5bf9\u8c61\u4e0a\u7684 current \u5c5e\u6027\uff0c\u7528\u4e8e\u4fdd\u5b58\u901a\u8fc7 ref \u83b7\u53d6\u7684 DOM \u5143\u7d20\uff0c\u7ec4\u4ef6\u5b9e\u4f8b\u7b49\u3002 createRef \u4e00\u822c\u7528\u4e8e\u7c7b\u7ec4\u4ef6\u521b\u5efa Ref \u5bf9\u8c61\uff0c\u53ef\u4ee5\u5c06 Ref \u5bf9\u8c61\u7ed1\u5b9a\u5728\u7c7b\u7ec4\u4ef6\u5b9e\u4f8b\u4e0a\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c Ref\u3002"),r.createElement("p",null,"\u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\u4f7f\u7528 createRef\uff0c\u5426\u5219\u4f1a\u9020\u6210 Ref \u5bf9\u8c61\u5185\u5bb9\u4e22\u5931\u7b49\u60c5\u51b5\u3002"),r.createElement("p",null,r.createElement("strong",null,"\u2461\u51fd\u6570\u7ec4\u4ef6 useRef")),r.createElement("p",null,"\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5c31\u662f\u51fd\u6570\u7ec4\u4ef6\u521b\u5efa Ref \uff0c\u53ef\u4ee5\u7528 hooks \u4e2d\u7684 useRef \u6765\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c\u3002"),r.createElement(c.Z,{code:"export default function Index(){\n    const currentDom = React.useRef(null)\n    React.useEffect(()=>{\n        console.log( currentDom.current ) // div\n    },[])\n    return  <div ref={ currentDom } >ref\u5bf9\u8c61\u6a21\u5f0f\u83b7\u53d6\u5143\u7d20\u6216\u7ec4\u4ef6</div>\n}",lang:"js"}),r.createElement("p",null,"useRef \u5e95\u5c42\u903b\u8f91\u662f\u548c createRef \u5dee\u4e0d\u591a\uff0c\u5c31\u662f ref \u4fdd\u5b58\u4f4d\u7f6e\u4e0d\u76f8\u540c\uff0c\u7c7b\u7ec4\u4ef6\u6709\u4e00\u4e2a\u5b9e\u4f8b instance \u80fd\u591f\u7ef4\u62a4\u50cf ref \u8fd9\u79cd\u4fe1\u606f\uff0c\u4f46\u662f\u7531\u4e8e\u51fd\u6570\u7ec4\u4ef6\u6bcf\u6b21\u66f4\u65b0\u90fd\u662f\u4e00\u6b21\u65b0\u7684\u5f00\u59cb\uff0c\u6240\u6709\u53d8\u91cf\u91cd\u65b0\u58f0\u660e\uff0c\u6240\u4ee5 useRef \u4e0d\u80fd\u50cf createRef \u628a ref \u5bf9\u8c61\u76f4\u63a5\u66b4\u9732\u51fa\u53bb\uff0c\u5982\u679c\u8fd9\u6837\u6bcf\u4e00\u6b21\u51fd\u6570\u7ec4\u4ef6\u6267\u884c\u5c31\u4f1a\u91cd\u65b0\u58f0\u660e Ref\uff0c\u6b64\u65f6 ref \u5c31\u4f1a\u968f\u7740\u51fd\u6570\u7ec4\u4ef6\u6267\u884c\u88ab\u91cd\u7f6e\uff0c\u8fd9\u5c31\u89e3\u91ca\u4e86\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u7528 createRef \u7684\u539f\u56e0\u3002"),r.createElement("p",null,"\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0chooks \u548c\u51fd\u6570\u7ec4\u4ef6\u5bf9\u5e94\u7684 fiber \u5bf9\u8c61\u5efa\u7acb\u8d77\u5173\u8054\uff0c\u5c06 useRef \u4ea7\u751f\u7684 ref \u5bf9\u8c61\u6302\u5230\u51fd\u6570\u7ec4\u4ef6\u5bf9\u5e94\u7684 fiber \u4e0a\uff0c\u51fd\u6570\u7ec4\u4ef6\u6bcf\u6b21\u6267\u884c\uff0c\u53ea\u8981\u7ec4\u4ef6\u4e0d\u88ab\u9500\u6bc1\uff0c\u51fd\u6570\u7ec4\u4ef6\u5bf9\u5e94\u7684 fiber \u5bf9\u8c61\u4e00\u76f4\u5b58\u5728\uff0c\u6240\u4ee5 ref \u7b49\u4fe1\u606f\u5c31\u4f1a\u88ab\u4fdd\u5b58\u4e0b\u6765\u3002\u5bf9\u4e8e hooks \u539f\u7406\uff0c\u540e\u7eed\u7ae0\u8282\u4f1a\u6709\u5bf9\u5e94\u7684\u4ecb\u7ecd\u3002"),r.createElement("h3",{id:"react\u5bf9ref\u5c5e\u6027\u7684\u5904\u7406-\u6807\u8bb0ref"},r.createElement(l.AnchorLink,{to:"#react\u5bf9ref\u5c5e\u6027\u7684\u5904\u7406-\u6807\u8bb0ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"React\u5bf9Ref\u5c5e\u6027\u7684\u5904\u7406-\u6807\u8bb0ref"),r.createElement("p",null,"\u4e0a\u9762\u4e2d\u91cd\u70b9\u4ecb\u7ecd\u4e86 Ref \u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u63a5\u4e0b\u6765\u4e00\u8d77\u5206\u6790\u4e00\u4e0b React \u5bf9\u4e8e ref \u6807\u7b7e\u5c5e\u6027\u7684\u5904\u7406\u903b\u8f91\u3002"),r.createElement("p",null,"\u9996\u5148\u660e\u786e\u4e00\u4e2a\u95ee\u9898\u662f ",r.createElement("strong",null,"DOM \u5143\u7d20"),"\u548c",r.createElement("strong",null,"\u7ec4\u4ef6\u5b9e\u4f8b")," \u5fc5\u987b\u7528 ref \u5bf9\u8c61\u83b7\u53d6\u5417\uff1f\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0cReact \u7c7b\u7ec4\u4ef6\u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u6cd5\u83b7\u53d6 ",r.createElement("strong",null,"DOM \u5143\u7d20"),"\u548c",r.createElement("strong",null,"\u7ec4\u4ef6\u5b9e\u4f8b"),"\uff0c\u8bf4\u767d\u4e86\u5c31\u662f React \u5bf9\u6807\u7b7e\u91cc\u9762 ref \u5c5e\u6027\u7684\u5904\u7406\u903b\u8f91\u591a\u6837\u5316\u3002"),r.createElement("h4",{id:"\u7c7b\u7ec4\u4ef6\u83b7\u53d6-ref-\u4e09\u79cd\u65b9\u5f0f"},r.createElement(l.AnchorLink,{to:"#\u7c7b\u7ec4\u4ef6\u83b7\u53d6-ref-\u4e09\u79cd\u65b9\u5f0f","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u7c7b\u7ec4\u4ef6\u83b7\u53d6 Ref \u4e09\u79cd\u65b9\u5f0f"),r.createElement("ul",null,r.createElement("li",null,r.createElement("strong",null,"\u2460 Ref\u5c5e\u6027\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002"))),r.createElement(c.Z,{code:'/* \u7c7b\u7ec4\u4ef6 */\nclass Children extends Component{  \n    render=()=><div>hello,world</div>\n}\n/* TODO:  Ref\u5c5e\u6027\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32 */\nexport default class Index extends React.Component{\n    componentDidMount(){\n       console.log(this.refs)\n    }\n    render=()=> <div>\n        <div ref="currentDom"  >\u5b57\u7b26\u4e32\u6a21\u5f0f\u83b7\u53d6\u5143\u7d20\u6216\u7ec4\u4ef6</div>\n        <Children ref="currentComInstance"  />\n    </div>\n}',lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6253\u5370")),r.createElement("p",null,r.createElement("img",{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ca7efcd73fe429aa83bd91f068c5508~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref1.jpg"})),r.createElement("p",null,"\u5982\u4e0a\u9762\u4ee3\u7801\u7247\u6bb5\uff0c\u7528\u4e00\u4e2a\u5b57\u7b26\u4e32 ref \u6807\u8bb0\u4e00\u4e2a DOM \u5143\u7d20\uff0c\u4e00\u4e2a\u7c7b\u7ec4\u4ef6(\u51fd\u6570\u7ec4\u4ef6\u6ca1\u6709\u5b9e\u4f8b\uff0c\u4e0d\u80fd\u88ab Ref \u6807\u8bb0)\u3002React \u5728\u5e95\u5c42\u903b\u8f91\uff0c\u4f1a\u5224\u65ad\u7c7b\u578b\uff0c\u5982\u679c\u662f DOM \u5143\u7d20\uff0c\u4f1a\u628a\u771f\u5b9e DOM \u7ed1\u5b9a\u5728\u7ec4\u4ef6 this.refs (\u7ec4\u4ef6\u5b9e\u4f8b\u4e0b\u7684 refs )\u5c5e\u6027\u4e0a\uff0c\u5982\u679c\u662f\u7c7b\u7ec4\u4ef6\uff0c\u4f1a\u628a\u5b50\u7ec4\u4ef6\u7684\u5b9e\u4f8b\u7ed1\u5b9a\u5728 this.refs \u4e0a\u3002"),r.createElement("ul",null,r.createElement("li",null,r.createElement("strong",null,"\u2461 Ref \u5c5e\u6027\u662f\u4e00\u4e2a\u51fd\u6570\u3002"))),r.createElement(c.Z,{code:"class Children extends React.Component{  \n    render=()=><div>hello,world</div>\n}\n/* TODO: Ref\u5c5e\u6027\u662f\u4e00\u4e2a\u51fd\u6570 */\nexport default class Index extends React.Component{\n    currentDom = null\n    currentComponentInstance = null\n    componentDidMount(){\n        console.log(this.currentDom)\n        console.log(this.currentComponentInstance)\n    }\n    render=()=> <div>\n        <div ref={(node)=> this.currentDom = node }  >Ref\u6a21\u5f0f\u83b7\u53d6\u5143\u7d20\u6216\u7ec4\u4ef6</div>\n        <Children ref={(node) => this.currentComponentInstance = node  }  />\n    </div>\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6253\u5370")),r.createElement("p",null,r.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/74ba71b6c4f5456eaf7cd46e51598fa4~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref2.jpg"})),r.createElement("p",null,"\u5982\u4e0a\u4ee3\u7801\u7247\u6bb5\uff0c\u5f53\u7528\u4e00\u4e2a\u51fd\u6570\u6765\u6807\u8bb0 Ref \u7684\u65f6\u5019\uff0c\u5c06\u4f5c\u4e3a callback \u5f62\u5f0f\uff0c\u7b49\u5230\u771f\u5b9e DOM \u521b\u5efa\u9636\u6bb5\uff0c\u6267\u884c callback \uff0c\u83b7\u53d6\u7684 DOM \u5143\u7d20\u6216\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u5c06\u4ee5\u56de\u8c03\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u5f62\u5f0f\u4f20\u5165\uff0c\u6240\u4ee5\u53ef\u4ee5\u50cf\u4e0a\u8ff0\u4ee3\u7801\u7247\u6bb5\u4e2d\uff0c\u7528\u7ec4\u4ef6\u5b9e\u4f8b\u4e0b\u7684\u5c5e\u6027 ",r.createElement("code",null,"currentDom"),"\u548c ",r.createElement("code",null,"currentComponentInstance")," \u6765\u63a5\u6536\u771f\u5b9e DOM \u548c\u7ec4\u4ef6\u5b9e\u4f8b\u3002"),r.createElement("ul",null,r.createElement("li",null,r.createElement("strong",null,"\u2462 Ref\u5c5e\u6027\u662f\u4e00\u4e2aref\u5bf9\u8c61\u3002"))),r.createElement("p",null,"\u7b2c\u4e09\u79cd\u65b9\u5f0f\u5c31\u662f\u4e0a\u8ff0\u901a\u8fc7 ref \u5bf9\u8c61\u65b9\u5f0f\u83b7\u53d6\u3002\u4e0a\u9762\u5df2\u7ecf\u4ecb\u7ecd\u4e86\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u76f4\u63a5\u770b\u4e0b\u9762\u3002"),r.createElement(c.Z,{code:"class Children extends React.Component{  \n    render=()=><div>hello,world</div>\n}\nexport default class Index extends React.Component{\n    currentDom = React.createRef(null)\n    currentComponentInstance = React.createRef(null)\n    componentDidMount(){\n        console.log(this.currentDom)\n        console.log(this.currentComponentInstance)\n    }\n    render=()=> <div>\n         <div ref={ this.currentDom }  >Ref\u5bf9\u8c61\u6a21\u5f0f\u83b7\u53d6\u5143\u7d20\u6216\u7ec4\u4ef6</div>\n        <Children ref={ this.currentComponentInstance }  />\n   </div>\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6253\u5370")),r.createElement("p",null,r.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/796e66d30ee84a62867fe264c5b5eca6~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref3.jpg"})),r.createElement("p",null,"\u603b\u7ed3: \u5927\u5bb6\u8bf7\u8bb0\u4f4f\u4e09\u79cd\u83b7\u53d6 ref \u7684\u65b9\u5f0f\u3002"),r.createElement("h2",{id:"\u4e09-ref\u9ad8\u9636\u7528\u6cd5"},r.createElement(l.AnchorLink,{to:"#\u4e09-ref\u9ad8\u9636\u7528\u6cd5","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u4e09 ref\u9ad8\u9636\u7528\u6cd5"),r.createElement("p",null,"\u901a\u8fc7\u4e0a\u8ff0\u4e3b\u8981\u4ecb\u7ecd\u4e86 ref \u7684\u57fa\u672c\u7528\u6cd5\uff0c\u9664\u4e86\u4e0a\u8ff0\u529f\u80fd\u4e4b\u5916\uff0cref \u6d3e\u751f\u51fa\u4e00\u4e9b\u5176\u4ed6\u7684\u9ad8\u7ea7\u7528\u6cd5\uff0c\u80fd\u591f\u89e3\u51b3\u4e00\u4e9b\u7279\u6b8a\u573a\u666f\u4e0b\u7684\u95ee\u9898\uff0c\u8fd9\u4e9b\u7528\u6cd5\u53ef\u4ee5\u4f7f\u9879\u76ee\u4e2d\u5199\u7684 React \u66f4\u52a0\u7075\u6d3b\u591a\u53d8\u3002"),r.createElement("h3",{id:"1-forwardref-\u8f6c\u53d1-ref"},r.createElement(l.AnchorLink,{to:"#1-forwardref-\u8f6c\u53d1-ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"1 forwardRef \u8f6c\u53d1 Ref"),r.createElement("p",null,"forwardRef \u7684\u521d\u8877\u5c31\u662f\u89e3\u51b3 ref \u4e0d\u80fd\u8de8\u5c42\u7ea7\u6355\u83b7\u548c\u4f20\u9012\u7684\u95ee\u9898\u3002 forwardRef \u63a5\u53d7\u4e86\u7236\u7ea7\u5143\u7d20\u6807\u8bb0\u7684 ref \u4fe1\u606f\uff0c\u5e76\u628a\u5b83\u8f6c\u53d1\u4e0b\u53bb\uff0c\u4f7f\u5f97\u5b50\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7 props \u6765\u63a5\u53d7\u5230\u4e0a\u4e00\u5c42\u7ea7\u6216\u8005\u662f\u66f4\u4e0a\u5c42\u7ea7\u7684ref\uff0c\u5927\u5bb6\u53ef\u80fd\u5bf9\u6211\u8fd9\u53e5\u8bdd\u4e0d\u662f\u5f88\u7406\u89e3\uff0c\u4e0d\u8fc7\u6ca1\u5173\u7cfb\uff0c\u4e0b\u9762\u6765\u4ece\u5177\u4f53\u573a\u666f\u4e2d\u5206\u6790 forwardRef \u7684\u771f\u6b63\u7528\u9014\u3002"),r.createElement("h4",{id:"-\u573a\u666f\u4e00\u8de8\u5c42\u7ea7\u83b7\u53d6"},r.createElement(l.AnchorLink,{to:"#-\u573a\u666f\u4e00\u8de8\u5c42\u7ea7\u83b7\u53d6","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u2460 \u573a\u666f\u4e00\uff1a\u8de8\u5c42\u7ea7\u83b7\u53d6"),r.createElement("p",null,"\u6bd4\u5982\u60f3\u8981\u901a\u8fc7\u6807\u8bb0\u5b50\u7ec4\u4ef6 ref \uff0c\u6765\u83b7\u53d6\u5b59\u7ec4\u4ef6\u7684\u67d0\u4e00 DOM \u5143\u7d20\uff0c\u6216\u8005\u662f\u7ec4\u4ef6\u5b9e\u4f8b\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"\u573a\u666f\uff1a\u60f3\u8981\u5728 GrandFather \u7ec4\u4ef6\u901a\u8fc7\u6807\u8bb0 ref \uff0c\u6765\u83b7\u53d6\u5b59\u7ec4\u4ef6 Son \u7684\u7ec4\u4ef6\u5b9e\u4f8b\u3002")),r.createElement(c.Z,{code:"// \u5b59\u7ec4\u4ef6\nfunction Son (props){\n    const { grandRef } = props\n    return <div>\n        <div> i am alien </div>\n        <span ref={grandRef} >\u8fd9\u4e2a\u662f\u60f3\u8981\u83b7\u53d6\u5143\u7d20</span>\n    </div>\n}\n// \u7236\u7ec4\u4ef6\nclass Father extends React.Component{\n    constructor(props){\n        super(props)\n    }\n    render(){\n        return <div>\n            <Son grandRef={this.props.grandRef}  />\n        </div>\n    }\n}\nconst NewFather = React.forwardRef((props,ref)=> <Father grandRef={ref}  {...props} />)\n// \u7237\u7ec4\u4ef6\nclass GrandFather extends React.Component{\n    constructor(props){\n        super(props)\n    }\n    node = null \n    componentDidMount(){\n        console.log(this.node) // span #text \u8fd9\u4e2a\u662f\u60f3\u8981\u83b7\u53d6\u5143\u7d20\n    }\n    render(){\n        return <div>\n            <NewFather ref={(node)=> this.node = node } />\n        </div>\n    }\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6548\u679c")),r.createElement("p",null,r.createElement("img",{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a2cd13003af4b5880b0bee19973fd44~tplv-k3u1fbpfcp-watermark.awebp",alt:"forwaedRef.jpg"})),r.createElement("p",null,"\u4e0a\u8ff0\u6240\u793a\uff0cforwardRef \u628a ref \u53d8\u6210\u4e86\u53ef\u4ee5\u901a\u8fc7 props \u4f20\u9012\u548c\u8f6c\u53d1\u3002"),r.createElement("h4",{id:"-\u573a\u666f\u4e8c\u5408\u5e76\u8f6c\u53d1ref"},r.createElement(l.AnchorLink,{to:"#-\u573a\u666f\u4e8c\u5408\u5e76\u8f6c\u53d1ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u2461 \u573a\u666f\u4e8c:\u5408\u5e76\u8f6c\u53d1ref"),r.createElement("p",null,"\u901a\u8fc7 forwardRef \u8f6c\u53d1\u7684 ref \u4e0d\u8981\u7406\u89e3\u4e3a\u53ea\u80fd\u7528\u6765\u76f4\u63a5\u83b7\u53d6\u7ec4\u4ef6\u5b9e\u4f8b\uff0cDOM \u5143\u7d20\uff0c\u4e5f\u53ef\u4ee5\u7528\u6765\u4f20\u9012\u5408\u5e76\u4e4b\u540e\u7684\u81ea\u5b9a\u4e49\u7684 ref \uff0c\u53ef\u80fd\u8fd9\u4e48\u8bf4\uff0c\u6709\u4e9b\u540c\u5b66\u6ca1\u6709\u660e\u767d\uff0c\u4e0d\u8fc7\u4e0d\u8981\u7d27\uff0c\u4e0b\u9762\u6211\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"\u573a\u666f\uff1a\u60f3\u901a\u8fc7Home\u7ed1\u5b9aref\uff0c\u6765\u83b7\u53d6\u5b50\u7ec4\u4ef6Index\u7684\u5b9e\u4f8bindex\uff0cdom\u5143\u7d20button\uff0c\u4ee5\u53ca\u5b59\u7ec4\u4ef6Form\u7684\u5b9e\u4f8b")),r.createElement(c.Z,{code:"// \u8868\u5355\u7ec4\u4ef6\nclass Form extends React.Component{\n    render(){\n       return <div>{...}</div>\n    }\n}\n// index \u7ec4\u4ef6\nclass Index extends React.Component{ \n    componentDidMount(){\n        const { forwardRef } = this.props\n        forwardRef.current={\n            form:this.form,      // \u7ed9form\u7ec4\u4ef6\u5b9e\u4f8b \uff0c\u7ed1\u5b9a\u7ed9 ref form\u5c5e\u6027 \n            index:this,          // \u7ed9index\u7ec4\u4ef6\u5b9e\u4f8b \uff0c\u7ed1\u5b9a\u7ed9 ref index\u5c5e\u6027 \n            button:this.button,  // \u7ed9button dom \u5143\u7d20\uff0c\u7ed1\u5b9a\u7ed9 ref button\u5c5e\u6027 \n        }\n    }\n    form = null\n    button = null\n    render(){\n        return <div   > \n          <button ref={(button)=> this.button = button }  >\u70b9\u51fb</button>\n          <Form  ref={(form) => this.form = form }  />  \n      </div>\n    }\n}\nconst ForwardRefIndex = React.forwardRef(( props,ref )=><Index  {...props} forwardRef={ref}  />)\n// home \u7ec4\u4ef6\nexport default function Home(){\n    const ref = useRef(null)\n     useEffect(()=>{\n         console.log(ref.current)\n     },[])\n    return <ForwardRefIndex ref={ref} />\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6548\u679c")),r.createElement("p",null,r.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae1f89a15dea4e55b1de6c8f313c0069~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref4.jpg"})),r.createElement("p",null,"\u5982\u4e0a\u4ee3\u7801\u6240\u793a\uff0c\u6d41\u7a0b\u4e3b\u8981\u5206\u4e3a\u51e0\u4e2a\u65b9\u9762\uff1a"),r.createElement("ul",null,r.createElement("li",null,"1 \u901a\u8fc7 useRef \u521b\u5efa\u4e00\u4e2a ref \u5bf9\u8c61\uff0c\u901a\u8fc7 forwardRef \u5c06\u5f53\u524d ref \u5bf9\u8c61\u4f20\u9012\u7ed9\u5b50\u7ec4\u4ef6\u3002"),r.createElement("li",null,"2 \u5411 Home \u7ec4\u4ef6\u4f20\u9012\u7684 ref \u5bf9\u8c61\u4e0a\uff0c\u7ed1\u5b9a form \u5b59\u7ec4\u4ef6\u5b9e\u4f8b\uff0cindex \u5b50\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u548c button DOM \u5143\u7d20\u3002")),r.createElement("p",null,r.createElement("code",null,"forwardRef")," \u8ba9 ref \u53ef\u4ee5\u901a\u8fc7 props \u4f20\u9012\uff0c\u90a3\u4e48\u5982\u679c\u7528 ",r.createElement("strong",null,"ref \u5bf9\u8c61"),"\u6807\u8bb0\u7684 ref \uff0c\u90a3\u4e48 ref \u5bf9\u8c61\u5c31\u53ef\u4ee5\u901a\u8fc7 props \u7684\u5f62\u5f0f\uff0c\u63d0\u4f9b\u7ed9\u5b50\u5b59\u7ec4\u4ef6\u6d88\u8d39\uff0c\u5f53\u7136\u5b50\u5b59\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u6539\u53d8 ref \u5bf9\u8c61\u91cc\u9762\u7684\u5c5e\u6027\uff0c\u6216\u8005\u50cf\u5982\u4e0a\u4ee3\u7801\u4e2d\u8d4b\u4e88\u65b0\u7684\u5c5e\u6027\uff0c\u8fd9\u79cd forwardref + ref \u6a21\u5f0f\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u6253\u7834\u4e86 React \u5355\u5411\u6570\u636e\u6d41\u52a8\u7684\u539f\u5219\u3002\u5f53\u7136\u7ed1\u5b9a\u5728 ref \u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\uff0c\u4e0d\u9650\u4e8e\u7ec4\u4ef6\u5b9e\u4f8b\u6216\u8005 DOM \u5143\u7d20\uff0c\u4e5f\u53ef\u4ee5\u662f\u5c5e\u6027\u503c\u6216\u65b9\u6cd5\u3002"),r.createElement("h4",{id:"-\u573a\u666f\u4e09\u9ad8\u9636\u7ec4\u4ef6\u8f6c\u53d1"},r.createElement(l.AnchorLink,{to:"#-\u573a\u666f\u4e09\u9ad8\u9636\u7ec4\u4ef6\u8f6c\u53d1","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u2462 \u573a\u666f\u4e09\uff1a\u9ad8\u9636\u7ec4\u4ef6\u8f6c\u53d1"),r.createElement("p",null,"\u5982\u679c\u901a\u8fc7\u9ad8\u9636\u7ec4\u4ef6\u5305\u88f9\u4e00\u4e2a\u539f\u59cb\u7c7b\u7ec4\u4ef6\uff0c\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u9ad8\u9636\u7ec4\u4ef6 HOC \u6ca1\u6709\u5904\u7406 ref \uff0c\u90a3\u4e48\u7531\u4e8e\u9ad8\u9636\u7ec4\u4ef6\u672c\u8eab\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7ec4\u4ef6\uff0c\u6240\u4ee5\u5f53\u4f7f\u7528 HOC \u5305\u88c5\u540e\u7ec4\u4ef6\u7684\u65f6\u5019\uff0c\u6807\u8bb0\u7684 ref \u4f1a\u6307\u5411 HOC \u8fd4\u56de\u7684\u7ec4\u4ef6\uff0c\u800c\u5e76\u4e0d\u662f HOC \u5305\u88f9\u7684\u539f\u59cb\u7c7b\u7ec4\u4ef6\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cforwardRef \u53ef\u4ee5\u5bf9 HOC \u505a\u4e00\u5c42\u5904\u7406\u3002"),r.createElement(c.Z,{code:"function HOC(Component){\n  class Wrap extends React.Component{\n     render(){\n        const { forwardedRef ,...otherprops  } = this.props\n        return <Component ref={forwardedRef}  {...otherprops}  />\n     }\n  }\n  return  React.forwardRef((props,ref)=> <Wrap forwardedRef={ref} {...props} /> ) \n}\nclass Index extends React.Component{\n  render(){\n    return <div>hello,world</div>\n  }\n}\nconst HocIndex =  HOC(Index)\nexport default ()=>{\n  const node = useRef(null)\n  useEffect(()=>{\n    console.log(node.current)  /* Index \u7ec4\u4ef6\u5b9e\u4f8b  */ \n  },[])\n  return <div><HocIndex ref={node}  /></div>\n}",lang:"js"}),r.createElement("p",null,"\u7ecf\u8fc7 forwardRef \u5904\u7406\u540e\u7684 HOC \uff0c\u5c31\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u5230 Index \u7ec4\u4ef6\u5b9e\u4f8b\u4e86\u3002"),r.createElement("h3",{id:"2-ref\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"},r.createElement(l.AnchorLink,{to:"#2-ref\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"2 ref\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1"),r.createElement("p",null,"\u5982\u679c\u6709\u79cd\u573a\u666f\u4e0d\u60f3\u901a\u8fc7\u7236\u7ec4\u4ef6 render \u6539\u53d8 props \u7684\u65b9\u5f0f\uff0c\u6765\u89e6\u53d1\u5b50\u7ec4\u4ef6\u7684\u66f4\u65b0\uff0c\u4e5f\u5c31\u662f\u5b50\u7ec4\u4ef6\u901a\u8fc7 state \u5355\u72ec\u7ba1\u7406\u6570\u636e\u5c42\uff0c\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\u7236\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7 ref \u6a21\u5f0f\u6807\u8bb0\u5b50\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u4ece\u800c\u64cd\u7eb5\u5b50\u7ec4\u4ef6\u65b9\u6cd5\uff0c\u8fd9\u79cd\u60c5\u51b5\u901a\u5e38\u53d1\u751f\u5728\u4e00\u4e9b",r.createElement("strong",null,"\u6570\u636e\u5c42\u6258\u7ba1"),"\u7684\u7ec4\u4ef6\u4e0a\uff0c\u6bd4\u5982 ",r.createElement("code",null,"<Form/>")," \u8868\u5355\uff0c\u7ecf\u5178\u6848\u4f8b\u53ef\u4ee5\u53c2\u8003 antd \u91cc\u9762\u7684 form \u8868\u5355\uff0c\u66b4\u9732\u51fa\u5bf9\u5916\u7684 ",r.createElement("code",null,"resetFields")," \uff0c ",r.createElement("code",null,"setFieldsValue")," \u7b49\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u8868\u5355\u5b9e\u4f8b\u8c03\u7528\u8fd9\u4e9b API \u3002"),r.createElement("h4",{id:"-\u7c7b\u7ec4\u4ef6-ref"},r.createElement(l.AnchorLink,{to:"#-\u7c7b\u7ec4\u4ef6-ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u2460 \u7c7b\u7ec4\u4ef6 ref"),r.createElement("p",null,"\u5bf9\u4e8e\u7c7b\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7 ref \u76f4\u63a5\u83b7\u53d6\u7ec4\u4ef6\u5b9e\u4f8b\uff0c\u5b9e\u73b0\u7ec4\u4ef6\u901a\u4fe1\u3002"),r.createElement(c.Z,{code:'/* \u5b50\u7ec4\u4ef6 */\nclass Son extends React.PureComponent{\n    state={\n       fatherMes:\'\',\n       sonMes:\'\'\n    }\n    fatherSay=(fatherMes)=> this.setState({ fatherMes  }) /* \u63d0\u4f9b\u7ed9\u7236\u7ec4\u4ef6\u7684API */\n    render(){\n        const { fatherMes, sonMes } = this.state\n        return <div className="sonbox" >\n            <div className="title" >\u5b50\u7ec4\u4ef6</div>\n            <p>\u7236\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{ fatherMes }</p>\n            <div className="label" >\u5bf9\u7236\u7ec4\u4ef6\u8bf4</div> <input  onChange={(e)=>this.setState({ sonMes:e.target.value })}   className="input"  /> \n            <button className="searchbtn" onClick={ ()=> this.props.toFather(sonMes) }  >to father</button>\n        </div>\n    }\n}\n/* \u7236\u7ec4\u4ef6 */\nexport default function Father(){\n    const [ sonMes , setSonMes ] = React.useState(\'\') \n    const sonInstance = React.useRef(null) /* \u7528\u6765\u83b7\u53d6\u5b50\u7ec4\u4ef6\u5b9e\u4f8b */\n    const [ fatherMes , setFatherMes ] = React.useState(\'\')\n    const toSon =()=> sonInstance.current.fatherSay(fatherMes) /* \u8c03\u7528\u5b50\u7ec4\u4ef6\u5b9e\u4f8b\u65b9\u6cd5\uff0c\u6539\u53d8\u5b50\u7ec4\u4ef6state */\n    return <div className="box" >\n        <div className="title" >\u7236\u7ec4\u4ef6</div>\n        <p>\u5b50\u7ec4\u4ef6\u5bf9\u6211\u8bf4\uff1a{ sonMes }</p>\n        <div className="label" >\u5bf9\u5b50\u7ec4\u4ef6\u8bf4</div> <input onChange={ (e) => setFatherMes(e.target.value) }  className="input"  /> \n        <button className="searchbtn"  onClick={toSon}  >to son</button>\n        <Son ref={sonInstance} toFather={setSonMes} />\n    </div>\n}',lang:"js"}),r.createElement("p",null,"\u6d41\u7a0b\u5206\u6790\uff1a"),r.createElement("ul",null,r.createElement("li",null,"1 \u5b50\u7ec4\u4ef6\u66b4\u9732\u65b9\u6cd5 fatherSay \u4f9b\u7236\u7ec4\u4ef6\u4f7f\u7528\uff0c\u7236\u7ec4\u4ef6\u901a\u8fc7\u8c03\u7528\u65b9\u6cd5\u53ef\u4ee5\u8bbe\u7f6e\u5b50\u7ec4\u4ef6\u5c55\u793a\u5185\u5bb9\u3002"),r.createElement("li",null,"2 \u7236\u7ec4\u4ef6\u63d0\u4f9b\u7ed9\u5b50\u7ec4\u4ef6 toFather\uff0c\u5b50\u7ec4\u4ef6\u8c03\u7528\uff0c\u6539\u53d8\u7236\u7ec4\u4ef6\u5c55\u793a\u5185\u5bb9\uff0c\u5b9e\u73b0\u7236 <-> \u5b50 \u53cc\u5411\u901a\u4fe1\u3002")),r.createElement("p",null,r.createElement("strong",null,"\u6548\u679c")),r.createElement("p",null,r.createElement("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6960ed2af84c46b1a143a4026b33a421~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref5.gif"})),r.createElement("h4",{id:"-\u51fd\u6570\u7ec4\u4ef6-forwardref--useimperativehandle"},r.createElement(l.AnchorLink,{to:"#-\u51fd\u6570\u7ec4\u4ef6-forwardref--useimperativehandle","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u2461 \u51fd\u6570\u7ec4\u4ef6 forwardRef + useImperativeHandle"),r.createElement("p",null,"\u5bf9\u4e8e\u51fd\u6570\u7ec4\u4ef6\uff0c\u672c\u8eab\u662f\u6ca1\u6709\u5b9e\u4f8b\u7684\uff0c\u4f46\u662f React Hooks \u63d0\u4f9b\u4e86\uff0cuseImperativeHandle \u4e00\u65b9\u9762\u7b2c\u4e00\u4e2a\u53c2\u6570\u63a5\u53d7\u7236\u7ec4\u4ef6\u4f20\u9012\u7684 ref \u5bf9\u8c61\uff0c\u53e6\u4e00\u65b9\u9762\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u51fd\u6570\u8fd4\u56de\u503c\uff0c\u4f5c\u4e3a ref \u5bf9\u8c61\u83b7\u53d6\u7684\u5185\u5bb9\u3002\u4e00\u8d77\u770b\u4e00\u4e0b useImperativeHandle \u7684\u57fa\u672c\u4f7f\u7528\u3002"),r.createElement("p",null,"useImperativeHandle \u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff1a"),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e00\u4e2a\u53c2\u6570 ref : \u63a5\u53d7 forWardRef \u4f20\u9012\u8fc7\u6765\u7684 ref \u3002"),r.createElement("li",null,"\u7b2c\u4e8c\u4e2a\u53c2\u6570 createHandle \uff1a\u5904\u7406\u51fd\u6570\uff0c\u8fd4\u56de\u503c\u4f5c\u4e3a\u66b4\u9732\u7ed9\u7236\u7ec4\u4ef6\u7684 ref \u5bf9\u8c61\u3002"),r.createElement("li",null,"\u7b2c\u4e09\u4e2a\u53c2\u6570 deps :\u4f9d\u8d56\u9879 deps\uff0c\u4f9d\u8d56\u9879\u66f4\u6539\u5f62\u6210\u65b0\u7684 ref \u5bf9\u8c61\u3002")),r.createElement("p",null,"forwardRef + useImperativeHandle \u53ef\u4ee5\u5b8c\u5168\u8ba9\u51fd\u6570\u7ec4\u4ef6\u4e5f\u80fd\u6d41\u7545\u7684\u4f7f\u7528 Ref \u901a\u4fe1\u3002\u5176\u539f\u7406\u56fe\u5982\u4e0b\u6240\u793a\uff1a"),r.createElement("p",null,r.createElement("strong",null,"\u6d41\u7a0b\u56fe\u5982\u4e0b\u6240\u793a")),r.createElement("p",null,r.createElement("img",{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/59238390306849e89069e6a4bb6ded9d~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref6.jpg"})),r.createElement(c.Z,{code:"// \u5b50\u7ec4\u4ef6\nfunction Son (props,ref) {\n    const inputRef = useRef(null)\n    const [ inputValue , setInputValue ] = useState('')\n    useImperativeHandle(ref,()=>{\n       const handleRefs = {\n           onFocus(){              /* \u58f0\u660e\u65b9\u6cd5\u7528\u4e8e\u805a\u7126input\u6846 */\n              inputRef.current.focus()\n           },\n           onChangeValue(value){   /* \u58f0\u660e\u65b9\u6cd5\u7528\u4e8e\u6539\u53d8input\u7684\u503c */\n               setInputValue(value)\n           }\n       }\n       return handleRefs\n    },[])\n    return <div>\n        <input placeholder=\"\u8bf7\u8f93\u5165\u5185\u5bb9\"  ref={inputRef}  value={inputValue} />\n    </div>\n}\n\nconst ForwarSon = forwardRef(Son)\n// \u7236\u7ec4\u4ef6\nclass Index extends React.Component{\n    cur = null\n    handerClick(){\n       const { onFocus , onChangeValue } =this.cur\n       onFocus() // \u8ba9\u5b50\u7ec4\u4ef6\u7684\u8f93\u5165\u6846\u83b7\u53d6\u7126\u70b9\n       onChangeValue('let us learn React!') // \u8ba9\u5b50\u7ec4\u4ef6input  \n    }\n    render(){\n        return <div style={{ marginTop:'50px' }} >\n            <ForwarSon ref={cur => (this.cur = cur)} />\n            <button onClick={this.handerClick.bind(this)} >\u64cd\u63a7\u5b50\u7ec4\u4ef6</button>\n        </div>\n    }\n}\u3002",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\u6548\u679c\u56fe")),r.createElement("p",null,r.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e8c05f0c82c43719079d4db9536abc0~tplv-k3u1fbpfcp-watermark.awebp",alt:"useImperativeHandle.gif"})),r.createElement("p",null,"\u6d41\u7a0b\u5206\u6790\uff1a"),r.createElement("ul",null,r.createElement("li",null,"\u7236\u7ec4\u4ef6\u7528 ref \u6807\u8bb0\u5b50\u7ec4\u4ef6\uff0c\u7531\u4e8e\u5b50\u7ec4\u4ef6 Son \u662f\u51fd\u6570\u7ec4\u4ef6\u6ca1\u6709\u5b9e\u4f8b\uff0c\u6240\u4ee5\u7528 forwardRef \u8f6c\u53d1 ref\u3002"),r.createElement("li",null,"\u5b50\u7ec4\u4ef6 Son \u7528 useImperativeHandle \u63a5\u6536\u7236\u7ec4\u4ef6 ref\uff0c\u5c06\u8ba9 input \u805a\u7126\u7684\u65b9\u6cd5 onFocus \u548c \u6539\u53d8 input \u8f93\u5165\u6846\u7684\u503c\u7684\u65b9\u6cd5 onChangeValue \u4f20\u9012\u7ed9 ref \u3002"),r.createElement("li",null,"\u7236\u7ec4\u4ef6\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 ref \u4e0b\u7684 onFocus \u548c onChangeValue \u63a7\u5236\u5b50\u7ec4\u4ef6\u4e2d input \u8d4b\u503c\u548c\u805a\u7126\u3002")),r.createElement("h3",{id:"3-\u51fd\u6570\u7ec4\u4ef6\u7f13\u5b58\u6570\u636e"},r.createElement(l.AnchorLink,{to:"#3-\u51fd\u6570\u7ec4\u4ef6\u7f13\u5b58\u6570\u636e","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"3 \u51fd\u6570\u7ec4\u4ef6\u7f13\u5b58\u6570\u636e"),r.createElement("p",null,"\u51fd\u6570\u7ec4\u4ef6\u6bcf\u4e00\u6b21 render \uff0c\u51fd\u6570\u4e0a\u4e0b\u6587\u4f1a\u91cd\u65b0\u6267\u884c\uff0c\u90a3\u4e48\u6709\u4e00\u79cd\u60c5\u51b5\u5c31\u662f\uff0c\u5728\u6267\u884c\u4e00\u4e9b\u4e8b\u4ef6\u65b9\u6cd5\u6539\u53d8\u6570\u636e\u6216\u8005\u4fdd\u5b58\u65b0\u6570\u636e\u7684\u65f6\u5019\uff0c\u6709\u6ca1\u6709\u5fc5\u8981\u66f4\u65b0\u89c6\u56fe\uff0c\u6709\u6ca1\u6709\u5fc5\u8981\u628a\u6570\u636e\u653e\u5230 state \u4e2d\u3002\u5982\u679c\u89c6\u56fe\u5c42\u66f4\u65b0\u4e0d\u4f9d\u8d56\u60f3\u8981\u6539\u53d8\u7684\u6570\u636e\uff0c\u90a3\u4e48 state \u6539\u53d8\u5e26\u6765\u7684\u66f4\u65b0\u6548\u679c\u5c31\u662f\u591a\u4f59\u7684\u3002\u8fd9\u65f6\u5019\u66f4\u65b0\u65e0\u7591\u662f\u4e00\u79cd\u6027\u80fd\u4e0a\u7684\u6d6a\u8d39\u3002"),r.createElement("p",null,"\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cuseRef \u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\uff0c\u4e0a\u9762\u8bb2\u5230\u8fc7\uff0cuseRef \u53ef\u4ee5\u521b\u5efa\u51fa\u4e00\u4e2a ref \u539f\u59cb\u5bf9\u8c61\uff0c\u53ea\u8981\u7ec4\u4ef6\u6ca1\u6709\u9500\u6bc1\uff0cref \u5bf9\u8c61\u5c31\u4e00\u76f4\u5b58\u5728\uff0c\u90a3\u4e48\u5b8c\u5168\u53ef\u4ee5\u628a\u4e00\u4e9b\u4e0d\u4f9d\u8d56\u4e8e\u89c6\u56fe\u66f4\u65b0\u7684\u6570\u636e\u50a8\u5b58\u5230 ref \u5bf9\u8c61\u4e2d\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u6709\u4e24\u4e2a\uff1a"),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e00\u4e2a\u80fd\u591f\u76f4\u63a5\u4fee\u6539\u6570\u636e\uff0c\u4e0d\u4f1a\u9020\u6210\u51fd\u6570\u7ec4\u4ef6\u5197\u4f59\u7684\u66f4\u65b0\u4f5c\u7528\u3002"),r.createElement("li",null,"\u7b2c\u4e8c\u4e2a useRef \u4fdd\u5b58\u6570\u636e\uff0c\u5982\u679c\u6709 useEffect \uff0cuseMemo \u5f15\u7528 ref \u5bf9\u8c61\u4e2d\u7684\u6570\u636e\uff0c\u65e0\u987b\u5c06 ref \u5bf9\u8c61\u6dfb\u52a0\u6210 dep \u4f9d\u8d56\u9879\uff0c\u56e0\u4e3a useRef \u59cb\u7ec8\u6307\u5411\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\uff0c",r.createElement("strong",null,"\u6240\u4ee5\u8fd9\u6837\u4e00\u70b9\u597d\u5904\u662f\u53ef\u4ee5\u968f\u65f6\u8bbf\u95ee\u5230\u53d8\u5316\u540e\u7684\u503c\u3002"))),r.createElement("blockquote",null,r.createElement("p",null,"\u5e94\u7528\u573a\u666f demo")),r.createElement(c.Z,{code:"const toLearn = [ { type: 1 , mes:'let us learn React' } , { type:2,mes:'let us learn Vue3.0' }  ]\nexport default function Index({ id }){\n    const typeInfo = React.useRef(toLearn[0])\n    const changeType = (info)=>{\n        typeInfo.current = info /* typeInfo \u7684\u6539\u53d8\uff0c\u4e0d\u9700\u8981\u89c6\u56fe\u53d8\u5316 */\n    }\n    useEffect(()=>{\n       if(typeInfo.current.type===1){\n           /* ... */\n       }\n    },[ id ]) /* \u65e0\u987b\u5c06 typeInfo \u6dfb\u52a0\u4f9d\u8d56\u9879  */\n    return <div>\n        {\n            toLearn.map(item=> <button key={item.type}  onClick={ changeType.bind(null,item) } >{ item.mes }</button> )\n        }\n    </div>\n}",lang:"js"}),r.createElement("p",null,"\u8bbe\u8ba1\u601d\u8def\uff1a"),r.createElement("ul",null,r.createElement("li",null,"\u7528\u4e00\u4e2a useRef \u4fdd\u5b58 type \u7684\u4fe1\u606f\uff0ctype \u6539\u53d8\u4e0d\u9700\u8981\u89c6\u56fe\u53d8\u5316\u3002"),r.createElement("li",null,"\u6309\u94ae\u5207\u6362\u76f4\u63a5\u6539\u53d8 useRef \u5185\u5bb9\u3002"),r.createElement("li",null,"useEffect \u91cc\u9762\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5230\u6539\u53d8\u540e\u7684 typeInfo \u7684\u5185\u5bb9\uff0c\u4e0d\u9700\u8981\u6dfb\u52a0\u4f9d\u8d56\u9879\u3002")),r.createElement("h2",{id:"\u56db-ref-\u539f\u7406\u63ed\u79d8"},r.createElement(l.AnchorLink,{to:"#\u56db-ref-\u539f\u7406\u63ed\u79d8","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u56db ref \u539f\u7406\u63ed\u79d8"),r.createElement("p",null,"\u5bf9\u4e8e Ref \u6807\u7b7e\u5f15\u7528\uff0cReact \u662f\u5982\u4f55\u5904\u7406\u7684\u5462\uff1f \u63a5\u4e0b\u6765\u5148\u6765\u770b\u770b\u4e00\u6bb5 demo \u4ee3\u7801 \uff08\u79f0\u4e4b\u4e3a DemoRef \uff0c\u8bf7\u5927\u5bb6\u8bb0\u4f4f\uff0c\u4e0b\u6587\u4e2d\u8fd8\u4f1a\u63d0\u53ca\u6b64 demo \u4ee3\u7801\u7247\u6bb5 \uff09 \uff1a"),r.createElement(c.Z,{code:"export default class Index extends React.Component{\n    state={ num:0 }\n    node = null\n    render(){\n        return <div >\n            <div ref={(node)=>{\n               this.node = node\n               console.log('\u6b64\u65f6\u7684\u53c2\u6570\u662f\u4ec0\u4e48\uff1a', this.node )\n            }}  >ref\u5143\u7d20\u8282\u70b9</div>\n            <button onClick={()=> this.setState({ num: this.state.num + 1  }) } >\u70b9\u51fb</button>\n        </div>\n    }\n}",lang:"js"}),r.createElement("p",null,"\u7528\u56de\u8c03\u51fd\u6570\u65b9\u5f0f\u5904\u7406 Ref \uff0c",r.createElement("strong",null,"\u5982\u679c\u70b9\u51fb\u4e00\u6b21\u6309\u94ae\uff0c\u4f1a\u6253\u5370\u51e0\u6b21 console.log \uff1f")," \u6765\u6253\u5370\u4e00\u4e0b\u8bd5\u8bd5\uff1f"),r.createElement("p",null,"\u6548\u679c\uff1a"),r.createElement("p",null,r.createElement("img",{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2788bb4be7d04d789639bffea1a5b22d~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref7.gif"})),r.createElement("p",null,"\u7b2c\u4e00\u6b21\u6253\u5370\u4e3a null \uff0c\u7b2c\u4e8c\u6b21\u624d\u662f div \uff0c\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f \u8fd9\u6837\u7684\u610f\u4e49\u53c8\u662f\u4ec0\u4e48\u5462\uff1f"),r.createElement("h3",{id:"ref-\u6267\u884c\u65f6\u673a\u548c\u5904\u7406\u903b\u8f91"},r.createElement(l.AnchorLink,{to:"#ref-\u6267\u884c\u65f6\u673a\u548c\u5904\u7406\u903b\u8f91","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"ref \u6267\u884c\u65f6\u673a\u548c\u5904\u7406\u903b\u8f91"),r.createElement("p",null,"\u5728\u4e0a\u4e00\u8282\u751f\u547d\u5468\u671f\uff0c\u63d0\u5230\u4e86\u4e00\u6b21\u66f4\u65b0\u7684\u4e24\u4e2a\u9636\u6bb5- render \u9636\u6bb5\u548c commit \u9636\u6bb5\uff0c\u540e\u9762\u7684 fiber \u7ae0\u8282\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u4e24\u4e2a\u9636\u6bb5\u3002\u5bf9\u4e8e\u6574\u4e2a Ref \u7684\u5904\u7406\uff0c\u90fd\u662f\u5728 commit \u9636\u6bb5\u53d1\u751f\u7684\u3002\u4e4b\u524d\u4e86\u89e3\u8fc7 commit \u9636\u6bb5\u4f1a\u8fdb\u884c\u771f\u6b63\u7684 Dom \u64cd\u4f5c\uff0c\u6b64\u65f6 ref \u5c31\u662f\u7528\u6765\u83b7\u53d6\u771f\u5b9e\u7684 DOM \u4ee5\u53ca\u7ec4\u4ef6\u5b9e\u4f8b\u7684\uff0c\u6240\u4ee5\u9700\u8981 commit \u9636\u6bb5\u5904\u7406\u3002"),r.createElement("p",null,"\u4f46\u662f\u5bf9\u4e8e Ref \u5904\u7406\u51fd\u6570\uff0cReact \u5e95\u5c42\u7528\u4e24\u4e2a\u65b9\u6cd5\u5904\u7406\uff1a",r.createElement("strong",null,"commitDetachRef")," \u548c ",r.createElement("strong",null,"commitAttachRef")," \uff0c\u4e0a\u8ff0\u4e24\u6b21 console.log \u4e00\u6b21\u4e3a null\uff0c\u4e00\u6b21\u4e3adiv \u5c31\u662f\u5206\u522b\u8c03\u7528\u4e86\u4e0a\u8ff0\u7684\u65b9\u6cd5\u3002"),r.createElement("p",null,"\u8fd9\u4e24\u6b21\u6b63\u6b63\u597d\u597d\uff0c\u4e00\u6b21\u5728 DOM \u66f4\u65b0\u4e4b\u524d\uff0c\u4e00\u6b21\u5728 DOM \u66f4\u65b0\u4e4b\u540e\u3002"),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e00\u9636\u6bb5\uff1a\u4e00\u6b21\u66f4\u65b0\u4e2d\uff0c\u5728 commit \u7684 mutation \u9636\u6bb5, \u6267\u884ccommitDetachRef\uff0ccommitDetachRef \u4f1a\u6e05\u7a7a\u4e4b\u524dref\u503c\uff0c\u4f7f\u5176\u91cd\u7f6e\u4e3a null\u3002")),r.createElement("p",null,"\u6e90\u7801\u5148\u6765\u770b\u4e00\u4e0b\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberCommitWork.js")),r.createElement(c.Z,{code:"function commitDetachRef(current: Fiber) {\n  const currentRef = current.ref;\n  if (currentRef !== null) {\n    if (typeof currentRef === 'function') { /* function \u548c \u5b57\u7b26\u4e32\u83b7\u53d6\u65b9\u5f0f\u3002 */\n      currentRef(null); \n    } else {   /* Ref\u5bf9\u8c61\u83b7\u53d6\u65b9\u5f0f */\n      currentRef.current = null;\n    }\n  }\n}",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e8c\u9636\u6bb5\uff1aDOM \u66f4\u65b0\u9636\u6bb5\uff0c\u8fd9\u4e2a\u9636\u6bb5\u4f1a\u6839\u636e\u4e0d\u540c\u7684 effect \u6807\u7b7e\uff0c\u771f\u5b9e\u7684\u64cd\u4f5c DOM \u3002"),r.createElement("li",null,"\u7b2c\u4e09\u9636\u6bb5\uff1alayout \u9636\u6bb5\uff0c\u5728\u66f4\u65b0\u771f\u5b9e\u5143\u7d20\u8282\u70b9\u4e4b\u540e\uff0c\u6b64\u65f6\u9700\u8981\u66f4\u65b0 ref \u3002")),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberCommitWork.js")),r.createElement(c.Z,{code:"function commitAttachRef(finishedWork: Fiber) {\n  const ref = finishedWork.ref;\n  if (ref !== null) {\n    const instance = finishedWork.stateNode;\n    let instanceToUse;\n    switch (finishedWork.tag) {\n      case HostComponent: //\u5143\u7d20\u8282\u70b9 \u83b7\u53d6\u5143\u7d20\n        instanceToUse = getPublicInstance(instance);\n        break;\n      default:  // \u7c7b\u7ec4\u4ef6\u76f4\u63a5\u4f7f\u7528\u5b9e\u4f8b\n        instanceToUse = instance;\n    }\n    if (typeof ref === 'function') {\n      ref(instanceToUse);  //* function \u548c \u5b57\u7b26\u4e32\u83b7\u53d6\u65b9\u5f0f\u3002 */\n    } else {\n      ref.current = instanceToUse; /* ref\u5bf9\u8c61\u65b9\u5f0f */\n    }\n  }\n}",lang:"js"}),r.createElement("p",null,'\u8fd9\u4e00\u9636\u6bb5\uff0c\u4e3b\u8981\u5224\u65ad ref \u83b7\u53d6\u7684\u662f\u7ec4\u4ef6\u8fd8\u662f DOM \u5143\u7d20\u6807\u7b7e\uff0c\u5982\u679c DOM \u5143\u7d20\uff0c\u5c31\u4f1a\u83b7\u53d6\u66f4\u65b0\u4e4b\u540e\u6700\u65b0\u7684 DOM \u5143\u7d20\u3002\u4e0a\u9762\u6d41\u7a0b\u4e2d\u8bb2\u4e86\u4e09\u79cd\u83b7\u53d6 ref \u7684\u65b9\u5f0f\u3002 \u5982\u679c\u662f\u5b57\u7b26\u4e32 ref="node" \u6216\u662f \u51fd\u6570\u5f0f ',r.createElement("code",null,"ref=","{","(node)=> this.node = node ","}")," \u4f1a\u6267\u884c ref \u51fd\u6570\uff0c\u91cd\u7f6e\u65b0\u7684 ref \u3002"),r.createElement("p",null,"\u5982\u679c\u662f ref \u5bf9\u8c61\u65b9\u5f0f\u3002"),r.createElement(c.Z,{code:"node = React.createRef()\n<div ref={ node } ></div>",lang:"js"}),r.createElement("p",null,"\u4f1a\u66f4\u65b0 ref \u5bf9\u8c61\u7684 current \u5c5e\u6027\u3002\u8fbe\u5230\u66f4\u65b0 ref \u5bf9\u8c61\u7684\u76ee\u7684\u3002"),r.createElement("p",null,r.createElement("strong",null,"\uff5c--------\u95ee\u4e0e\u7b54---------\uff5c"),"\u95ee\uff1a \u4e0a\u9762\u5f88\u591a\u540c\u5b66\u53ef\u80fd\u4f1a\u4ea7\u751f\u7591\u95ee\uff0c\u4e3a\u4ec0\u4e48 ",r.createElement("code",null,'ref="node"')," \u5b57\u7b26\u4e32\uff0c\u6700\u540e\u4f1a\u6309\u7167\u51fd\u6570\u65b9\u5f0f\u5904\u7406\u5462\u3002"),r.createElement("p",null,"\u7b54\uff1a \u56e0\u4e3a\u5f53 ref \u5c5e\u6027\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u65f6\u5019\uff0cReact \u4f1a\u81ea\u52a8\u7ed1\u5b9a\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u6765\u5904\u7406 ref \u903b\u8f91\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactChildFiber.js")),r.createElement(c.Z,{code:"const ref = function(value) {\n    let refs = inst.refs;\n    if (refs === emptyRefsObject) {\n        refs = inst.refs = {};\n    }\n    if (value === null) {\n        delete refs[stringRef];\n    } else {\n        refs[stringRef] = value;\n    }\n};",lang:"js"}),r.createElement("p",null,'\u6240\u4ee5\u5f53\u8fd9\u6837\u7ed1\u5b9aref="node"\uff0c\u4f1a\u88ab\u7ed1\u5b9a\u5728\u7ec4\u4ef6\u5b9e\u4f8b\u7684refs\u5c5e\u6027\u4e0b\u9762\u3002\u6bd4\u5982'),r.createElement(c.Z,{code:'<div ref="node" ></div>',lang:"js"}),r.createElement("p",null,"ref \u51fd\u6570 \u5728 commitAttachRef \u4e2d\u6700\u7ec8\u4f1a\u8fd9\u4e48\u5904\u7406\uff1a"),r.createElement(c.Z,{code:"ref(<div>) \n\u7b49\u4e8e inst.refs.node = <div>",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,"\uff5c-------end---------\uff5c")),r.createElement("h3",{id:"ref-\u7684\u5904\u7406\u7279\u6027"},r.createElement(l.AnchorLink,{to:"#ref-\u7684\u5904\u7406\u7279\u6027","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"Ref \u7684\u5904\u7406\u7279\u6027"),r.createElement("p",null,"\u63a5\u4e0b\u6765\u770b\u4e00\u4e0b ref \u7684\u4e00\u4e9b\u7279\u6027\uff0c\u9996\u5148\u6765\u770b\u4e00\u4e0b\uff0c\u4e0a\u8ff0\u6ca1\u6709\u63d0\u53ca\u7684\u4e00\u4e2a\u95ee\u9898\uff0cReact \u88ab ref \u6807\u8bb0\u7684 fiber\uff0c\u90a3\u4e48\u6bcf\u4e00\u6b21 fiber \u66f4\u65b0\u90fd\u4f1a\u8c03\u7528 ",r.createElement("strong",null,"commitDetachRef")," \u548c ",r.createElement("strong",null,"commitAttachRef")," \u66f4\u65b0 Ref \u5417 \uff1f"),r.createElement("p",null,r.createElement("strong",null,"\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0c\u53ea\u6709\u5728 ref \u66f4\u65b0\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u8c03\u7528\u5982\u4e0a\u65b9\u6cd5\u66f4\u65b0 ref \uff0c\u7a76\u5176\u539f\u56e0\u8fd8\u8981\u4ece\u5982\u4e0a\u4e24\u4e2a\u65b9\u6cd5\u7684\u6267\u884c\u65f6\u671f\u8bf4\u8d77")),r.createElement("h4",{id:"\u66f4\u65b0-ref"},r.createElement(l.AnchorLink,{to:"#\u66f4\u65b0-ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u66f4\u65b0 ref"),r.createElement("p",null,"\u5728 commit \u9636\u6bb5 commitDetachRef \u548c commitAttachRef \u662f\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u88ab\u6267\u884c\u7684\u5462 \uff1f \u6765\u4e00\u8d77\u770b\u4e00\u4e0b\uff1a"),r.createElement("p",null,r.createElement("strong",null,r.createElement("code",null,"commitDetachRef")," \u8c03\u7528\u65f6\u673a")),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberWorkLoop.js")),r.createElement(c.Z,{code:"function commitMutationEffects(){\n     if (effectTag & Ref) {\n      const current = nextEffect.alternate;\n      if (current !== null) {\n        commitDetachRef(current);\n      }\n    }\n}",lang:"js"}),r.createElement("p",null,r.createElement("strong",null,r.createElement("code",null,"commitAttachRef")," \u8c03\u7528\u65f6\u673a")),r.createElement(c.Z,{code:"function commitLayoutEffects(){\n     if (effectTag & Ref) {\n      commitAttachRef(nextEffect);\n    }\n}",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u4ece\u4e0a\u53ef\u4ee5\u6e05\u6670\u7684\u770b\u5230\u53ea\u6709\u542b\u6709 ",r.createElement("code",null,"Ref")," tag \u7684\u65f6\u5019\uff0c\u624d\u4f1a\u6267\u884c\u66f4\u65b0 ref\uff0c\u90a3\u4e48\u662f\u6bcf\u4e00\u6b21\u66f4\u65b0\u90fd\u4f1a\u6253 ",r.createElement("code",null,"Ref")," tag \u5417\uff1f \u8ddf\u7740\u6211\u7684\u601d\u8def\u5f80\u4e0b\u770b\uff0c\u4ec0\u4e48\u65f6\u5019\u6807\u8bb0\u7684 Ref \u3002")),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberBeginWork.js")),r.createElement(c.Z,{code:"function markRef(current: Fiber | null, workInProgress: Fiber) {\n  const ref = workInProgress.ref;\n  if (\n    (current === null && ref !== null) ||      // \u521d\u59cb\u5316\u7684\u65f6\u5019\n    (current !== null && current.ref !== ref)  // ref \u6307\u5411\u53d1\u751f\u6539\u53d8\n  ) {\n    workInProgress.effectTag |= Ref;\n  }\n}",lang:"js"}),r.createElement("p",null,"\u9996\u5148 ",r.createElement("code",null,"markRef")," \u65b9\u6cd5\u6267\u884c\u5728\u4e24\u79cd\u60c5\u51b5\u4e0b\uff1a"),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e00\u79cd\u5c31\u662f\u7c7b\u7ec4\u4ef6\u7684\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u3002"),r.createElement("li",null,"\u7b2c\u4e8c\u79cd\u5c31\u662f\u66f4\u65b0 ",r.createElement("code",null,"HostComponent")," \u7684\u65f6\u5019\uff0c\u4ec0\u4e48\u662f HostComponent \u5c31\u4e0d\u5fc5\u591a\u8bf4\u4e86\uff0c\u6bd4\u5982 ",r.createElement("code",null,"<div />")," \u7b49\u5143\u7d20\u3002")),r.createElement("p",null,r.createElement("code",null,"markRef")," \u4f1a\u5728\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e0b\u7ed9 effectTag \u6807\u8bb0 Ref\uff0c\u53ea\u6709\u6807\u8bb0\u4e86 Ref tag \u624d\u4f1a\u6709\u540e\u7eed\u7684 ",r.createElement("code",null,"commitAttachRef")," \u548c ",r.createElement("code",null,"commitDetachRef")," \u6d41\u7a0b\u3002\uff08 current \u4e3a\u5f53\u524d\u8c03\u548c\u7684 fiber \u8282\u70b9 \uff09"),r.createElement("ul",null,r.createElement("li",null,"\u7b2c\u4e00\u79cd",r.createElement("code",null," current === null && ref !== null"),"\uff1a\u5c31\u662f\u5728 fiber \u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u7b2c\u4e00\u6b21 ref \u5904\u7406\u7684\u65f6\u5019\uff0c\u662f\u4e00\u5b9a\u8981\u6807\u8bb0 Ref \u7684\u3002"),r.createElement("li",null,"\u7b2c\u4e8c\u79cd",r.createElement("code",null," current !== null && current.ref !== ref"),"\uff1a\u5c31\u662f fiber \u66f4\u65b0\u7684\u65f6\u5019\uff0c\u4f46\u662f ref \u5bf9\u8c61\u7684\u6307\u5411\u53d8\u4e86\u3002")),r.createElement("p",null,"\u53ea\u6709\u5728 Ref tag \u5b58\u5728\u7684\u65f6\u5019\u624d\u4f1a\u66f4\u65b0 ref \uff0c\u90a3\u4e48\u56de\u5230\u6700\u521d\u7684 ",r.createElement("strong",null,"DemoRef")," \u4e0a\u6765\uff0c\u4e3a\u4ec0\u4e48\u6bcf\u4e00\u6b21\u6309\u94ae\uff0c\u90fd\u4f1a\u6253\u5370 ref \uff0c\u90a3\u4e48\u4e5f\u5c31\u662f ref \u7684\u56de\u8c03\u51fd\u6570\u6267\u884c\u4e86\uff0cref \u66f4\u65b0\u4e86\u3002"),r.createElement(c.Z,{code:"<div ref={(node)=>{\n               this.node = node\n               console.log('\u6b64\u65f6\u7684\u53c2\u6570\u662f\u4ec0\u4e48\uff1a', this.node )\n}}  >ref\u5143\u7d20\u8282\u70b9</div>",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u5982\u4e0a\u5f88\u7b80\u5355\uff0c\u6bcf\u4e00\u6b21\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u90fd\u7ed9 ref \u8d4b\u503c\u4e86\u65b0\u7684\u51fd\u6570\uff0c\u90a3\u4e48 ",r.createElement("code",null,"markRef")," \u4e2d\u5c31\u4f1a\u5224\u65ad\u6210 ",r.createElement("code",null,"current.ref !== ref"),"\uff0c\u6240\u4ee5\u5c31\u4f1a\u91cd\u65b0\u6253 Ref \u6807\u7b7e\uff0c\u90a3\u4e48\u5728 commit \u9636\u6bb5\uff0c\u5c31\u4f1a\u66f4\u65b0 ref \u6267\u884c ref \u56de\u8c03\u51fd\u6570\u4e86\u3002")),r.createElement("p",null,"\u5982\u679c\u7ed9 ",r.createElement("strong",null,"DemoRef")," \u505a\u5982\u4e0b\u4fee\u6539\uff1a"),r.createElement(c.Z,{code:"export default class Index extends React.Component{\n    state={ num:0 }\n    node = null\n    getDom= (node)=>{\n        this.node = node\n        console.log('\u6b64\u65f6\u7684\u53c2\u6570\u662f\u4ec0\u4e48\uff1a', this.node )\n     }\n    render(){\n        return <div >\n            <div ref={this.getDom}>ref\u5143\u7d20\u8282\u70b9</div>\n            <button onClick={()=> this.setState({ num: this.state.num + 1  })} >\u70b9\u51fb</button>\n        </div>\n    }\n}",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u8fd9\u4e2a\u65f6\u5019\uff0c\u5728\u70b9\u51fb\u6309\u94ae\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u6b64\u65f6 ref \u6307\u5411\u76f8\u540c\u7684\u51fd\u6570 ",r.createElement("code",null,"getDom")," \uff0c\u6240\u4ee5\u5c31\u4e0d\u4f1a\u6253 Ref \u6807\u7b7e\uff0c\u4e0d\u4f1a\u66f4\u65b0 ref \u903b\u8f91\uff0c\u76f4\u89c2\u4e0a\u7684\u4f53\u73b0\u5c31\u662f ",r.createElement("code",null,"getDom")," \u51fd\u6570\u4e0d\u4f1a\u518d\u6267\u884c\u3002")),r.createElement("h4",{id:"\u5378\u8f7d-ref"},r.createElement(l.AnchorLink,{to:"#\u5378\u8f7d-ref","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u5378\u8f7d ref"),r.createElement("p",null,"\u4e0a\u8ff0\u8bb2\u4e86 ref \u66f4\u65b0\u9636\u6bb5\u7684\u7279\u70b9\uff0c\u63a5\u4e0b\u6765\u5206\u6790\u4e00\u4e0b\u5f53\u7ec4\u4ef6\u6216\u8005\u5143\u7d20\u5378\u8f7d\u7684\u65f6\u5019\uff0cref \u7684\u5904\u7406\u903b\u8f91\u662f\u600e\u4e48\u6837\u7684\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberCommitWork.js")),r.createElement(c.Z,{code:"this.state.isShow && <div ref={()=>this.node = node} >\u5143\u7d20\u8282\u70b9</div>",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u5982\u4e0a\uff0c\u5728\u4e00\u6b21\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u6539\u53d8 ",r.createElement("code",null,"isShow")," \u5c5e\u6027\uff0c\u4f7f\u4e4b\u7531 ",r.createElement("code",null,"true")," \u53d8\u6210\u4e86 ",r.createElement("code",null,"false"),"\uff0c \u90a3\u4e48 ",r.createElement("code",null,"div")," \u5143\u7d20\u4f1a\u88ab\u5378\u8f7d\uff0c\u90a3\u4e48 ref \u4f1a\u600e\u4e48\u5904\u7406\u5462\uff1f")),r.createElement("p",null,"\u88ab\u5378\u8f7d\u7684 fiber \u4f1a\u88ab\u6253\u6210 ",r.createElement("code",null,"Deletion")," effect tag \uff0c\u7136\u540e\u5728 commit \u9636\u6bb5\u4f1a\u8fdb\u884c commitDeletion \u6d41\u7a0b\u3002\u5bf9\u4e8e\u6709 ref \u6807\u8bb0\u7684 ClassComponent \uff08\u7c7b\u7ec4\u4ef6\uff09 \u548c HostComponent \uff08\u5143\u7d20\uff09\uff0c\u4f1a\u7edf\u4e00\u8d70 ",r.createElement("code",null,"safelyDetachRef")," \u6d41\u7a0b\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u7528\u6765\u5378\u8f7d ref\u3002"),r.createElement("blockquote",null,r.createElement("p",null,"react-reconciler/src/ReactFiberCommitWork.js")),r.createElement(c.Z,{code:"function safelyDetachRef(current) {\n  const ref = current.ref;\n  if (ref !== null) {\n    if (typeof ref === 'function') {  // \u51fd\u6570\u5f0f \uff5c \u5b57\u7b26\u4e32\n        ref(null)\n    } else {\n      ref.current = null;  // ref \u5bf9\u8c61\n    }\n  }\n}",lang:"js"}),r.createElement("ul",null,r.createElement("li",null,"\u5bf9\u4e8e\u5b57\u7b26\u4e32 ",r.createElement("code",null,'ref="dom"')," \u548c\u51fd\u6570\u7c7b\u578b ",r.createElement("code",null,"ref=","{","(node)=> this.node = node ","}")," \u7684 ref\uff0c\u4f1a\u6267\u884c\u4f20\u5165 null \u7f6e\u7a7a ref \u3002"),r.createElement("li",null,"\u5bf9\u4e8e ref \u5bf9\u8c61\u7c7b\u578b\uff0c\u4f1a\u6e05\u7a7a ref \u5bf9\u8c61\u4e0a\u7684 current \u5c5e\u6027\u3002")),r.createElement("p",null,"\u501f\u6b64\u5b8c\u6210\u5378\u8f7d ref \u6d41\u7a0b\u3002"),r.createElement("h3",{id:"\u903b\u8f91\u6d41\u7a0b\u56fe"},r.createElement(l.AnchorLink,{to:"#\u903b\u8f91\u6d41\u7a0b\u56fe","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u903b\u8f91\u6d41\u7a0b\u56fe"),r.createElement("p",null,r.createElement("img",{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/08a2393077634beaad2b91f971ab381f~tplv-k3u1fbpfcp-watermark.awebp",alt:"ref7.jpg"})),r.createElement("h2",{id:"\u4e94-\u603b\u7ed3"},r.createElement(l.AnchorLink,{to:"#\u4e94-\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},r.createElement("span",{className:"icon icon-link"})),"\u4e94 \u603b\u7ed3"),r.createElement("p",null,"\u8fd9\u8282\u5b66\u4e60\u4e86\u5982\u4e0b\u77e5\u8bc6\u3002"),r.createElement("ul",null,r.createElement("li",null,"\u660e\u767d\u4e86 Ref \u5bf9\u8c61\u7684\u4e8c\u79cd\u521b\u5efa\u65b9\u5f0f\uff0c\u4ee5\u53ca\u4e09\u79cd\u83b7\u53d6 ref \u65b9\u6cd5\u3002"),r.createElement("li",null,"\u8be6\u7ec6\u4ecb\u7ecd forwardRef \u7528\u6cd5\u3002"),r.createElement("li",null,"ref \u7ec4\u4ef6\u901a\u4fe1-\u51fd\u6570\u7ec4\u4ef6\u548c\u7c7b\u7ec4\u4ef6\u4e24\u79cd\u65b9\u5f0f\u3002"),r.createElement("li",null,"useRef \u7f13\u5b58\u6570\u636e\u3002"),r.createElement("li",null,"Ref \u7684\u5904\u7406\u903b\u8f91\u539f\u7406"))))}));n["default"]=e=>{var n=r.useContext(l.context),t=n.demos;return r.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&l.AnchorLink.scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),r.createElement(a,{demos:t})}}}]);